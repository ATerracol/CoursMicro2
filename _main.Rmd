--- 
title: "Microéconomie 2"
author:
    - Elias Bouacida
    - Antoine Terracol
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib, bibliographie.bib]
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
  Cours de microéconomie en licence 2 à l'université Paris 8.
link-citations: yes
github-repo: rstudio/bookdown-demo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(ggplot2)
library(latex2exp)
```

# Microéconomie 2

Cours de microéconomie 2 en licence 2 à l'université Paris 8, donné par Antoine Terracol et Elias Bouacida.  
Ce dépôt contient les notes de cours ainsi que les corrigés des exercices.

## Thèmes

Les principaux thèmes abordés dans ce cours sont les suivants :

-  structures de marché
- pouvoir de marché
- principes de tarification
- comportements stratégiques
- problèmes d'information

L'idée générale est de dépasser le cadre de la concurrence pure et parfaite et de se rapprocher un peu du *monde réel* en levant certaines hypothèses de la concurrence pure et parfaite.

## Bibliographie

Le cours ne nécessite pas de se référer à un manuel. 
Néanmoins, pour ceux qui souhaitent des éclairages différents sur les notions abordés, voici quelques références utiles:

- @varian2015 *Introduction à la microéconomie*
- @varian2008 *Analyse Microéconomique*
- @pindyck2012 *Microéconomie*
- @jeleva2014 *Microéconomie*

Et enfin une référence avancée, pour ceux qui cherchent les fondements mathématiques (en anglais):

- @mas1995 *Microeconomic Theory*

## Plan du cours

1. Rappels sur la concurrence pure et parfaite
2. Monopoles
    - Monopoles simples
    - Monopoles discriminants
    - Pouvoir de marché et principes de tarification
3. Oligopoles
    - Duopoles à la Cournot
    - Duopoles à la Stackelberg
    - Collusion


```{r eval=FALSE, include=FALSE}
bookdown::serve_book()
```


```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

<!--chapter:end:index.Rmd-->

# Rappels : le marché en concurrence pure et parfaite

```{r setupcpp, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

## Les hypothèses de la concurrence pure et parfaite (CPP)


```{r theme}
theme_perso <- function(base_size = 14) {
    theme_bw(base_size = base_size) %+replace%
        theme(
      # L'ensemble de la figure
      plot.title = element_text(size = rel(1), face = "bold", margin = margin(0,0,5,0), hjust = 0),
      # Zone où se situe le graphique
      panel.grid.minor = element_blank(),
      panel.border = element_blank(),
      # Les axes
      axis.title = element_text(size = rel(0.85), face = "bold"),
      axis.text = element_text(size = rel(0.70), face = "bold"),
      axis.line = element_line(color = "black", arrow = arrow(length = unit(0.3, "lines"), type = "closed")),
      # La légende
      legend.title = element_text(size = rel(0.85), face = "bold"),
      legend.text = element_text(size = rel(0.70), face = "bold"),
      legend.key = element_rect(fill = "transparent", colour = NA),
      legend.key.size = unit(1.5, "lines"),
      legend.background = element_rect(fill = "transparent", colour = NA),
      # Les étiquettes dans le cas d'un facetting
      strip.background = element_rect(fill = "#17252D", color = "#17252D"),
      strip.text = element_text(size = rel(0.85), face = "bold", color = "white", margin = margin(5,0,5,0))
    )
}

theme_set(theme_perso())
```

Il y a 5 hypothèses qui définissent la concurrence pure et parfaite :

1. Atomicité des agents
2. Information parfaite
3. Mobilité parfaite des facteurs de production
4. Homogénéité des biens
5. Libre entrée et sortie du marché

:::{.hypothesis name="Atomicité des agents"}
L'hypothèse d'atomicité des agents implique que personne n'a d'influence *individuellement* sur les prix.
En d'autres termes, chaque acteur est petit face au marché et considère le prix du marché comme une *donnée* qu'il ne peut pas influencer.
On dit que les agents sont *price-taker* sur le marché.
:::

:::{.hypothesis name="Information parfaite"}
L'hypothèse d'information parfaite signifie que tous les acteurs disposent de toutes les informations pertinentes pour prendre leurs décisions.
Il n'y a, par exemple, pas de coût de recherche d'information.
:::

:::{.hypothesis name="Mobilité parfaite des facteurs de production"}
L'hypothèse de mobilité parfaite des facteurs de production garantit l’homogénéité spatiale du prix des facteurs.
Les facteurs de production se déplacent où ils sont le mieux rémunérés.
Les différences de coûts entre producteurs ne peuvent donc être dus qu'au différence technologique entre ceux-ci, et non à une différence de coût des facteurs de production.
:::

:::{.hypothesis name="Homogénéïté des biens"}
L’homogénéité des biens signifie que tous les biens vendu sur un marché sont parfaitement substituables.
Sur un marché donné, tous les biens ont la même qualité.
Le consommateur est donc indifférent entre tous les biens vendus.
Il n'y aussi pas d'effet des marques.
:::

:::{.hypothesis name="Libre entrée et sortie du marché"}
L'hypothèse de libre entrée et sortie du marché signifie qu'il n'y pas de barrière à l'entrée dans le marché.
Concrètement, cela implique qu'il est impossible de faire du bénéfice sur la dernière unité vendue en concurrence pure et parfaite, sinon un concurrent pourrait entrer sur le marché et faire des bénéfices.
:::

La violation d'une de ces hypothèses nous fait sortir du cadre de la CPP et confère un *pouvoir de marché* aux producteurs en place.

## Le producteur

### Fonctions de coût

En général, un producteur est caractérisé par une fonction de production, c'est-à-dire une fonction qui donne  les quantités produites de biens en fonction des facteurs de productions.
À l'aide de cette fonction de production, il est possible de construire une fonction de coût.

:::{.definition name="Fonction de coût total"}
La fonction de coût total, notée $C$ ou $CT$ donne le coût total de production de $q$ unités de bien.
Elle peut se décomposer en un *coût fixe* $CF$ (qui ne dépend pas de $q$) et un *coût variable* $CV$ qui dépend de $q$ :
\[CT(q)=CF+ CV(q)\]
:::

:::{.definition name="Coût moyen"}
Le coût moyen est le coût de production moyen d'une unité, noté $C_M$ :
\[C_M(q) = \frac{CT(q)}{q}\]
:::
On peut décomposer le coût moyen en un *coût fixe moyen* $CFM$ :
\[CFM(q)=\frac{CF}{q}\]
Et un *coût variable moyen* $CVM$ :
\[CVM(q)=\frac{CV(q)}{q}\]
On a alors :
\begin{equation}
C_M(q)=CFM(q) +CVM(q)
(\#eq:CM)
\end{equation}

::: {.proof}
\[
\begin{array}{rcl}
C_M(q) &=& \frac{CT(q)}{q}\\
 &=& \frac{CF + CV(q)}{q}\\
 &=& \frac{CF}{q}+\frac{CV(q)}{q}\\
 &=& CFM(q) + CVM(q)
\end{array}
\]
:::

::: {.definition name="Coût marginal"}
Le coût marginal, noté $C_m$, est l'augmentation du coût lié à la production d'une unité supplémentaire :
\[C_m(q)=\lim_{\Delta q\to 0}\frac{CT(q+\Delta q)-CT(q)}{\Delta q}=CT'(q)\]
:::
Autrement dit, le coût marginal est la variation de coût total quand la production varie "un tout petit peu" (infiniment peu en fait).

::: {.proposition name="Forme de courbes de coût"}
Le coût marginal diminue d'abord, puis augmente par la suite, car la productivité marginale est d'abord croissante, puis décroissante, en général.  
Le coût variable moyen est d'abord décroissant, puis croissant, pour la même raison.  
Le coût fixe moyen est toujours décroissant, car le coût fixe ne dépend pas des quantités produites et $CFM=CF/q$ est donc une fonction inverse.  
La décomposition donnée par l'équation \@ref(eq:CM) implique que le coût moyen est d'abord décroissant, puis croissant.
:::

::: {.proposition name="Relation entre les coûts"}
Lorsque le coût marginal est inférieur au coût (variable) moyen ($C_m(q)<C_M(q)$), le coût moyen diminue.
Lorsque le coût marginal est supérieur au coût (variable) moyen ($C_m(q)>C_M(q)$), le coût moyen augmente.
La courbe de coût marginal coupe donc la courbe de coût (variable) moyen à son minimum.
:::
L'intuition de ce résultat est simple : si le coût marginal d'une unité supplémentaire est supérieur au coût moyen, alors l'unité supplémentaire produite sera plus chère que la moyenne du coût des unités précédentes produites, augmentant de ce fait le coût moyen.

:::{ .proof }
En son minimum, le coût moyen est tel que $C_M'(q)=0$.
\[
\begin{array}{crcl}
&C_M'(q)&=&0\\
\Leftrightarrow & \left(\frac{CT(q)}{q}\right)'&=& 0\\
\Leftrightarrow & \frac{CT'(q)q-CT(q)}{q^2}&=& 0\\
\Leftrightarrow & \frac{C_m(q)}{q}-\frac{CT(q)}{q^2}&=& 0\\
\Leftrightarrow & C_m(q)q-CT(q)&=& 0\\
\Leftrightarrow & C_m(q)&=& \frac{CT(q)}{q}\\
\Leftrightarrow & C_m(q)&=& C_M(q)
\end{array}
\]
CQFD.
:::

```{r cppcout, fig.cap="Exemples de fonctions de coût."}
CV <- function(q){log(1+q)+q^2/4}
CF <- function(q){1}
CT <- function(q){CV(q)+CF(q)}
Cm <- function(q){1/(1+q)+q/2}
CM <- function(q){CT(q)/q}
CVM <- function(q){CV(q)/q}

p_cppcout <- ggplot() +
  geom_function(fun=Cm, color="blue") +
  geom_function(fun=CM, color="red") +
  geom_function(fun=CVM, color="darkgreen") +
  labs(x="quantité", y="coût") +
  annotate("text", x=4.5, y=1.3, label=TeX("$CVM$"), color="darkgreen") +
  annotate("text", x=4.5, y=2, label=TeX("$C_M$"), color="red") +
  annotate("text", x=4.5, y=2.5, label=TeX("$C_m$"), color="blue")
  
p_cppcout + scale_y_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(), labels=c()) +
  scale_x_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(), labels=c())
```

### L'offre du producteur

::: {.definition name="Recette totale"}
La recette totale, notée $RT$, est le produit de la vente des unités de biens.
Pour $q$ unités de bien vendus, le producteur gagne $RT(q)$, autrement dit, c'est le chiffre d'affaire du producteur (pour ce bien).
:::

::: {.definition name="Recette marginale"}
La recette marginale, notée $R_m$ est la recette rapportée par une unité supplémentaire de bien.
\[R_m(q)=RT'(q)\]
:::

::: {.definition name="Profit"}
Le profit, noté $\pi$ est la différence entre la recette totale est le coût total de production :
\[\pi(q)=RT(q)-CT(q)\]
:::

Le producteur choisit la quantité produite de manière à maximiser son profit.

::: {.definition name="Programme du producteur"}
Le programme du producteur est :
\[\max_q\pi(q)=\max_q RT(q)-CT(q)\]
:::

::: {.theorem name="Offre du producteur"}
En concurrence pure et parfaite, le programme du producteur est tel que la quantité produite $q$ égalise coût marginal et recette marginale.
À l'optimum :
\begin{equation}
R_m(q) =c_m(q)
(\#eq:cppopti)
\end{equation}
:::

::: {.proof}
Le programme du producteur est de maximiser son profit :
\[\max_q\pi(q)=\max_q RT(q)-CT(q)\]
À l'optimum, et à condition que les fonctions de coût et de recette soient dérivables (ce qui sera toujours le cas ici), cela signifie que l'on doit avoir la condition du premier ordre :
\[\pi'(q)=0\Leftrightarrow RT'(q)-CT'(q)=0\Leftrightarrow R_m(q)=C_m(q)\]
On obtient donc bien l'équation \@ref(eq:cppopti)
:::

L'intuition pour ce résultat est assez simple.
Si on a $R_m(q)>C_m(q)$, alors augmenter la quantité produite rapporte plus que cela ne coûte, et donc augmente le profit.
À l'inverse, si $R_m(q)<C_m(q)$, diminuer la quantité produite diminue plus le coût que la recette du producteur, et donc augmente le profit. 
La situation s'équilibre donc pour $R_m(q)=C_m(q)$.
Si cette égalité n'est pas vérifiée, le producteur peut en effet augmenter son profit en jouant sur la quantité produite.

En concurrence pure et parfaite, le producteur est *price-taker*.
Le prix sur le marché est unique et donné , il vaut $p$ et ne dépend pas des quantités produites par *un* producteur.
Le producteur vend son bien au prix défini par le marché.
La recette totale devient donc $RT(q)=p\times q$, avec $p$ fixé.
La recette marginale est donc $R_m(q)=RT'(q)=p$.
En réécrivant l'équation \@ref(eq:cppopti), on obtient en concurrence pure et parfaite :
\[p=C_m(q)\]

::: {.proposition name="Courbe d'offre en CPP"}
En concurrence pure et parfaite, la courbe d'offre du producteur est la courbe de coût marginal.
\[p=C_m(q)\]
:::

Le profit du producteur s'écrit alors :
\[\pi(q)=RT(q)-CT(q)=pq-CT(q)=pq-C_M(q)q=q(p-C_M(q))\]
Autrement dit, le profit d'un producteur en concurrence pure et parfaite et la différence entre le prix de vente et le coût moyen de production multiplié par le nombre d'unités vendues.
Si ce prix est inférieur au coût moyen de toutes les unités vendues, le profit sera négatif.

```{r cppprofit, fig.cap="Profit d'un producteur en concurrence pure et parfaite."}
q <- 4
pi <- data.frame(x=c(0, q), ymin=c(CM(q), CM(q)), ymax=c(Cm(q), Cm(q)))

p_cppcout + geom_ribbon(data=pi, aes(x=x, ymin=ymin, ymax=ymax), fill="green", alpha=0.5) +
  annotate("text", x=2, y=2, label=TeX("$\\pi$"), color="darkgreen") +
  geom_segment(data=pi, x=q, y=0, xend=q, yend=Cm(q), linetype="dashed") +
  geom_segment(data=pi, x=0, y=CM(q), xend=q, yend=CM(q), linetype="dashed") +
  geom_segment(data=pi, x=0, y=Cm(q), xend=q, yend=Cm(q), linetype="dashed") +
  scale_y_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(CM(q), Cm(q)), labels=c(TeX("$C_M(q^*)$"), TeX("p"))) +
  scale_x_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(q), labels=c(TeX("$q^*$")))

```

## L'équilibre de marché

:::{.definition name="Demande agrégée (D)"}
La *demande agrégée (D)* est la somme des demandes individuelles pour chaque niveau de prix.
:::

:::{.definition name="Offre agrégée (S)"}
L'*offre agrégée (S)* est la somme des offres individuelles pour chaque niveau de prix.
:::

L'équilibre de marché se fait à l'intersection entre S et D (quand S=D).


```{r marche, fig.cap="Equilibre de marché."}

x=seq(0, 1, length=11)
df <- data.frame(x)

S <- function(q){q}
D <- function(q){1-q}


p <- ggplot(df, aes(x=x)) +
    stat_function(fun=function(x) D(x), colour = "blue") +
    stat_function(fun=function(x) S(x), colour = "red") +
    scale_y_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("p*"), limits = c(0, 1.2)) +
    scale_x_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("q*"), limits = c(0, 1.2)) +
    labs(x="quantité", y = "prix") +
    annotate("text", x = 1.1, y = 1, label ="S", colour = "red") +
    annotate("text", x = 0.1, y = 1, label ="D", colour = "blue") +
    geom_segment(x = 0.5, y = 0, xend = 0.5, yend = 0.5, linetype="dashed") +
    geom_segment(x = 0, y = 0.5, xend = 0.5, yend = 0.5, linetype = "dashed")


p
```


La courbe de demande correspond à la suite des prix de réserve des individus, c'est-à-dire aux prix maximal que chaque individu est prêt à payer pour obtenir une unité *supplémentaire* du bien.

La courbe d'offre correspond à la série des coûts marginaux de production, c'est-à-dire les prix minimaux auxquels les producteurs souhaitent vendre une unité supplémentaire du bien.

La vente de toutes les unités jusqu'à la quantité d'équilibre $q^*$ au prix $p^*$ procure un *surplus* aux agents économiques.

:::{.definition name="Surplus des consommateurs"}
Le surplus des consommateurs est la somme des différences entre le prix de réserve des consommateurs et le prix payé par le consommateur pour obtenir les biens.
Sur le graphique quantité prix $(q, p)$, c'est l'aire compris entre la courbe de demande est la droite horizontale dont l'ordonnée est le prix d'échange.
Formellement :
\[S_c=\int_0^{q^*}P(q)-p^* dq\]
:::

::: {.remark}
Seule la dernière unité de bien achetée par les consommateur l'est au prix de réserve.
Il n'y a pas de gain à l'échange pour cette unité, mais pour toutes les autres, il y en a, ce qui explique pourquoi il y a un surplus à l'échange, et pourquoi celui-ci à lieu.
:::

:::{.definition name="Surplus des producteurs"}
Le surplus des producteurs est la somme des différences entre le prix auquel les producteurs vendent le bien et la courbe de coût marginal, qui représente le coût d'une unité supplémentaire produite.
Sur le graphique quantité prix $(q, p)$, c'est l'aire compris entre le prix de vente et la courbe de coût marginal.
Formellement :
\[S_p=\int_0^{q^*}p^*-S(q) dq\]
:::

En pratique, on utilisera jamais la formule avec des intégrales, mais on calculera l'aire du triangle (ou trapèze) concerné.

```{r surplus, fig.cap="Surplus des consommateurs et des producteurs."}

Sc = data.frame(x = c(0, 0.5), y = c(1, 0.5))
Sp = data.frame(x = c(0, 0.5), y = c(0, 0.5))

p + geom_ribbon(data = Sc, aes(x=x, ymin=0.5, ymax = y), fill="blue") +
    geom_ribbon(data = Sp, aes(x=x, ymin=y, ymax = 0.5), fill="red")
```

:::{ .proposition #cppprop name="Propriétés de l'équilibre en concurrence pure et parfaite"}
L'équilibre en CPP est celui qui **maximise** le *surplus total*.
Tout autre couple prix/quantité abouti à un surplus total plus faible.  
L'équilibre de CPP est *Pareto-optimal*, i.e., il est impossible d'améliorer la situation d'un agent sans détériorer celle d'un autre.
C'est ce qu'on appelle le *premier théorème du bien-être*.
:::

Ces propriétés font de la CPP une "référence" par rapport à laquelle on peut comparer les résultats des autres structures de marché.

## Perception par les agents isolés

L'hypothèse d'atomicité indique que les agents individuels sont isolés au sein d'un très grand nombre d'autres agents.
Ainsi, aucun agent n'a d'influence sur le prix s'il modifie son comportement.
Une conséquence directe est que le comportement des autres agents est perçu comme étant infiniment élastique.
C'est-à-dire qu'un producteur sait qu'au prix de marché, il pourra vendre toute sa production, mais que s'il pratique un prix même légèrement plus élevé, il ne vendra **rien**.
Il perçoit ainsi une demande infiniment élastique au prix,  au niveau du prix $p^*$.


```{r elasticite, fig.align='center', fig.cap="Perception de la demande globale par un producteur isolé."}

x=seq(0, 1, length=11)
df <- data.frame(x)

S <- function(q){q}
D <- function(q){1-q}


p <- ggplot(df, aes(x=x)) +
    stat_function(fun=function(x) S(x), colour = "red") +
    geom_hline(yintercept = 0.5, colour = "blue") +
    scale_y_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("p*"), limits = c(0, 1.2)) +
    scale_x_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("q*"), limits = c(0, 1.2)) +
    labs(x="quantité", y = "prix") +
    annotate("text", x = 0.9, y = 1, label ="offre individuelle", colour ="red") +
    annotate("text", x = 0.8, y = 0.55, label ="demande perçue", colour ="blue") +
    geom_segment(x = 0.5, y = 0, xend = 0.5, yend = 0.5, linetype="dashed") +
    geom_segment(x = 0, y = 0.5, xend = 0.5, yend = 0.5, linetype = "dashed")


p
```

Dans ce graphique, $q^*$ représente la production optimale de ce producteur quand il est seul.

<!--chapter:end:01-cpp.Rmd-->

# Le monopole

```{r setupmono, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

::: {.definition name="Monopole"}
Un *monopole* est sur un marché donné l'unique entreprise qui produit le bien.
:::


C'est le cas extrême opposé à la concurrence pure et parfaite, du côté du producteur.
Il est intéressant à étudier car il nous renseigne sur les principaux aspects du comportement des entreprises dans les cas intermédiaires.


Il y a de nombreuses raisons qui aboutissent à l'existence de monopoles.
Les principales sont :

- Légales, à cause de réglementation particulières.
C'est ce qu'on appelle en général des professions réglementées, comme les avocats, les bureaux de tabac, les taxis...
- Légales, à cause des brevets sur une technologie données (industrie pharmaceutique...) ;
- Historique, le premier arrivé ;
- Monopoles *naturels* : en présence d'économies d'échelles, produire une quantité donnée revient moins cher avec un seul producteur qu'avec plusieurs.
C'est notamment les cas des industries où il faut installer des réseaux (chemins de fer, électricité, téléphone, etc).
Plus généralement, les industries avec des coûts fixes / coûts d'entrées très élevées aboutissent à des formes proches du monopole naturel (sidérurgie, automobile...) ;
- Exclusivité sur la production de certaines matières premières (cuivre au Chili, terres rares en Chine,...) ;
- Coalitions créant un cartel ;
- ...

## Recette et recette marginale

### Définition

À la différence du cas de la concurrence pure et parfaite, le monopole perçoit la courbe de demande agrégée, et non plus celle avec une élasticité infinie.
Le choix de la quantité qu'il met sur le marché modifie le prix auquel il pourra vendre sa production, et il le sait.  
Il va choisir **un** des paramètres du couple $(q, P(q))$, et l'autre en découlera, à travers la demande inverse $P(q)$.
Autrement dit, s'il choisit $q$, $P(q)$ sera déterminé par la demande (inverse).
Si, au contraire, il choisit $P$, $q$ sera déterminé par la demande.

En CPP, la recette totale du producteur individuel était $R(q) = q\cdot P(q^*)$, où $q$ est sa production individuel, $q^*$ la quantité d'équilibre sur le marché (résultat de la production de *toutes* les entreprises présentes sur le marché) et $P(q^*)=p^*$ est le prix d'équilibre.

En monopole, le prix dépend de la production du monopole (ou l'inverse, peu importe) :
\[
R(q) = q\cdot P(q)
\]

### Recette marginale et courbe de demande

Comme la courbe de demande est décroissante (l'élasticité prix de la demande est négative $\varepsilon_{q/p} <0$), $P(q)$ et $q$ ont une relation inverse. 
Autrement dit, si $q$ augmente, alors $p$ baisse, et réciproquement.

Cela implique que la recette totale va augmenter ou baisser suivant les propriétés de la courbe de demande.


```{r base, include=FALSE}

x=seq(0, 1, length=21)
df <- data.frame(x)

D <- function(q){1-q}



S1 = data.frame(x = c(0, 0.1), y = c(0.9, 0.9))
S2 = data.frame(x = c(0.1, 0.2), y = c(0.8, 0.8))
S3 = data.frame(x = c(0, 0.8), y = c(0.2, 0.2))
S4 = data.frame(x = c(0.8, 0.9), y = c(0.1, 0.1))

p <- ggplot(df, aes(x=x)) +
    stat_function(fun=function(x) D(x), colour = "blue") +
    labs(x="quantité", y = "prix") +
    annotate("text", x = 0.3, y = 1, label ="courbe de demande", colour = "blue")
```

```{r monorecettemarginale, fig.cap="Recette marginale d'un monopole."}
p1 <- p

lab1 <-expression("P(q+"*Delta*'q)')
lab2 <-expression("q+"*Delta*'q')

p1 +  scale_y_continuous(breaks = c(0.1, 0.2, 0.8, 0.9), labels = c(lab1, 'P(q)', lab1, 'P(q)'), expand = c(0, 0), limits = c(0, 1.2)) +
    scale_x_continuous(breaks = c(0.1, 0.2, 0.8, 0.9),  labels = c('q', lab2, 'q', lab2), expand = c(0, 0), limits = c(0, 1.2)) +
  geom_segment(x=0.9, y=0, xend = 0.9, yend = 0.1, linetype="dashed") +
    geom_segment(x=0.8, y=0, xend = 0.8, yend = 0.2, linetype="dashed") +
    geom_segment(x=0.2, y=0, xend = 0.2, yend = 0.8, linetype="dashed") +
    geom_segment(x=0.1, y=0, xend = 0.1, yend = 0.9, linetype="dashed") +
    geom_segment(x=0, y = 0.9, xend = 0.1, yend = 0.9, linetype="dashed") +
    geom_segment(x=0, y = 0.8, xend = 0.2, yend = 0.8, linetype="dashed") +
    geom_segment(x=0, y = 0.2, xend = 0.8, yend = 0.2, linetype="dashed") +
    geom_segment(x=0, y = 0.1, xend = 0.9, yend = 0.1, linetype="dashed") +
geom_ribbon(data = S1, aes(x=x, ymin=0.8, ymax = y), fill="green", alpha = 0.5) +
    geom_ribbon(data = S2, aes(x=x, ymin=0, ymax = y), fill="red", alpha = 0.5) +
    geom_ribbon(data = S3, aes(x=x, ymin=0.1, ymax = y), fill="red", alpha = 0.5) +
    geom_ribbon(data = S4, aes(x=x, ymin=0, ymax = y), fill="green", alpha = 0.5) +
  annotate("text", x=0.05, y=0.85, label="+", colour="darkgreen", size = rel(10)) +
  annotate("text", x=0.4, y=0.15, label="-", colour="darkred", size = rel(10)) +
  annotate("text", x=0.15, y=0.4, label="-", colour="darkred", size = rel(10)) +
  annotate("text", x=0.85, y=0.05, label="+", colour="darkgreen", size = rel(10))
```

Quel est le paramètre important de la courbe de demande qui détermine si le revenu $R$ augmente ou diminue (c'est-à-dire si $R_m$ est positive ou négative) ?

\begin{align*}
R(q) & = qP(q)\\
R_m(q)& = R'(q) \\
& = \left(qP(q)\right)' \\
& = P(q) + qP'(q) \\
& = P(q)\left(1 + \frac{q}{P(q)}P'(q) \right)\\
& = P(q)\left(1 + \frac{1}{\varepsilon_{q/p}(q)}\right)
\end{align*}

::: {.remark name="Élasticité prix de la demande"}
L'élasticité prix de la demande $\varepsilon_{q/p}$ s'écrit :
\[\varepsilon_{q/p}(p)=\frac{p}{D(p)}D'(p) <0\]
Où $D$ est la fonction de demande.
Elle est toujours négative, car la demande diminue quand le prix augmente.
On peut la réécrire à l'aide de la fonction de demande inverse $P$.
Comme $D$ et $P$ sont les fonctions réciproques l'une de l'autre, on a $D(P(q)) = q$.
En dérivant à gauche et à droite, on obtient :
\[P'(q)D'(P(q)) = 1\]
On obtient donc :
\[P'(q)=\frac{1}{D'(p)}\]
Et l'élasticité prix de la demande peut aussi s'écrire :
\[\varepsilon_{q/p}(q)=\frac{P(q)}{q}\frac{1}{P'(q)}\]
:::

On peut donc écrire :
\begin{equation}
R_m(q) = P(q)\left(1 - \frac{1}{|\varepsilon_{q/p}(q)|}\right)
(\#eq:rm)
\end{equation}


De l'équation \@ref(eq:rm), on observe que le signe de la recette margianale $R_m$ dépend de l'élasticité prix de la demande.

1. Si la demande est élastique ($|\varepsilon_{q/p}(q)|>1$), alors $R_m(q)>0$, donc si la quantité augmente, le revenu augmente.
2. Si la demande est inélastique ($|\varepsilon_{q/p}(q)|<1$), alors $R_m(q)<0$, donc si la quantité augmente, le revenu diminue.

Une représentation graphique de l'allure générale est donnée dans la figure \@ref(fig:monopoleelasticite)

```{r monopoleelasticite, fig.cap="La recette marginale est maximale lorsque l'élasticité prix de la demande est égale à -1."}
p2 <- p;

lab1 = TeX("$\\left| \\epsilon_{q/p}\\right|>1$")
lab2 = TeX("$\\left| \\epsilon_{q/p}\\right|<1$")
lab3 = TeX("$\\left| \\epsilon_{q/p}\\right|=1$")


p2 + geom_segment(x=0, y=0, xend = 0.5, yend = 0.5, linetype="dashed") +
  geom_segment(x=0, y=1, xend = 0.5, yend = 0.5, colour="green") +
  geom_segment(x=1, y=0, xend = 0.5, yend = 0.5, colour="red") +
  annotate("text", x=0.35, y=0.75, label=lab1, size = 10, colour="darkgreen") +
  annotate("text", x=0.85, y=0.25, label=lab2, size = 10, colour="darkred") +
  annotate("text", x=0.65, y=0.5, label=lab3, size = 10, colour="darkblue") +
  annotate("point", x=0.5, y=0.5, size = 4, colour="darkblue") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c()) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c())
```

### Représentation graphique

La courbe de recette marginale est toujours située en-dessous de la courbe de demande :
\[
R_m(q) = P(q) + qP'(q) < P(q)
\]
et $P'(q)$ est négative (la demande inverse est décroissante).

#### Exemple avec une courbe de demande linéaire

Prenons maintenant l'exemple d'une courbe de demande inverse linéaire quelconque $P(q) = a-bq$ ($a$ et $b$ sont des paramètres quelconques).
On obtient alors $R_m(q) = a-2bq$ (et $R(q) = aq-bq^2$).  
Dans le cas linéaire, le revenu marginal est une droite de pente deux fois plus élevée que la demande, et ayant la même ordonnée à l'origine.
La recette marginale divise en deux  tout segment horizontal entre l'axe des ordonnées et la courbe de demande inverse.
On peut ainsi représenter graphiquement, comme dans la figure \@ref(fig:recettermarginale) la demande, la recetter marginale et la recette totale.

```{r recettemarginale, fig.cap="Elasticité et recette."}
Rm <- function(q)(1-2*q)
R <- function(q)(q-q^2)

p3 <- p +
  stat_function(fun=function(x) Rm(x), colour = "darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c()) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c(0.5, 1), labels = c(expression(x[0]/2), expression(x[0]))) +
  annotate("text", x=0.15, y=0.8, colour="darkgreen", label="recette marginale") +
  stat_function(fun=function(x) R(x), colour = "red") +
  annotate("text", x=0.1, y = 0.2, colour="red", label="Recette") +
  annotate("text", x=0.65, y=0.5, label=lab3, size = 10, colour="darkblue") +
  annotate("point", x=0.5, y=0.5, size = 4, colour="darkblue") +
  annotate("point", x=0.5, y=0.25, size = 4, colour="red") +
  annotate("text", x=0.65, y=0.3, size = 5, colour="red", label="Recette maximale")

p3
```

La recette maximale est atteinte lorsque la valeur absolue de l'élasticité prix de la demande est égale à 1 ($|\varepsilon_{q/p}(q)|=1$).

```{r monopoleprofit, fig.cap="Recette maximale."}

profit <- data.frame(x=c(0, 0.4), y=c(1, 0.2))

p4 <- p +
  stat_function(fun=function(x) Rm(x), colour = "darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c(0.6), labels=c("p*")) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c(0.4), labels = c("q*")) +
  annotate("text", x=0.15, y=0.8, colour="darkgreen", label="recette marginale") +
  annotate("text", x=0.1, y = 0.2, colour="red", label="Recette") +
  geom_ribbon(data = profit, aes(x=x, ymin=0, ymax = y), fill="green", alpha = 0.5) +
  geom_ribbon(data = profit, aes(x=x, ymin=0, ymax = 0.6), fill="red", alpha = 0.5)

p4
```

Sur la figure \@ref(fig:monopoleprofit), on voit qu'il est possible de calculer la recette totale de deux manières :

1. En utilisant l'aire du trapèze vert (intégrale de la recette marginale entre 0 et la quantité échangée $q^*$) ;
2. En utilisant l'aire du rectangle rouge ($\pi=p^* q^*$).

Le résultat donne l'égalité d'aire entre le triangle vert et le triangle rouge.

## Décision de production du monopole

### Maximisation du profit

Comme dans le cas de la CPP, on suppose que le monopole cherche à maximiser son profit $\pi(q)=R(q)-C(q)$, où $C(q)$ est la fonction de coût (total) du monopole.  
Il y a 2 conditions d'optimalités, les conditions de premier (la dérivée du profit à l'optimum est nulle: $\pi'(q^*)=0$) et de second ordre (la dérivée seconde du profit à l'optimum est strictement négative $\pi''(q^*)<0$), ainsi qu'une contrainte, que le profit à l'optimum soit positif ($\pi(q^*)>0$).

La condition de premier ordre s'exprime ainsi :
\[
\begin{array}{rcl}
\pi'(q^*) &=&0\\
\Leftrightarrow R'(q^*) - C'(q^*) &=& 0\\
\Leftrightarrow R_m(q^*) &=&C_m(q^*) 
\end{array}
\]
À l'optimum, le monopole égalise le coût marginal et le revenu marginal.

La condition du second ordre s'exprime ainsi :
\[
\begin{array}{rcl}
\pi''(q^*) &<&0\\
\Leftrightarrow R_m'(q^*) - C_m'(q^*) &<& 0\\
\Leftrightarrow R_m'(q^*) &<& C_m'(q^*)
\end{array}
\]

La dérivée de la recette marginale doit être inférieure à la dérivée du coût marginal.
Autrement dit, la recette marginale doit croître moins vite que le coût marginal.
Cette condition est en particulier vérifiée si la recette marginale est décroissante et le coût marginal croissant.

Finalement, il faut vérifier que le profit à l'optimum est positif ($\pi(q^*)>0$).
Dans le cas contraire, le marché n'existerait tout simplement pas, car le monopole ne voudrait pas produire le bien.

::: {.theorem name="Optimum du du monopole"}
À l'optimum, le monopole égalise le coût marginal et le revenu marginal.
Ce n'est un maximum que si la dérivée de la recette marginale est inférieure à la dérivée du coût marginal et que le profit est positif.
\begin{equation}
R_m(q^*)=C_m(q^*) 
(\#eq:cpo)
\end{equation}
\begin{equation}
R_m'(q^*) <C_m'(q^*) (\#eq:cso)
\end{equation}
\begin{equation}
\pi(q^*)>0 (\#eq:profitpos)
\end{equation}
:::

On peut comprendre graphiquement pourquoi il faut que le coût marginal et la recette marginale soit égale (figure \@ref(fig:monopoleoptimale)).
Si le monopole produit plus que $q_m^*$, alors chaque unité produite en plus lui coûte plus cher qu'elle ne lui rapporte.
A l'inverse, s'il produit moins, produire des unités en plus lui rapporterait plus que cela ne lui coûte.
 
```{r monopoleoptimale, fig.cap="Production optimale du monopole."}
p5 <- p

Cm <- function(x){2*x}
perte1 <- data.frame(x = c(0.15, 0.25), y = c(0.7, 0.5), z = c(0.3, 0.5))
perte2 <- data.frame(x = c(0.25, 0.35), y = c(0.5, 0.7), z = c(0.5, 0.3))

p5 +   stat_function(fun=function(x) Rm(x), colour = "darkgreen") +
  stat_function(fun=function(x) Cm(x), colour = "red") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c(0.75), labels=c(TeX("$p_m^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks = c(0.25), labels = c(TeX("$q_m^*$"))) +
  geom_ribbon(data = perte1, aes(x=x, ymin=z, ymax = y), fill="red", alpha = 0.5) +
  geom_ribbon(data = perte2, aes(x=x, ymin=z, ymax = y), fill="red", alpha = 0.5) +
  annotate("text", x=0.15, y=0.5, label=TeX("perte si $q<q_m^*$"), color="darkred") +
  annotate("text", x=0.4, y=0.5, label=TeX("perte si q>q_m^*"), color="darkred") +
  annotate("text", x=0.5, y=0.1, colour="darkgreen", label="recette marginale") +
  annotate("text", x=0.55, y=0.8, colour="darkred", label="coût marginal") +
  geom_segment(x=0.25, y=0, xend=0.25, yend=0.75, linetype="dashed") +
  geom_segment(x=0, y=0.75, xend=0.25, yend=0.75, linetype="dashed")
```


Le prix est lu et obtenu sur  la courbe de **demande**.

::: { .example #monopoleexemple name="Maximisation du monopole"}
Prenons un monopole avec une fonction de coût $C(q)=50+q^2$.
Le monopole fait face à une demande inverse $P(q) = 40-q$.

Le coût marginal est :
\[
C_m(q) = C'(q)=2q
\]

La recette totale est :
\[
R(q) = qP(q) = q(40-q) = 40q-q^2
\]
La recette marginale est donc :
\[
R_m(q) = R'(q) = 40 - 2q
\]
Le profit vaut :
\[
\pi(q) = R(q)-C(q)
\]
Conformément à l'équation \@ref(eq:cpo), il est maximal lorsque :
\[
\begin{array}{rcl}
R_m(q^*) &=&C_m(q^*)\\
\Leftrightarrow 40 -2q &= &2q\\
\Leftrightarrow q^*&=&10
\end{array}
\]
La condition de second ordre de l'équation \@ref(eq:cso) est bien vérifiée, car $-2<2$.

Le prix de vente vaut :
\[P(q^*) = P(10) = 40-10 = 30\]
La recette vaut 300, le coût 150. 
On a donc un profit de **150**, qui est bien positif (condition de l'équation \@ref(eq:profitpos).
:::

```{r monopolerecette, fig.cap="Recette, coût et profit dans l'exemple \\@ref(exm:monopoleexemple)."}
x2 <- seq(0, 20, length=100)
df2 <- data.frame(x2)

C <- function(q){ 50+q^2 }
Cm <- function(q){ 2*q }
CM <- function(q){ C(q)/q }
P <- function(q){ 40-q }


R <- function(q){ P(q)*q }
Rm <- function(q){ P(q) - q }
pi <- function(q){ R(q) - C(q)}

p6 <- ggplot(df2, aes(x=x2)) +
  stat_function(fun=function(x) R(x), colour = "blue") +
  labs(x="quantité", y = "prix") +
  stat_function(fun=function(x) C(x), colour="red") +
  stat_function(fun=function(x) pi(x), colour="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 420), breaks = seq(0, 400, by=50), labels=c(0, 50, 100, TeX("$\\pi_m^*=150$"), 200, 250, 300, 350, 400)) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 22), breaks = seq(0, 20, by=5), labels = c(0, 5, TeX("$q_m^*=10$"), 15, 20)) +
  annotate("text", x=18, y=10, label=TeX("$\\pi$"), color="darkgreen") +
  annotate("text", x=18, y=350, label=TeX("C_m"), color="darkred") +
  annotate("text", x=18, y=400, label=TeX("R"), color="blue")

p6
```

```{r monopoleprofitexemple, fig.cap="Demande, prix, coûts et profits dans l'exemple \\@ref(exm:monopoleexemple)."}
profit <- data.frame(x=c(0, 10), ymax=c(30, 30), ymin=c(15, 15))

p7 <- ggplot(df2, aes(x=x2)) +
  stat_function(fun=function(x) P(x), colour = "blue") +
  stat_function(fun=function(x) Rm(x), colour = "lightblue") +
  labs(x="quantité", y = "prix") +
  stat_function(fun=function(x) Cm(x), colour="red") +
  stat_function(fun=function(x) CM(x), colour="pink") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 45), breaks = seq(0, 40, by=5), labels=seq(0, 40, by=5)) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 22), breaks = seq(0, 20, by=5), labels=c(0, 5, TeX("$q_m^*=10$"), 15, 20)) +
  annotate("text", x=18, y=20, label="demande", color="blue") +
  annotate("text", x=18, y=1, label=TeX("$R_m$"), color="lightblue") +
  annotate("text", x=18, y=40, label=TeX("$C_m$"), color="red") +
  annotate("text", x=18, y=25, label=TeX("$C_M$"), color="pink") +
  geom_ribbon(data = profit, aes(x=x, ymin=ymin, ymax = ymax), fill="green", alpha = 0.5) +
  annotate("text", x=5, y=25, label=TeX("$\\pi$"), color="darkgreen")


p7  
```

### Propriétés de la solution de la maximisation du monopole

On avait dans l'équation \@ref(eq:rm) :
\[
R_m(q) = P(q)\left(1 - \frac{1}{|\varepsilon_{q/p}(q)|}\right)
\]
Comme à l'optimum, d'après l'équation \@ref(eq:cpo), on doit avoir $R_m(q^*)=C_m(q^*)$, on a :
\[
R_m(q^*) = P(q^*)\left(1 - \frac{1}{|\varepsilon_{q/p}(q^*)|}\right) = C_m(q^*) 
(\#eq:rmcm)
\]
On observe ici un lien avec la solution en CPP.
En effet, en CPP, l'élasticité de la demande au prix est perçue comme infinie, on aura donc bien $P(q^*) = C_m(q^*)$, la solution obtenue en CPP.
Dès lors que l'élasticité de la demande au prix n'est plus infinie en revanche, on obtient :
\[
 P(q^*)=\frac{C_m(q^*)}{1 - \frac{1}{\left|\varepsilon_{q/p}(q^*)\right|}} > C_m(q^*)
\]

*Question :* Dans quelle zone d'élasticité le monopole va-t-il opérer ?

On voit que si $\left|\varepsilon_{q/p}(q^*)\right|<1$, c'est-à-dire que si la demande est inélastique, alors $1 - \frac{1}{\left|\varepsilon_{q/p}(q^*)\right|} <0$, ce qui implique que la recette marginale $R_m$ est négative, et donc impossible à égaliser avec le coût marginal $C_m$.  
On peut voir la réponse d'une autre façon.
Si la pente est inélastique, alors le revenu $R$ augmente quand la quantité $q$ baisse. 
Le coût total $C$ baisse aussi quand la quantité baisse. 
Le monopole aurait donc tout intérêt à réduire sa production lorsque la demande est inélastique.

::: {.corollary}
Le monopole opère donc nécessairement dans la zone élastique de la courbe de demande : $\left|\varepsilon_{q/p}(q^*)\right|>1$ .
::: 

### Indice de pouvoir du monopole

La capacité du monopole à vendre à un prix supérieur au coût marginal dépend de la plus ou moins grande élasticité de la demande au prix.
Cela permet de construire un indice du *pouvoir de monopole* à partir de l'élasticité du prix à la demande à l'équilibre.
On a, d'après l'équation \@ref(eq:rmcm) :
\[
R_m(q^*) = P(q^*)\left(1 - \frac{1}{|\varepsilon_{q/p}(q^*)|}\right) = C_m(q^*) 
\]
On en déduit :

\[\begin{array}{rl}
& C_m(q^*) = P(q^*) - \frac{P(q^*)}{|\varepsilon_{q/p}(q^*)|}\\
\Leftrightarrow & P(q^*) - C_m(q^*) = \frac{P(q^*)}{|\varepsilon_{q/p}(q^*)|}
\end{array}
\]

::: {.definition #Lerner name="Indice de Lerner"}
On définit l'indice de Lerner $L$ par :
\[
L=\frac{1}{|\varepsilon_{q/p}(q^*)|} = \frac{P(q^*) - C_m(q^*)}{P(q^*)} (\#eq:Lerner)
\]
L'indice de Lerner est donc inversement proportionnel à l'élasticité prix de la demande. 
Il est aussi égal à la capacité du monopole à vendre au-dessus de son coût marginal, en pourcentage du prix total.
:::

On peut construire à partir de l'équation précédente le *markup pricing*.

:::{.definition name="Markup pricing"}
\[
P(q^*) =\frac{|\varepsilon_{q/p}(q^*)|}{|\varepsilon_{q/p}(q^*)|-1} C_m(q^*)
\]
:::



### Variation de la demande

Les décisions de production du monopole et la fixation de son prix dépendent de la demande à laquelle il fait face et du coût marginal.
Le monopole n'a **pas de courbe d'offre** au sens où il n'y a pas de relation univoque entre prix et quantité produite, à la différence des producteurs en CPP.
En monopole, si la demande change, le monopole s'adapte, soit en changeant sa production, mais pas son prix (figure \@ref(fig:monopolechangementdemande2)), ou l'inverse (figure\@ref(fig:monopolechangementdemande1)).

```{r monopolechangementdemande1, fig.cap="Exemple de réaction du monopole à un changement de demande: changement de prix."}

P <- function(q){1-q}
Rm <- function(q){1-2*q}
P2 <- function(q){1-3*q/4}
Rm2 <- function(q){1-3*q/2}
Cm <- function(q){q}

q1=1/3

p_changement <- ggplot() +
  geom_function(fun=P, colour = "blue") +
  geom_function(fun=Rm, colour = "lightblue") +
  geom_function(fun=P2, colour = "darkgreen") +
  geom_function(fun=Rm2, colour = "green") +
  geom_function(fun=Cm, colour="red") +
  labs(x="quantité", y = "prix") +
  annotate("text", x=0.8, y=P(0.8), label=TeX("demande 1 ($P_1$)"), color="blue") +
  annotate("text", x=0.4, y=0.2, label=TeX("$R_{1m}$"), color="lightblue") +
  annotate("text", x=1, y=Cm(1), label=TeX("Coût marginal ($C_m$)"), color="red") +
  annotate("text", x=0.5, y=Rm2(0.5), label=TeX("$R_{2m}$"), color="green") +
  annotate("text", x=1, y=P2(1), label=TeX("demande 2 ($P_2$)"), color="darkgreen")


p_prix <- p_changement +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(P(q1), P2(q1)), labels=c(TeX("p_1^*"), TeX("p_2^*"))) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 1.2), breaks=c(q1), labels=c(TeX("$q_1^*=q_2^*$")))

p_prix
```

```{r monopolechangementdemande2, fig.cap="Exemple de réaction du monopole à un changement de demande: changement de quantité."}

p_quantité <- p_changement +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(P(q1)), labels=c(TeX("p_1^*=p_2^*"))) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 1.2), breaks=c(q1, 4/9), labels=c(TeX("$q_1^*"), TeX("$q_2^*")))

p_quantité
```

En CPP, un changement de demande, si elle implique une changement du prix d'équilibre, entraîne forcément un changement dans la quantité produite par un producteur individuel.

### L'inefficience du monopole

La production du monopole est inférieure à la production en CPP et le prix est supérieur au prix de CPP.

```{r monosurplus, fig.cap="Surplus quand le producteur est en monopole."}

P <- function(q){1-q}
Rm <- function(q){1-2*q}
Cm <- function(q){q}

q1 <- 1/3
q2 <- 1/2

Sc <- data.frame(x=c(0, q1), ymin=c(P(q1), P(q1)), ymax=c(P(0), P(q1)))
Sp <- data.frame(x=c(0, q1), ymin=c(Cm(0), Cm(q1)), ymax=c(P(q1), P(q1)))
perte <- data.frame(x=c(q1, q2), ymin=c(Cm(q1), Cm(q2)), ymax=c(P(q1), P(q2)))


p_surplus <- ggplot() +
  geom_function(fun=P, colour = "blue") +
  geom_function(fun=Rm, colour = "lightblue") +
  geom_function(fun=Cm, colour="red") +
  labs(x="quantité", y = "prix") +
  annotate("text", x=0.8, y=P(0.8), label=TeX("demande ($P$)"), color="blue") +
  annotate("text", x=0.4, y=0.2, label=TeX("$R_{m}$"), color="lightblue") +
  annotate("text", x=1, y=Cm(1), label=TeX("Coût marginal ($C_m$)"), color="red") +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  geom_ribbon(data=perte, aes(x=x, ymin=ymin, ymax=ymax), fill="black", alpha=0.5) +
  annotate("text", x=q1/2, y=3/4, label="Surplus du consommateur", color="blue") +
  annotate("text", x=q1/2, y=1/3, label="Surplus du producteur", color="red") +
  annotate("text", x=q1/2+q2/2, y=1/2, label="Perte sèche", color="black") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(P(q1)), labels=c(TeX("p_1^*"))) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 1.2), breaks=c(q1, q2), labels=c(TeX("$q_1^*"), TeX("$q_{CPP}^*")))
  
p_surplus
```

Cela signifie que le surplus du producteur (son profit) est plus élevé en monopole qu'en CPP, et que le surplus des consommateur est plus faible.
Il y a globalement une perte sèche de surplus total.
**Le monopole est inefficace au sens de Pareto.**
Il existe des consommateurs prêt à acheter à un prix supérieur au coût marginal (dans le triangle de la perte sèche).
Il est donc possible d'avoir une amélioration parétienne qui améliore à la fois la situation des consommateurs et du monopole.
Il suffirait pour cela que le monopole produise une unité supplémentaire du bien à un prix supérieur au coût marginal, sans rien changer d'autre pour obtenir cette amélioration.


## Régulation du monopole

Cette partie va traiter de la manière dont un gouvernement peut inciter un monopole à modifier son comportement.

### Taxe unitaire

Un gouvernement impose une taxe de $t$ unités monétaire par unité de bien produite.
On a donc :

\[
\pi(q) = R(q) - C(q) -tq
\]
La condition de première ordre de la maximisation du producteur de l'équation \@ref(eq:cpo) devient alors :
\[
\begin{array}{rl}
&(R(q)-C(q) -tq)'(q^*) = 0\\
\Leftrightarrow & R_m(q^*)-C_m(q*) -t = 0\\
\Leftrightarrow & R_m(q^*) = C_m(q^*) + t
\end{array}
\]
Le problème est exactement le même que précédemment, en intégrant la taxe dans le coût marginal.
Pour le monopole, c'est comme si l'état ajoutait un coût $t$ à chaque unité produite, ce qui est effectivement ce que l'état fait.

```{r monopoletaxeunitaire, fig.cap="Impact d'une taxe unitaire : augmentation du coût marginal."}
t = 0.2

p_taxeunitaire <- ggplot() +
  geom_function(fun=function(x) P(x), colour = "blue") +
  geom_function(fun=function(x) Rm(x), colour = "green") +
  labs(x="quantité", y = "prix") +
  geom_function(fun=function(x) Cm(x), colour="red") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(P(4/15), P(1/3)), labels=c(TeX("$p^*_t$"), TeX("$p^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(4/15, 1/3), labels=c(TeX("$q^*_t$"), TeX("$q^*$"))) +
  annotate("text", x=1, y=0.2, label=TeX("$P$"), color="blue") +
  annotate("text", x=0.5, y=0.2, label=TeX("$R_m$"), color="green") +
  annotate("text", x=1, y=Cm(1)-0.1, label=TeX("$C_m$"), color="red")


p_taxeunitaire  + geom_function(fun=function(x) Cm(x)+t, colour="darkred") +
  annotate("text", x=0.8, y=Cm(0.8)+t+0.1, label=TeX("$C_m+t$"), color="darkred")
```

Cela entraîne une diminution de la quantité produite et une augmentation du prix.
Le surplus des consommateurs baisse, ainsi que celui du monopole.

Une vue **alternative** à l'augmentation du coût marginal est de considérer que la taxe diminue la recette marginale de $t$ :
\[
 R_m(q^*) -t = C_m(q^*)
\]

```{r monopoletaxeunitaire2, fig.cap="Impact d'une taxe unitaire : diminution de recette marginale."}
p_taxeunitaire  + geom_function(fun=function(x) P(x)-t, colour="darkblue") +
  geom_function(fun=function(x) Rm(x)-t, colour="darkgreen") +
  annotate("text", x=0.8, y=P(0.8)-t+0.1, label=TeX("$P-t$"), color="darkblue") +
  annotate("text", x=0.4, y=Rm(0.4)-t+0.1, label=TeX("$R_m-t$"), color="darkgreen") +
  geom_segment(aes(x=0, y=P(4/15)-t, xend=4/15, yend=P(4/15)-t), linetype="dashed") +
  annotate("text", x=0.3, y = 0.5, label="Prix perçu par le monopole avec taxe")
```

Si le gouvernement utilise une taxe négative (= une subvention), alors le gouvernement peut augmenter la production et de diminuer le prix.

### Taxe forfaitaire

Avec une taxe forfaitaire, l'état prélève un montant $T$ indépendant de la quantité produite sur le profit du producteur.
\[
\pi(q) = R(q) - C(q) -T
\]
La condition du premier ordre de l'équation \@ref(eq:cpo) devient alors :
\[
\begin{array}{rl}
& (R(q)-C(q) -T)'(q^*) = 0\\
\Leftrightarrow & R_m(q^*)-C_m(q*) = 0\\
\Leftrightarrow & R_m(q^*) = C_m(q^*)
\end{array}
\]
On retrouve exactement la même condition d'optimalité qu'en l'absence de taxe.
Si elle n'est pas trop élevée, une taxe forfaitaire n'a *aucune* influence sur la quantité produite et prix.
Si la taxe forfaitaire est très élevée, supérieure au profit $R(q^*) - C(q^*) <T$, le monopole préfère ne rien produire et le surplus social est nul.

On peut donc envisager de combiner une subvention unitaire au monopole combinée à une taxe forfaitaire pour augmenter le surplus total.

### Impôt sur profit

Au lieu de taxer chaque unité produite, on peut taxe le niveau de profit à un taux $t$.
Le profit devient alors
\[
\pi(q) = R(q) - C(q) -t( R(q) - C(q)) = (1-t)(R(q) - C(q))
\]
La condition du premier ordre de l'équation \@ref(eq:cpo) devient alors :
\[
\begin{array}{rl}
&((1-t)(R(q)-C(q)))'(q^*) = 0\\
\Leftrightarrow & (1-t)(R_m(q^*)-C_m(q*)) = 0\\
\Leftrightarrow & R_m(q^*) = C_m(q^*)
\end{array}
\]

Comme pour la taxe forfaitaire, le comportement du monopole n'est pas modifié par une taxe sur le profit.
On peut donc aussi envisager une subvention à la production et une taxe proportionnelle sur le profit.

### Fixation d'un prix maximum

Le gouvernement interdit de vendre au-dessus d'une prix maximum $p^{max}$

Le gouvernement modifie ainsi la demande perçue par le producteur.

```{r monopoleprixmaximal, fig.cap="Fixation d'un prix maximal supérieur au prix de CPP."}
pmax <- 0.6
P_max <- function(q){
  if(P(q)>pmax){
    return(pmax)
  } else{
    return(P(q))
    }
}



p_prixmax <- ggplot() +
  geom_function(fun=function(x) P(x), colour = "blue") +
  geom_function(fun=function(x) Rm(x), colour = "green") +
  labs(x="quantité", y = "prix") +
  geom_function(fun=function(x) Cm(x), colour="red") +
  annotate("text", x=1, y=0.2, label=TeX("$P$"), color="blue") +
  annotate("text", x=0.4, y=0.2, label=TeX("$R_m$"), color="green") +
  annotate("text", x=1, y=Cm(1)-0.1, label=TeX("$C_m$"), color="red")


p_prixmax + geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkred") +
  geom_segment(aes(x=1-pmax, y=pmax, xend=1, yend=0), color="darkred") +
  geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkgreen") +
  geom_segment(aes(x=1-pmax, y=0.2, xend=0.5, yend=0), color="darkgreen") +
  geom_segment(aes(x=1-pmax, y=pmax, xend=0.4, yend=0.2), color="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(pmax, P(1/3)), labels=c(TeX("$p_{max}$"), TeX("$p^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(1/3, pmax), labels=c(TeX("$q^*$"), TeX("$q^*_{max}$"))) +
  annotate("text", x=1, y=0.1, label="Demande avec un prix maximal", color="darkred") +
  annotate("text", x=0.5, y=0.1, label="Recette marginale avec un prix max", color="darkgreen")
```

```{r monopoleprixmaximal2, fig.cap="Fixation d'un prix maximal inférieur au prix de CPP."}
pmax=0.2

p_prixmax +geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkred") +
  geom_segment(aes(x=1-pmax, y=pmax, xend=1, yend=0), color="darkred") +
  geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(pmax), labels=c(TeX("$p^*_{max}=p^*_{CPP}$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(pmax), labels=c(TeX("$q^*_{max}=q^*_{CPP}$"))) +
  annotate("text", x=1, y=0.1, label="Demande avec un prix maximal", color="darkred") +
  annotate("text", x=0.5, y=0.1, label="Recette marginale avec un prix max", color="darkgreen")
```

Si le prix maximum est inférieur au prix de concurrence pure et parfaite, les quantités produites peuvent devenir sous-optimale.
Le gouvernement peux maximiser le surplus social en prenant le prix concurrentiel comme prix maximum.  
*Rappel :* En CPP, on obtient le prix à l'aide de la courbe de coût marginal.
L'équilibre a lieu quand le coût marginal et la demande se croisent.

```{r monopoleprixmaximalCPP, fig.cap="Fixation d'un prix maximal égal au prix de CPP."}
pmax=0.5

p_prixmax + geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkred") +
  geom_segment(aes(x=1-pmax, y=pmax, xend=1, yend=0), color="darkred") +
  geom_segment(aes(x=0, y=pmax, xend=1-pmax, yend=pmax), color="darkgreen") +
  geom_segment(aes(x=1-pmax, y=pmax, xend=pmax, yend=0), color="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(pmax, P(1/3)), labels=c(TeX("$p_{max}$"), TeX("$p^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(1/3, pmax), labels=c(TeX("$q^*$"), TeX("$q^*_{max}$"))) +
  annotate("text", x=1, y=0.1, label="Demande avec un prix maximal", color="darkred") +
  annotate("text", x=0.5, y=0.1, label="Recette marginale avec un prix max", color="darkgreen")
```

Avec un prix maximum égal au prix de concurrence pure et parfaite, le revenu marginal comme la courbe de coût marginal au point d'équilibre de la concurrence pure et parfaite.

Globalement, si le prix maximal est entre le prix de monopole et le prix de concurrence pure et parfaite, alors la quantité produite augment quand le prix maximal diminue.
Si au contraire le prix maximal est inférieur au prix de CPP (et donc de monopole), alors la quantité produite diminue quand le prix maximal augmente.

## Le monopole naturel

Une situation de monopole naturel émerge à cause d'une structure particulière de la technologie de production et des coûts, plutôt qu'à cause d'une disposition légale.


::: {.definition name="Monopole naturel"}
Un monopole naturel émerge en présence d'une technologie dotée de rendements d'échelles *croissants* dans la zone de production optimale.
:::

Les rendements d'échelles sont croissants lorsque la technologie de production $f$ est telle que :
\[
f(\lambda z_1, \lambda z_2, ...\lambda z_n) > \lambda f(z_1,z_2, ..., z_n)
\]
où les $z_i$ sont les facteurs de productions.
En mots : une entreprise utilisant $\lambda$ fois plus de facteurs de productions qu'une petite entreprise produit plus que $\lambda$ petites entreprises réunies.

En général, un monopole naturel émerge à cause de coûts fixes élevés.
Par exemple, lorsqu'il faut investir dans un réseau (ferrés, téléphone, électricité, etc).

Une conséquence des économies d'échelles est que le coût moyen est décroissant :
\[
C_M(f(\lambda z)) =\frac{\lambda z\cdot w_z}{f(\lambda z)} < C_M(\lambda f(z)) = \frac{\lambda z\cdot w_z}{\lambda f(z)}
\]
car $f(\lambda z)>\lambda f(z)$
Cela signifie qu'une seule entreprise qui produit $f(\lambda z)$ est plus efficace que $\lambda$ entreprises qui produisent $\lambda f(z)$.

De manière générale, il y a presque toujours une zone où le coût moyen est décroissant, mais elle est rarement très étendue.
Dans le graphique \@ref(fig:monopolenaturelcout), la demande inverse 1 coupe la courbe de coût marginal à un endroit où les économies d'échelles sont décroissants.
La demande 2, en revanche, la coupe à un endroit où les économies d'échelles sont croissantes.


```{r monopolenaturelcout, fig.cap="Fonction de coût et demande avec et sans économies d'échelle."}
Cm_naturel <- function(q){q/16+1/(1+q)}
CM_naturel <- function(q){q/32+log(1+q)/q+1/q}
D1 <- function(q){10-q}
D2 <- function(q){5-2*q}

q1 <- (143+sqrt(30241))/34
q2 <- (47+sqrt(10657))/66



p_naturel <- ggplot() +
  geom_function(fun=Cm_naturel, color="darkred") +
  geom_function(fun=CM_naturel, color="red") +
  labs(x="quantité", y = "prix") +
  annotate("text", x=0.5, y=2, label=TeX("$C_M$"), color="red") +
  annotate("text", x=1, y=0.5, label=TeX("$C_m$"), color="darkred") +
  annotate("text", x=2, y=2, label="Demande 2", color="darkgreen") +
  geom_function(fun=D2, color="darkgreen")
  
p_naturel + scale_x_continuous(expand = c(0, 0), limits = c(0, 10), breaks=c(q2, q1), labels=c(TeX("$q_2$"), TeX("$q_1$"))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 2.5), breaks=c(), labels=c()) +
  annotate("text", x=9, y=2, label="Demande 1", color="green") +
  geom_function(fun=D1, color="green")

```

*Rappel :* Lorsque le coût moyen est décroissant, c'est que le coût marginal est inférieur au coût moyen.
\[
C_M(q) = \frac{C(q)}{q}
\]
\[
C_M'(q) =\frac{C'(q)q-C(q)}{q^2} = \frac{C_m(q)-C_M(q)}{q}
\]
Or $C_M'(q)<0$, comme le coût marginal est décroissant.
On en déduit donc que 
\[
C_m(q)-C_M(q)< 0 \Leftrightarrow C_m(q)<C_M(q)
\]

**Question :** Que se passe-t-il quand la fonction de demande inverse coupe la courbe de coût marginal dans la partie ou le coût marginal est inférieur au coût moyen (où $C_m<C_M$) ?

```{r monopolenaturel, fig.cap="Régulation du monopole naturel."}
Rm2 <- function(q){5-4*q}
fn2 <- function(x){Cm_naturel(x)-Rm2(x)}

fn <- function(x){CM_naturel(x)-D2(x)}
qr <- uniroot(fn, c(0.5, 2.5))$root
qm <- uniroot(fn2, c(0.5, 1.25))$root

p_naturel + scale_x_continuous(expand = c(0, 0), limits = c(0, 2.5), breaks=c(q2, qm, qr), labels=c(TeX("$q_{CPP}^*$"), TeX("$q_{m}$"), TeX("$q_R$"))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5), breaks=c(D2(qm), D2(qr), D2(q2)), labels=c(TeX("$p_m$"), TeX("$p_R$"), TeX("$p_{CPP}$"))) +
  annotate("text", x=1, y=2, label=TeX("$R_m$"), color="blue") +
  geom_function(fun=Rm2, color="blue")

```
Si on impose une tarification au coût marginal, alors le monopole fait des pertes, car le prix est inférieur au coût moyen.
La régulation "optimale" généralement utilisée impose *un prix au coût moyen* et une obligation de satisfaire toute la demande.
Le monopole fait alors un profit nul.

Une solution alternative est un prix égal au coût moyen assorti de subventions pour couvrir les pertes.

## Le monopole discriminant

Un monopole discriminant pratique un prix différent pour chaque (groupe de) consommateur.
Pour cela, il doit pouvoir identifier l'appartenance de chaque consommateur à un groupe et les marchés entre les consommateurs doivent être hermétiques.
En particulier, il ne faut pas qu'un consommateur puisse revendre son unité de produit à un autre consommateur.

Il existe 3 types de discriminations par les prix, les discrimination du premier, deuxième et troisième degrés. 
On ne traitera que les discriminations du premier et troisième degré.

### Discrimination au premier degré (discrimination parfaite)

Dans une discrimination parfaite, le monopole connaît la valorisation (prix de réserve) de chaque individu et lui fait payer le prix maximum qu'il est prêt à payer (son prix de réserve donc).
Le consommateur ne retient alors aucun surplus, la *totalité* du surplus est capturé par le producteur.

*Question :* Quel va être le niveau de production du monopole ?

Comme le monopole fait payer chaque unité à la valorisation du consommateur, la première unité est vendue au prix P(1), la deuxième au prix P(2), etc.
La recette totale est donc :
\[
R(q) = \int_0^q P(x) dx
\]
Notons le coût total $C(q)$.
Le profit est :
\[
\pi(q) = R(q) - C(q) = \int_0^q P(x) dx -C(q)
\]
La condition du premier ordre s'écrit donc :
\[
\begin{array}{rl}
&\frac{d\pi(q^*)}{dq} = 0\\
\Leftrightarrow & \frac{d\int_0^{q^*} P(x) dx -C(q^*)}{dq} = 0\\
\Leftrightarrow & P(q^*) - C_m(q^*) = 0\\
\Leftrightarrow & P(q^*) = C_m(q^*)
\end{array}
\]
La recette marginale est ici confondue avec la courbe de demande.
L'optimum se trouve donc au point où la courbe de coût marginal coupe la courbe de demande (inverse).
C'est la même condition qu'en CPP.
Le monopole parfaitement discriminant produit donc la quantité de concurrence pure et parfaite.
Le prix de la dernière unité vendue par le monopole est égal au prix de la concurrence pure et parfaite, même si les prix des autres unités vendues sont supérieur au prix de la CPP.

GRAPH avec discrimination parfaite

La situation de discrimination parfaite est un optimum de Pareto.
En effet, le surplus social est maximal (mais capturé entièrement par le monopole).

En pratique, il est très difficile de faire de la discrimination parfaite.
Les entreprises essaient de s'en approcher le plus possible.

Un exemple existe, lors d'une vente de bons du trésors des Etats-Unis.
Chaque ménage intéressé soumettait une offre (prix, quantité) au gouvernement.
Le gouvernement triait les offres par ordre décroissant de prix et les satisfait jusqu'à épuisement des bons à vendre.

### Discrimination du deuxième degré

:::{.definition name="Discrimination du deuxième degré"}
La discrimination du deuxième degré a lieu lorsque les prix de ventes dépendent des quantités achetées.
:::

Par exemple, si les 10 premières unités vendues le sont à 5€, et les suivantes à 2€.
Les prix de ventes sont nécessairement *décroissants* avec la quantité vendue.

GRAPH avec 3 seuils de quantité.

Le monopole ajuste les quantités seuil afin de maximiser son profit.
Il y a un nombre fini de seuils de dégressivité.
Plus il y a de seuils, plus on s'approche d'un situation de discrimination parfaite.


### Discrimination du troisième degré

A faire si le temps le permet.

Il s'agit de faire payer un prix différent à chaque groupe de consommateur, en fonction des caractéristiques de leurs fonctions de demande.
Tous les membres d'un groupe payent donc le même prix, contrairement à la discrimination au premier degré.
Les groupes sont en général caractérisés par des propensions à payer différentes.
Il s'agit d'une segmentation des consommateurs.

:::{.example name="Discrimination au troisième degré"}
Les tarifs jeunes de la SNCF, les tarifs familles.
Il est important de pouvoir identifier les groupes.
:::

*Question :* Comment répartir la production entre les différents groupes ?

1. Quelle production totale ?
2. Quelle répartition ?

*Méthode :* On résout d'abord 2 en supposant que 1 est déjà résolu.
On obtient alors la répartition en fonction de la production totale.
Puis ou résout 1 à l'aide de la solution de 2.

On modélise le problème de la manière suivante :

- 2 groupes A et B;
- Avec des fonctions de demande inverses $P_A(q_A)$ et $P_B(q_B)$;
- Une quantité $q$ totale a été produite, qu'il faut répartir entre les 2 groupes : $q=q_A+q_B$

Le problème du monopole s'écrit :
\[
\max_{q_A, q_B} \pi(q_A, q_B) = q_AP_A(q_A) + q_BP_B(q_B) -C(q)
\]
La quantité totale $q$ est fixée, donc le coût total l'est aussi et peut être supprimé du problème de maximisation.
On cherche donc juste à maximiser la recette totale :
\[
\max_{q_A, q_B} q_AP_A(q_A) + q_BP_B(q_B) 
\]
Avec $q=q_A+q_B$, donc $q_B=q-q_A$, le problème devient :
\[
\begin{array}{rl}
&\max_{q_A, 0\leq q_A\leq q} q_AP_A(q_A) + (q-q_A)P_B(q-q_A) \\
\Leftrightarrow &\max_{q_A, 0\leq q_A\leq q} R_A(q_A) + R_B(q-q_A) 
\end{array}
\]
La condition du premier ordre s'écrit :
\[
\begin{array}{rl}
&\frac{dR_A(q_A) + R_B(q-q_A) }{dq_A} = 0\\
\Leftrightarrow & R_{mA}(q_A) - R_{mB}(q-q_A) = 0\\
\Leftrightarrow & R_{mA}(q_A) = R_{mB}(q_B) 
(\#eq:cpo3e)
\end{array}
\]
L'équation \@ref(eq:cpo3e) nous dit que le monopole réparti la quantité totale produite de manière égaliser les recettes marginales entre les deux groupes.

Intuitivement, si la recette marginale issue du groupe A est supérieure à celle issue du groupe B ($R_{mA}(q_A) > R_{mB}(q_B)$), alors en diminuant  la quantité $q_B$ dans le groupe B et en la transférant au groupe A, le monopole perd $R_{mB}(q_B)$ et gagne $R_{mA}(q_A)$, donc la recette totale augmente et le profit aussi.
Inversement dans le cas opposé.
Il n'est donc pas intéressant de transférer la production d'un groupe vers un autre lorsque $R_{mA}(q_A) = R_{mB}(q_B)$ (et seulement dans ce cas).

Maintenant que la répartition est résolue, il faut trouver la quantité totale produite.
Le problème devient maintenant :
\[
\max_{q_A, q_B} \pi(q_A, q_B) = q_AP_A(q_A) + q_BP_B(q_B) -C(q_A+q_B)
\]
La condition du premier ordre s'obtient maintenant en dérivant suivant $q_A$ et $q_B$ séparément :
\[
\begin{array}{rcl}
\frac{\partial\pi(q_A, q_B)}{\partial q_A} = 0&\Leftrightarrow& R_{mA}(q_A^*) = C_m(q_A^*+q_B^*)\\
\frac{\partial\pi(q_A, q_B)}{\partial q_B} = 0&\Leftrightarrow& R_{mB}(q_B^*) = C_m(q_A^*+q_B^*)\\
\end{array}
\]
Le monopole doit faire en sorte que le coût marginal de sa production totale soit égale à la recette marginale sur chacun des marchés.

*Intuition :*
Le monopole doit égaliser la recette marginale sur les deux marchés.
Or le coût marginal dépend de la quantité *totale* produite, pas de la répartition entre les marchés.
Si on est dans la situation telle que $C_m(q)<R_{mA}(q_A)$, alors il y a la possibilité de faire du profit sur le marché A (et le marché B par conséquent).
Inversement, si $C_m(q)>R_{mA}(q_A)$, alors le monopole fait des pertes.

NB: On utilise bien $C_m(q_A+q_B)$ et non $C_m(q_A)$ ou $C_m(q_B)$ car c'est bien la variation du coût total lorsqu'on augmente "un peu" $q_A$ et $q_B$ reste fixe.

D'après l'équation \@ref(eq:rm), on peut écrire :
\[
\begin{array}{crcl}
&R_{mA}(q_A^*) &=& R_{mB}(q_B^*)\\
\Leftrightarrow & P_A(q_A^*)\left(1-\frac{1}{\left|\varepsilon_{q/p_A}(q^*_A)\right|}\right) & = & P_B(q_B^*)\left(1-\frac{1}{\left|\varepsilon_{q/p_B}(q_B^*)\right|}\right)
\end{array}
\]
Sans perte de généralité, on peut supposer que $P_A(q_A^*)> P_B(q_B^*)$.
On obtient alors que :
\[
1-\frac{1}{\left|\varepsilon_{q/p_A}(q_A^*)\right|} <1-\frac{1}{\left|\varepsilon_{q/p_B}(q_B^*)\right|}
\]
Autrement dit 
\[
\left|\varepsilon_{q/p_B}(q_B^*)\right|>\left|\varepsilon_{q/p_A}(q^*_A)\right|
\]
Le prix est donc plus faible pour le groupe où l’élasticité prix de la demande est plus élevée.
Le prix est plus élevé pour le groupe avec l'élasticité la plus faible, les moins réactifs au prix.

:::{.example}
Les tarifs "professionnels" dans les transports (avion, train, etc).
Les professionnels sont moins sensibles au prix car leurs dates de voyage sont moins flexibles que celles des particuliers.
Leur élasticité prix est donc plus faible et leur prix plus élevés.
:::

Des fonctions de demande inverse différentes associées à des élasticités prix de la demande différente aboutissent à des prix différents.

<!--chapter:end:02-monopole.Rmd-->

# Oligopoles

```{r oligobase, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)

x=seq(0, 0.5, length=101)
df <- data.frame(x)

p_isoprofit <- ggplot() +
  labs(x="quantité 1", y = "quantité 2")
```

## Introduction

On a vu jusqu'à présent deux cas extrêmes :

- La concurrence pure et parfaite :
il y a une infinité d'entreprise infinitésimales sur un marché  donné.
- Le monopole : il y a une seule entreprise sur un marché donné.

Dans les deux cas, l'entreprise ou les entreprises n'ont pas à se préoccuper des autres entreprises.
Dans le cas du monopole, parce qu'il n'y en a pas.
Dans le cas de la CPP, l'entreprise observe le prix du marché et prend sa décision en fonction de ce prix, et uniquement de ce prix. 
Les actions des autres entreprises ne l'influence pas.

On considère maintenant la situation où il n'y a plus une seule ou une infinité d'entreprises, mais plusieurs, qui sont en situation d'*interactions stratégiques*.
Les décisions de chaque acteur dépend des décisions des autres acteurs (ou des anticipations de ces décisions).  
On parle de *duopole* dans le cas où le marché compte deux entreprises et d'*oligopole* dans le cas où il compte plus que deux entreprises.  
Les entreprises peuvent se faire concurrence de différentes manières :

- En quantité, concurrence dite à la *Cournot* ;
- En prix, concurrence à la *Bertrand* ;
- En prenant une situation de leader ou de follower, à la *Stackelberg* ;
- En format une entente, dans un *cartel* ;
- Dans une concurrence spatiale, à la *Hotelling*.

Nous verrons dans ce cours les concurrences à la Cournot et à la Stackelberg, ainsi que les cartels.


## Duopole à la Cournot

### Introduction

On considère deux entreprises sur le même marché qui doivent choisir les quantités à produire, sans connaître la quantité choisie par l'autre (= décision simultanée).^[Même marché : bien unique et prix unique.]
Le prix est déterminé par la quantité *totale* produite par les deux entreprises et la fonction de demande sur le marché.

Chaque entreprise est caractérisée par :

- Entreprise 1 : quantité $q_1$ produite avec un coût $C_1(q_1)$ ;
- Entreprise 2 : quantité $q_2$ produite avec un coût $C_2(q_2)$.

Les fonctions de coût sont **différentes** entre les deux entreprises, contrairement au cas du monopole discriminant au troisème degré, où l'on considérait $C(q_1+q_2)$.

La fonction de demande inverse sur le marché est $P(q_1+q_2)$.
C'est différent du monopole discriminant où il y avait une fonction de demande par segment.

On a donc les fonctions de profit:
\[
\begin{array}{rcl}
\pi_1(q_1, q_2) &=& P(q_1+q_2)\cdot q_1-C_1(q_1)\\
\pi_2(q_1, q_2) &=& P(q_1+q_2)\cdot q_2-C_2(q_2)
\end{array}
\]
L'action d'une entreprise a des conséquences sur le profit réalisé par l'autre entreprise, même si celle-ci ne fait rien.
En particulier, si $q_1$ augmente, alors le prix du marché diminue, au travers de la fonction de demande inverse $P$, et donc le profit de l'entreprise 2 $\pi_2$ diminue, et réciproquement si $q_2$ augmente.
Il y a donc un conflit d'intérêt entre les producteurs.
Chaque entreprise doit anticiper l'action de l'autre et réagir à cette anticipation le mieux possible.

*Question :* Peut-il y avoir un équilibre dans cette situation ?

### Formalisation du problème


#### Expression des profits

On a des profits :
\[
\begin{array}{rcl}
\pi_1(q_1, q_2) &=& P(q_1+q_2)\cdot q_1-C_1(q_1)\\
\pi_2(q_1, q_2) &=& P(q_1+q_2)\cdot q_2-C_2(q_2)
\end{array}
(\#eq:profitcournot)
\]

Supposons que l'entreprise 1 *croit* que l'entreprise 2 va produire $q_2^a$. 
Quelle est sa production optimale ?
Son problème est :
\[
\max_{q_1} \pi_1(q_1, q_2^a) =  q_1P(q_1+q_2^a)-C_1(q_1)
\]
On peut déduire de ce problème d'optimisation la *fonction de réaction* $q_1(q_2^a)=f_1(q_2^a)$ qui maximise $\pi_1(q_1)$ en fonction de la production anticipée $q_2^a$ de l'entreprise 2.^[La fonction de réaction est parfois aussi connue sous le nom de *fonction de meilleure réponse*.]
La fonction de réaction $f_1(q_2^a)$ donne la valeur de $q_1$ qui maximise le profit quand l'entreprise 2 produit $q_2^a$.

De la même manière, l'entreprise 2 cherche à maximiser $\pi_2$ en fonction de la production anticipée $q_1^a$ de l'entreprise 1.
Son programme est :
\[
\max_{q_2} \pi_2(q_1^a, q_2) =  q_1P(q_1^a+q_2)-C_2(q_2)
\]
Elle aura également une fonction de réaction $q_2(q_1^a)=f_2(q_1^a)$.

#### Forme des fonctions de réaction

Si l'entreprise $i$ pense que l'entreprise $j$ ne va rien produire, alors elle se trouve dans une situation de monopole et se comporte comme tel.
Elle produit de manière à égaliser coût marginal et recette marginale ($R_{im}=C_{im}$).

Si l'entreprise $i$ pense que l'entreprise $j$ va produire $q_j^a>0$, alors elle est en monopole sur le **reste** de la demande.
Cette dernière correspond à la demande totale décalée de $q_j^a>0$ vers la gauche.
Le croisement entre recette marginale et coût marginal se fait donc à un niveau plus faible qu'auparavant.

Plus l'entreprise $i$ pense que l'entreprise $j$ va produire une grande quantité, plus elle aura intérêt à réduire son offre.
$q_i$ est décroissante en $q_j^a$

GRAPH avec la fonction de demande translatée.

#### Caractérisation de l'équilibre

Un équilibre $(q_1^a, q_2^a)$ doit être tel qu'aucune des deux entreprises n'ait intérêt à dévier unilatéralement :
\[
\begin{array}{rcl}
\pi_1(q_1^a, q_2^a) &\geq& \pi_1(q_1, q_2^a)\quad \forall q_1\\
\pi_2(q_1^a, q_2^a) &\geq& \pi_2(q_1^a, q_2)\quad \forall q_2
\end{array}
\]
Aux points $q_1^a$ et $q_2^a$, aucune entreprise n'a intérêt à dévier unilatéralement de l'équilibre.
Les décisions prises sont alors mutuellement compatibles.
Chaque entreprise donne sa meilleure réponse à la meilleure réponse de l'autre.
C'est ce qu'on appelle un **équilibre de Nash** : un équilibre où personne n'a intérêt à dévier unilatéralement.

Dans le cas du duopole à la Cournot, chaque entreprise doit choisir la quantité qui maximise son profit étant donné le choix de l'autre entreprise.
Chaque entreprise est donc sur sa fonction de réaction.
L'équilibre est donc à l'intersection des fonctions de réactions des deux entreprises :
\[
\begin{array}{rcl}
q_1^a&=&f_1(q_2^a)\\
q_2^a&=&f_2(q_1^a)
\end{array}
\]

GRAPH avec une situation d'équilibre.

L'équilibre n'est pas nécessairement stable.
La stabilité dépend de la pente des fonctions de réactions.

GRAPH avec équilibre instable

### Exemple

#### Données du problème

Prenons les fonctions suivantes :

\[
\begin{array}{l}
P(q_1+q_2) = a - b(q_1+q_2)\\
C_1(q_1) = cq^2_1 \\
C_2(q_2) = cq^2_2 \\
\end{array}
\]

#### Profits

On en déduit les  profits :

\[
\begin{array}{rcl}
\pi_1(q_1, q_2) &=& \left(a-b(q_1+q_2)\right)q_1-cq_1^2\\
\pi_2(q_1, q_2) &=& \left(a-b(q_1+q_2)\right)q_2-cq_2^2
\end{array}
\]


#### Fonctions de réaction 

Calculons la fonction de réaction de l'entreprise 1.
Son profit est :
\[
\pi_1(q_1, q_2^a) = aq_1-bq_1^2-bq_2^aq_1-cq_1^2 = (a-bq_2^a)q_1-(b+c)q_1^2
\]

La condition du premier ordre suivant $q_1$ s'écrit (ici $q_2^a$ est considéré comme une donnée par l'entreprise 1) :

\[
\begin{array}{crcl}
&\frac{\partial \pi_1}{\partial q_1}&=&0\\
\Leftrightarrow & (a-bq_2^a)-2(b+c)q_1^* &=& 0\\
\Leftrightarrow & q_1^* &=& \frac{(a-bq_2^a)}{2(b+c)}
(\#eq:FR1)
\end{array}
\]

On calcule de la même manière (i.e., en utilisant la condition du premier ordre sur les profits de l'entreprise 2) la fonction de réaction de l'entreprise 2 et on obtient par symétrie du problème une légère réécriture de l'équation \@ref(eq:FR1):

\[
q_2^* = \frac{(a-bq_1^a)}{2(b+c)}
\]

La symétrie du problème provient du fait que les deux entreprises ont exactement la même fonction de coût.
Ce *n'est pas le cas en général*.
Si dans un problème les fonctions de coût sont identiques, alors vous pouvez faire les calculs pour une seule entreprise et déduire simplement les résultats pour la seconde.


#### Equilibre de Cournot

Quel est alors l'équilibre de Cournot ?

On doit avoir :
\[
\begin{array}{rcl}
f_1(q_2^*) &=& q_1^*\\
f_2(q_1^*) &=& q_2^*\\
\end{array}
\]
Autrement dit :
\[
\begin{array}{rcl}
q_1^* &=& \frac{(a-bq_2^*)}{2(b+c)} \\
q_2^* &=&\frac{(a-bq_1^*)}{2(b+c)}\\
\end{array}
\]
On résout le système et on obtient :
\[
q_1^*=q_2^* = \frac{a}{3b+2c}
\]

### Une intuition graphique : les courbes d'isoprofit

On peut aussi aborder le problème à l'aide d'une intuition graphique.
Il s'agit de tracer les courbes d'*isoprofit* des entreprises.

:::{.definition name="Courbe d'isoprofit"}
Les courbes d'isoprofit est l'ensemble des couples de quantités $(q_1, q_2)$ qui permettent à une entreprise d'atteindre un niveau de profit donné.
:::

Reprenons l'expression générale des profits de l'équation \@ref(eq:profitcournot).
\[
\begin{array}{rcl}
\pi_1(q_1, q_2) &=& q_1P(q_1+q_2)-C_1(q_1)\\
\pi_2(q_1, q_2) &=& q_2P(q_1+q_2) -C_2(q_2)
\end{array}
\]
La courbe d'isoprofit pour une valeur $\pi_1$ **donnée et fixe** est :
\[
\pi_1 = q_1P(q_1+q_2)-C_1(q_1)
\]
L'équation ci-dessus définit implicitement une fonction $q_1=I_\pi(q_1, \pi_1)$ qui permet de représenter la courbe d'isoprofit dans un graphique $(q_1,q_2)$, tout comme la fonction de réaction définit une fonction courbe $q_2(q_1)$ pour l'entreprise 1.
La courbe de la fonction de réaction de 1 coupe la courbe d'isoprofit de 1 en son maximum. 
<!-- Implicitiment, le maximum sur la courbe d'isoprofit est obtenu en dérivant suivant $q_1$, tout comme on obtient la fonction de réaction. -->

```{r isoprofit1, fig.cap="Courbes d'isoprofit et fonction de réaction de l'entreprise 1", warning=FALSE}
I1 <- function(q, pi){1-pi/q-2*q}
f1 <- function(q)(1-4*q)

p <- p_isoprofit

p + geom_function(fun=function(x) I1(x, 0.1), colour = "blue") +
  geom_function(fun=function(x) I1(x, 0.1), colour = "blue") +
  geom_function(fun=function(x) I1(x, 0.11), colour = "blue") +
  geom_function(fun=function(x){I1(x, 0.05)}, colour = "blue") +
  geom_function(fun=function(x){I1(x, 0.12)}, colour = "blue") +
  geom_function(fun=function(x){I1(x, 0.07)}, colour = "blue") +  
  geom_function(fun=function(x){I1(x, 0.02)}, colour = "blue") +
  geom_function(fun=f1, colour = "red") +
  annotate("text", x=0.2, y=1, label="Fonction de réaction de 1", color="red") +
  annotate("text", x=0.3, y=0.8, label="Courbes d'isoprofit", color="blue") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(), labels=c()) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(0.25), labels=c(TeX("$q_{1m}^*$")))

```

Sur la figure \@ref(fig:isoprofit1), le profit est croissant en descendant vers le bas sur les courbes d'isoprofit, autrement dit, les courbes d'isoprofit les plus basses représentent les profits les plus élevés.
Le maximum du profit est atteint lorsque l'entreprise 1 est en monopole.
La quantité produite est alors $q_m^*$ est le profit $\pi_m^*$.

```{r isoprofitCournot, fig.cap="Courbes d'isoprofits et fonctions de réactions des entreprises en équilibre de Cournot Nash."}
I2 <- function(q, pi){1-pi/q-2*q}
f2 <- function(q)(1/4-1/4*q)

x=seq(0, 0.5, length=101)
df <- data.frame(x)

p <- p_isoprofit

p + geom_function(fun=f2, colour="darkgreen") +
  geom_function(fun=f1, colour="red") +
  stat_function(data=df, aes=(y=x), fun=function(x) I1(x, 2/25), colour="blue") +
  annotate("text", x=0.2, y=1, label="Fonction de réaction de 1", color="red") +
  annotate("text", x=0.8, y=0.2, label="Fonction de réaction de 2", color="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(0.25), labels=c(TeX("$q_{2m}^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(0.25), labels=c(TeX("$q_{1m}^*$")))

```



### Extension : oligopole à la Cournot

On étend l'analyse à $N$ entreprises qui produisent un bien *homogène*.
Comme ce bien est homogène, le prix est unique sur le marché.
Chaque entreprise $i$ choisit une quantité $q_i\geq 0$ et les produit à un coût de production $C_i(q_i)$.
La production totale sur le marché est $q=\sum_i q_i$.
La fonction de demande inverse sur le marché $P(q)$ dépend de la production *globable* $q$.

Le profit de chaque entreprise s'écrit :
\[
\pi(q_i, q_{-i}) = q_iP(q) -C_i(q_i)
\]
Où $q_{-i}$ est la somme de la production de toute les entreprises autres que l'entreprise $i$.
Autrement dit $q=q_i+q_{-i}$.

Le programme de maximisation d'une entreprise $i$ s'écrit :
\[
\max_{q_i}\pi(q_i, q_{-i}) = q_iP(q) -C_i(q_i)
\]

La condition du premier ordre est telle que :

\[
\begin{array}{crcl}
&\frac{\partial \pi_i}{\partial q_i}(q^*) &=& 0\\
\Leftrightarrow & \frac{\partial  \left(q_iP(q_i+q_{-i}) -C_i(q_i)\right)}{\partial q_i}(q^*) &= &0\\
\Leftrightarrow & P(q^*) + q_i\frac{\partial  P}{\partial q}(q^*) -C_{im}(q_i^*)&= &0\\
\Leftrightarrow & P(q^*) - C_{im}(q_i^*)&= &-q_i^*\frac{\partial  P}{\partial q}(q^*) \\
\Leftrightarrow & \frac{P(q^*)-C_{im}(q_i^*)}{P(q^*)}&= &-\frac{q_i^*}{P(q^*)}\frac{\partial  P}{\partial q}(q^*) \\
\Leftrightarrow & \frac{P(q^*) -C_{im}(q_i)^*}{P(q^*)}&= &-\frac{q^*}{P(q^*)}\frac{\partial  P}{\partial q}(q^*)\frac{q_i^*}{q^*} \\
\Leftrightarrow & \frac{P(q^*) - C_{im}(q_i^*)}{P(q^*)}&= &S_i\frac{1}{\left|\varepsilon_{q/p}(q^*)\right|}
\end{array}
\]
(La dérivée de la fonction de demande suivant le prix est négative).

On obtient le *markup-pricing* que peut appliquer un producteur en situation d'oligopole à la Cournot.
\[\frac{P(q^*) -C_{im}(q_i^*)}{P(q^*)}= \frac{S_i}{\left|\varepsilon_{q/p}(q^*)\right|}\]
La possibilité de fixer un prix au-dessus du coût marginal dépend de la part de marché de l'entreprise.


::: {.remark}
En monopole, $S_i=1$, on retrouve alors bien :
\[\frac{P(q) -C_{im}(q)}{P(q)}= \frac{1}{\left|\varepsilon_{q/p}(q)\right|}\]

En concurrence pure et parfaite $S_i\to 0$, donc $\frac{P(q) -C_{im}(q_i)}{P(q)}\to 0$, ce qui implique bien que $C_{mi}(q_i)\to P(q)$.
On retrouve ainsi le résultat $P(q^*)=C_m(q^*)$.
:::

### Indice de Lerner

*Rappel :* En monopole, l'indice de Lerner est :
\[L=\frac{P(q_m^*)-C_m(q_m^*)}{P(q_m^*)} = \frac{1}{\left|\varepsilon_{q/p}(q_m^*)\right|}\]

:::{.definition name="Indice de Lerner"}
En oligopole à la Cournot avec $n$ producteurs, on définit l'indice de Lerner par :
\[L = \sum_{i=1}^nS_iL_i\]
où $S_i=q_i/q$ est la *part de marché* de l'entreprise $i$ et $L_i$ est l'indice de Lerner propre à un producteur.
:::
$q$ est la production totale $q=\sum_{i=1}^N q_i$.
Notons $q=(q_i, q_{-i})$ le vecteur donnant les quantités produites par chaque producteur. 
$q_i$ est la quantité produite par le producteur $i$, $q_{-i}=(q_1,\dots,q_{i-1}, q_{i+1}, \dots,q_N)$ est le vecteur de toutes les unités produites par les autres producteurs.

Exprimons maintenant l'indice de Lerner d'un producteur.
\[
\begin{array}{rcl}
L_i &=&\frac{1}{\left|\varepsilon_{q/p}(q_i, q_{-i})\right|}=\frac{P(q^*)-C_{im}(q_i^*)}{P(q^*)}\\
&=&\frac{1}{\left|\frac{1}{\frac{\partial P}{\partial q}(q)}\frac{P(q)}{q_i}\right|}\\
&=&\frac{1}{\left|\frac{1}{\frac{\partial P}{\partial q}(q)}\frac{P(q)}{q}\frac{q}{q_i}\right|}\\
&=&\frac{1}{\left|\frac{1}{\frac{\partial P}{\partial q}(q)}\frac{p}{q}\right|}\frac{q_i}{q}\\
&=&\frac{S_i}{\left|\varepsilon_{q/p}(q)\right|}\\
\end{array}
\]

On peut donc réécrire l'indice de Lerner uniquement en fonction de l'élasticité de la demande à l'équilibre et des parts de marchés de chaque producteur :
\[
L=\frac{1}{\left|\varepsilon_{q/p}(q^*)\right|}\sum_{i=1}^NS_i^2
\]

### Indice de concentration du marché


:::{.definition #HHI name="Indice de Hirschman-Herfindahl (HHI)"}
L'indice de Hirschman-Herfindahl est la somme des carrés des part de marchés.
\[HHI = \sum_{i=1}^NS_i^2\]
C'est aussi la différence moyenne entre le coût marginal de production et le prix, multiplié par l'élasticité prix de la demande à l'optimum.
Autrement dit, la moyenne des $L_i$ pondéré par les parts de marché.
:::

 \[
 \begin{array}{rcl}
 \sum_{i=1}^{N}\frac{P(q) -C_{im}(q_i)}{P(q)}S_i &=&\sum_{i=1}^{N} \frac{S_i}{\left|\varepsilon_{q/p}(q^*)\right|}S_i \\
 &=&\frac{1}{\left|\varepsilon_{q/p}(q^*)\right|}\sum_{i=1}^NS_i^2\\
 &=&\frac{HHI}{\left|\varepsilon_{q/p}(q^*)\right|}
 \end{array}
 \]

Interprétation :  
Imaginons que tout les $N$ entreprises sont identiques (même fonction de coût).
Elles produisent alors la même quantité optimale à l'équilibre.
Leur part de marché est donc $S_i=1/N$.
Le HHI vaut :
\[
\begin{array}{rcl}
HHI&=&\sum_{i=1}^NS_i^2\\
&=&\sum_{i=1}^N\frac{1}{N^2}\\
&=&\frac{N}{N^2} \\
&=&\frac{1}{N}
\end{array}
\]
Le HHI correspond à l'inverse du nombre du nombre d'entreprise qui serait identique sur le marché et donnerait le même écart moyen entre coût marginal et prix.
Plus le HHI est proche de 1, plus on se rapproche du monopole.

Le HHI est utilisé par les autorités de la concurrence pour évaluer les effets sur les prix de fusions d'entreprises.
Elles peuvent interdire des fusions qui augmenteraient trop fortement le HHI.


## Duopole à la Stackelberg

### Introduction

Il n'y a plus de symétrie des entreprises dans un duopole à la Stackelberg.
Une entreprise, dite *leader*, prend ses décisions avant l'entreprise dite *follower*.
L'entreprise leader connaît les caractéristiques de l'entreprise follower et peut ainsi calculer sa fonction de réaction.
Elle va donc en tenir compte dans ses décisions.
On considère ici qu'il n'y a que deux périodes de décisions.

### Résolution graphique

Le leader doit choisir sa quantité $q_1$ de façon à être sur la courbe d'isoprofit la plus basse possible compatible avec la fonction de réaction de la firme follower.
Il va donc se placer sur la courbe d'isoprofit tangente à la fonction de réaction du follower.

```{r equilibreStackelberg, fig.cap="Courbes d'isoprofits et fonctions de réactions des entreprises en équilibre de Stackelberg."}
p <- p_isoprofit

IL <- function(q, pi){1-pi/q-q}
fF <- function(q)(1/2-1/2*q)
fL <- function(q)(1-2*q)


p + geom_function(fun=fF, colour="darkgreen") +
  geom_function(fun=fL, colour="red", linetype="dashed" ) +
  stat_function(fun=function(x) IL(x, 1/9), colour="blue") +
  stat_function(fun=function(x) IL(x, 1/8), colour="red") +
  annotate("text", x=0.4, y=1, label="Fonction de réaction du leader (en Cournot)", color="red") +
  annotate("text", x=0.9, y=0.2, label="Fonction de réaction du follower", color="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(.25, 1/3, 0.5), labels=c(TeX("$q_{2C}^*$"), TeX("$q_{1F}^*$"), TeX("$q_{2m}^*$"))) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1.2), breaks=c(1/3, 0.5), labels=c(TeX("$q_{C}^*$"), TeX("$q_{L}^*$"))) +
  annotate("point", x=1/3, y=1/3, colour="blue", size=3) +
  annotate("text", x=0.4, y=0.4, colour="blue", label="Cournot") +
  annotate("point", x=1/2, y=1/4, colour="red", size=3) +
  annotate("text", x=0.5, y=0.3, colour="red", label="Stackelberg") 
```

Sur la figure \@ref(fig:equilibreStackelberg), on voit que le profit du leader est plus important en Stackelberg qu'en Cournot (et l'inverse pour le follower).
Les quantités produites par l'entreprise leader sont plus importantes en Stackelberg qu'en Cournot, mais celle du follower sont plus faible.
La somme des deux est plus importante ($q_{1C}^*+q_{2C}^*<q_{L}^*+q_{F}^*$).
Le prix sera donc plus faible pour les consommateurs.

### Exemple

#### Données du problèmes

Notons les variables et fonctions du leader avec un indice $L$ et celles du follower avec un indice $F$.

Gardons une fonction de demande linéaire.

\[
P(q_L+q_F) = a - b(q_L+q_F)
\]

Supposons, afin de simplifier les calculs, que les coûts marginaux sont nuls.

#### Profits

On en déduit les  profits :

\[
\begin{array}{rcl}
\pi_L(q_L, q_F) &=& \left(a-b(q_L+q_F)\right)q_L\\
\pi_F(q_L, q_F) &=& \left(a-b(q_L+q_F)\right)q_F
\end{array}
\]

#### Fonction de réaction de l'entreprise follower

Calculons la fonction de réaction de l'entreprise follower.
La condition du premier ordre suivant $q_F$ s'écrit (ici $q_L$ est considéré comme une donnée par l'entreprise 1) :

\[
\begin{array}{crcl}
&\frac{\partial \pi_F}{\partial q_F}&=&0\\
\Leftrightarrow & (a-bq_L)-2bq_F^* &=& 0\\
\Leftrightarrow & q_F^* &=& \frac{a-bq_L}{2b}
(\#eq:FRFollower)
\end{array}
\]

#### Maximisation de l'entreprise leader

Comme l'entreprise leader connaît la fonction de réaction de l'entreprise follower (donnée par l'équation \@ref(eq:FRFollower)), elle peut l'intégrer à sa propre fonction de profit :

\[
\begin{array}{rcl}
\pi_L(q_L, q_F^*) &=& \left(a-b(q_L+q_F^*(q_L))\right)q_L\\
 &=& \left(a-b\left(q_L+\frac{a-bq_L}{2b}\right)\right)q_L\\
 &=& \frac{a}{2}q_L-\frac{b}{2}q_L^2
\end{array}
\]

La condition de premier ordre du leader est :

\[
\begin{array}{crcl}
&\frac{\partial \pi_L}{\partial q_L}&=&0\\
\Leftrightarrow & \frac{a}{2}-bq_L^* &=& 0\\
\Leftrightarrow & q_L^* &=& \frac{a}{2b}
\end{array}
\]

On en déduit qu'à l'équilibre de Stackelberg, le follower produit :
\[
q_F^*=\frac{a}{4b}
\]

L'entreprise leader produit plus que l'entreprise follower.
Elle profite de son pouvoir sur la seconde entreprise pour cela.
Si on calcule le profit, on verra que le profit de l'entreprise leader est plus important que celui de l'entreprise follower si elles sont exactement symétriques, en dehors de leur prises de décisions.

## Cartels et collusions

### Introduction

En duopoles / oligopoles de Cournot ou de Stackelberg, les entreprises ne coopèrent pas entre elles :

- Elles sont en concurrence ;
- Elles agissent indépendamment les unes des autres.

*Question :*  
Que se passe-t-il si elles peuvent s'entendre ?
Par exemple, que se passe-t-il si elle peuvent passer un accord sur la quantité à produire.

*Résultats :*  
Les quantités mises sur le marché vont diminuer, et le prix du marché va augmenter.
C'est donc néfaste pour les consommateurs.
La raison est que le cartel se comporte exactement comme un monopole, puis partage les bénéfices.

### Raisonnement graphique

### Résolution analytique

#### Idée

L'idée derrière la résolution analytique du problème du cartel est de considérer que le cartel se comporte comme un monopole avec 2 centres de productions.
Le cartel choisit la quantité globale produite et la répartition entre les entreprises.
C'est un raisonnement très similaire à un monopole discriminant au troisième degré.

#### Profits

Le profit global du cartel s'écrit :
\[
\pi_c=qP(q)-C_A(q_A)-C_B(q_B)=(q_A+q_B)P(q_A+q_B)-C_A(q_A)-C_B(q_B)
\]
Où $q=q_A+q_B$.
Le profit est maximisé lorsque les dérivées partielles suivant chacune des quantités sont nulles (condition du premier ordre), c'est-à-dire lorsque $\frac{\partial\pi_C}{\partial q_A}=0$ et $\frac{\partial\pi_C}{\partial q_B}=0$.
\[
\frac{\partial\pi_C}{\partial q_A} = P(q) + q\frac{\partial P}{\partial q}(q_A)-\frac{\partial C_A}{\partial q_A}(q_A)
\]
On a $P(q) + q\frac{\partial P}{\partial q}=R_m(q)$ est la recette marginale totale du cartel.
$\frac{\partial C_A}{\partial q_A}=C_{mA}$ est le coût marginal de l'entreprise A.  
On peut réécrire la dérivée du profit total suivant la quantité produite par l'entreprise A :
\[
\frac{\partial\pi_C}{\partial q_A} = R_m(q)  - C_{mA}(q_A)
\]
En utilisant le même raisonnement, on a pour l'entreprise B :
\[
\frac{\partial\pi_C}{\partial q_B} = R_m(q)  - C_{mB}(q_B)
\]

#### Optimalité pour le cartel

A l'optimum pour le cartel, on a donc :
\[R_m(q) = C_{mA}(q_A) = C_{mB}(q_B)\]
Le cartel égalise la recette marginale *totale* aux coûts marginaux de chacune des deux entreprises.

*Remarque :* Le cartel ne va pas forcément donner à produire la même quantité à chaque entreprise.
La répartition dépend des coûts marginaux respectifs.
Si les coûts marginaux sont identiques, les productions seront identiques.

*Intuition :* Supposons que la quantité totale produite est fixée.
Supposons aussi que $C_{mA}(q_A)>C_{mB}(q_B)$.  
Alors, en transférant la production d'une unité de l'entreprise A vers l'entreprise B, le coût diminue de $C_{mA}(q_A)$ et augmente de $C_{mB}(q_B)$.
Il diminue donc au total, tout en maintenant la même quantité totale produite.  
Autrement dit, tant que $C_{mA}(q_A)\neq C_{mB}(q_B)$, il est possible de diminuer le coût total de production d'une quantité donnée en répartissant celle-ci différemment entre les entreprises.

#### Optimalité pour une entreprise

*Question :* Prenons l'entreprise A, a-t-elle intérêt à rester dans le cartel (et à respecter la répartition donnée par celui-ci) ?

Le profit de l'entreprise A s'écrit :
\[
\pi_A=q_AP(q)-C_A(q_A)=q_AP(q_A+q_B)-C_A(q_A)
\]
La dérivée du profit s'écrit donc :
\[
\frac{\partial\pi_A}{\partial q_A}(q_A)=P(q_A+q_B)+q_A\frac{\partial P}{\partial q}(q_A)-C_{mA}(q_A)
\]
La condition d'optimalité du cartel suivant $q_A$ donne :
\[
\begin{array}{crcl}
& P(q_A^*+q_B^*) + (q_A^*+q_B^*)\frac{\partial P}{\partial q}(q_A^*)-\frac{\partial C_A}{\partial q_A}(q_A^*)& = &0\\
\Leftrightarrow &  P(q_A^*+q_B^*) + q_A^*\frac{\partial P}{\partial q}(q_A^*)-\frac{\partial C_A}{\partial q_A}(q_A^*)& = &-q_B^*\frac{\partial P}{\partial q}(q_A^*)\\
\Leftrightarrow & \frac{\partial\pi_A}{\partial q_A}(q_A^*)& =  &-q_B^*\frac{\partial P}{\partial q}(q_A^*)
 \end{array}
\]
Or on sait que la fonction de demande inverse $P(q)$ est décroissante avec les quantités produites, ou  que la fonction de demande est décroissante avec le prix, ce qui revient au même.
Donc $\frac{\partial P}{\partial q}(q_A)<0$.
On en déduit donc que $\frac{\partial\pi_A}{\partial q_A}(q_A^*)>0$ : l'entreprise A a intérêt à augmenter sa production si elle pense que l'entreprise B va respecter l'accord du cartel (et réciproquement).

En conclusion, les accords de cartel ne sont pas "naturellement" stable, ils ont besoin d'un mécanisme qui maintient l'accord, par exemple en punissant une entreprise déviant de l'accord.

<!--chapter:end:03-oligopoles.Rmd-->

# Exercices

## Concurrence pure et parfaite

:::{ .exercise #cppexo1}

On considère un consommateur dont la fonction de demande optimale pour un bien est donnée par :
\[
Q(p)=10-p
\]
où $p$ est le prix du bien.


1. Donnez la fonction de demande inverse correspondante. Représentez la graphiquement.
2. Quel est le prix maximum que le consommateur est prêt à payer pour la première unité de bien ? Et pour la cinquième ?
3. Calculez le surplus du consommateur lorsque le prix est de $p=2$. Interprétez la valeur obtenue. 
:::

:::{.solution name="Exercice \@ref(exr:cppexo1)"}
La fonction de demande inverse est la fonction inverse de la fonction de demande.
Autrement dit, elle exprime le prix $P$ en fonction de la quantité $q$ plutôt que la quantité $Q$ en fonction du prix $p$.
Ici on $q=10-p$, ce qui équivaut à $p=10-q$.
La fonction de demande inverse est donc $P(q)=10-q$.
Graphiquement, on obtient :

```{r cppexo11, fig.cap="Représentation graphique de la demande inverse."}
P <- function(q){10-q}

p <- ggplot() +
  geom_function(fun=P, color="blue") +
  labs(x="quantité", y = "prix") +
  annotate("text", x= 6, y=6, label="Demande inverse", color="blue")

p + scale_x_continuous(expand = c(0, 0), limits=c(0, 12), breaks=c(10), labels=c(10)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 12), breaks=c(10), labels=c(10))

```

2. Pour la première unité de bien, on utilise la fonction de demande inverse.
Le prix que le consommateur est prêt à payer pour la première unité est $P(q=1)=9$.
Pour la cinquième unité, c'est $P(q=5)=5$.
Dans les deux cas, ce sont le prix maximal que les consommateurs sont prêts à payer pour l'unité supplémentaire du bien.
Rappelez-vous que la courbe de demande inverse représente l'ensemble des prix maximaux que les consommateurs sont prêts à payer pour une unité supplémentaire du bien.

3. Le surplus du consommateur est la somme des différences entre le prix maximal que chaque individu est prêt à payer et le prix auquel il paie effectivement le bien.
Mathématiquement, le surplus du consommateur s'exprime toujours ainsi :
\[
S_c=\int_0^{q^*}P(q)-p^*dq
\]
Où $p^*$ et $q^*$ représente le prix sur le marché, et $q^*$ la quantité échangée.


```{r cppexo13, fig.cap="Représentation graphique du surplus du consommateur."}
Sc=data.frame(x=c(0, 8), ymin=c(2, 2), ymax=c(10, 2))

p + geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 12), breaks=c(8, 10), labels=c(TeX("$q^*=8$"), 10)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 12), breaks=c(2, 10), labels=c(TeX("$p^*=2$"), 10)) +
  geom_segment(data=Sc, aes(x=x), x=0, y=2, xend=8, yend=2, linetype="dashed") +
  annotate("text", x=2, y=5, label="Surplus du consommateur", color="blue") +
  geom_segment(data=Sc, aes(x=x), x=8, y=0, xend=8, yend=2, linetype="dashed")
```

En général, comme on peut le voir sur la figure \@ref(fig:cppexo13), il est possible de calculer le surplus en utiliser la formule donnant l'aire d'un triangle.
Ici, on obtient :
\[S_c=\frac{1}{2}(10-2)\cdot(8-0)=32\]
Les consommateurs "gagnent" donc 32 par rapport à la situation où ils devraient payer chacun leur prix de réserve.
:::


:::{ .exercise #cppexo2}
On considère une firme faisant face à la contrainte technologique donnée par la fonction de coût total :
\[C(q)=q^2+10q\]

1. Donnez la fonction de coût marginal correspondant.
2. Déterminez la fonction d'offre de cette firme. Représentez la graphiquement.
3. On suppose que la fonction de demande inverse du marché est donnée par :
\[P(q)=100-q\]
Déterminez le prix d'équilibre sur le marché, le surplus du producteur, le surplus du consommateur ainsi que le surplus total.
4. Supposons que l'État impose un prix $p=80$. Quelle va être la quantité échangée ? Quel sera le surplus total ? Et si l'état impose un prix $p=20$ ? Représentez graphiquement ces deux situations. En déduire que l'équilibre concurrentiel maximise le surplus total.
:::

:::{.solution name="Exercice \@ref(exr:cppexo2)"}
La fonction de coût marginal est la dérivée de la fonction de coût total.
La fonction de coût marginal donne le coût de production d'une unité de bien supplémentaire.
\[C_m(q)=C'(q)=2q+10\]

2. La fonction d'offre des producteurs en concurrence pure et parfaite est égale à la fonction de coût marginal.
Si on la note $S$, $S(q)=C_m(q) = 2q+10$.
C'est le prix minimal auquel elle est prête à vendre une unité de bien supplémentaire.

```{r cppexo22, fig.cap="Représentation graphique de la demande inverse."}
S <- function(q){10+2*q}

p <- ggplot() +
  geom_function(fun=S, color="red") +
  labs(x="quantité", y = "prix") +
  annotate("text", x=50, y=75, label="Offre", color="red")

p + scale_x_continuous(expand = c(0, 0), limits=c(0, 100)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 100))

```

3. A l'équilibre sur le marché, une quantité $q^*$ de biens est échangée au prix $p^*$.
Le marché vérifie alors les équations suivantes :
\begin{equation}
p^*=S(q^*)=P(q^*)
(\#eq:cppequilibre)
\end{equation}
Commençons par la deuxième partie de l'équation \@ref(eq:cppequilibre) :
\begin{align*}{crcl}
&2q^*+10&=&100-q^*\\
\Leftrightarrow&3q^*&=&90\\
\Leftrightarrow & q^*&=&30
\end{align*}
La quantité échangée à l'équilibre est donc de $q^*=30$.
A l'aide de la quantité échangée est de la première partie de l'équation \@ref(eq:cppequilibre), on obtient
\[
p^*=P(q^*=30) = 100-30=70 
\]
Sur le marché, 30 unités de bien sont donc échangés au prix de 70.
On peut alors représenter les surplus sur le marché, comme dans la figure \@ref(fig:cppexo23).
Le surplus des consommateurs est l'aire du triangle bleu, il vaut 
\[S_c=\frac{1}{2}(100-70)\times(30-0)=450\]
Le surplus des producteurs est l'aire du triangle rouge :
\[
S_p=\frac{1}{2}(70-10)\times(30-0) = 900
\]

```{r cppexo23, fig.cap="Surplus en CPP."}
P <- function(q){100 - q}
Sc <- data.frame(x=c(0, 30), ymin=c(70, 70), ymax=c(100, 70))
Sp <- data.frame(x=c(0, 30), ymin=c(10, 70), ymax=c(70, 70))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 30, 100), labels=c(0, TeX("$q^*=30$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 70, 100), labels=c(10, TeX("$p^*=70$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=20, y=80, label="Surplus du consommateur", color="blue") +
  annotate("text", x=20, y=50, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=30, y=70, yend=70, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=30, xend=30, y=0, yend=70, linetype="dashed") 
```

Le surplus total est la somme des surplus des producteurs et des consommateurs :
\[
S_t^{CPP}=S_c+S_p=1350
\]

4. On regarde maintenant le cas l'état impose un prix $p^E=80$.
La demande globale vaut alors de $Q(p^E)=100-p^E=20$, que l'on l'obtient en inversant la demande inverse, autrement dit en trouvant la quantité $q$ telle que $P(q)=p^E=80$.
L'offre globale vaut $S(p^E)=\frac{p^E-10}{2}=35$, que l'on obtient en inversant la fonction d'offre, autrement dit en trouvant la quantité $q$ telle que $S(q)=p^E=80$.
La demande globale est plus faible que l'offre globale, c'est donc la demande globale qui fixera les quantités échangées. 
La quantité échangée vaut donc 20.
Graphiquement, on obtient la figure \@ref(fig:cppexo24prixhaut).

```{r cppexo24prixhaut, fig.cap="Surplus en quand l'Etat impose un prix $p^E=80$."}
Sc <- data.frame(x=c(0, 20), ymin=c(80, 80), ymax=c(100, 80))
Sp <- data.frame(x=c(0, 20), ymin=c(10, 50), ymax=c(80, 80))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 20, 100), labels=c(0, TeX("$q^E=20$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 50, 80, 100), labels=c(10, 50, TeX("$p^E=80$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=20, y=90, label="Surplus du consommateur", color="blue") +
  annotate("text", x=20, y=60, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=20, y=80, yend=80, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=20, xend=20, y=0, yend=80, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=20, y=50, yend=50, linetype="dashed")
```
Le surplus total est dans ce cas l'aire du trapèze bleu et rouge.
Il nous faut obtenir le point sur la courbe d'offre pour la quantité $q^E$.
En ce point, le prix est $S(q^E)=50$.
\[
S_t=\frac{1}{2}(100-10+80-50)\times(20-0)=1200 < S_t^{CPP}
\]
Le surplus total est dans ce cas plus faible qu'en CPP.

On s'intéresse finalement au cas où l'état impose un prix $p^E=20$.
La demande globale vaut alors de $Q(p^E)=100-p^E=80$, que l'on l'obtient en inversant la demande inverse, autrement dit en trouvant la quantité $q$ telle que $P(q)=p^E=20$.
L'offre globale vaut $S(p^E)=\frac{p^E-10}{2}=5$, que l'on obtient en inversant la fonction d'offre, autrement dit en trouvant la quantité $q$ telle que $S(q)=p^E=20$.
L'offre globale est plus faible que la demande globale, c'est donc l'offre globale qui fixera les quantités échangées. 
La quantité échangée vaut donc 20.
Graphiquement, on obtient la figure \@ref(fig:cppexo24prixbas).

```{r cppexo24prixbas, fig.cap="Surplus en quand l'Etat impose un prix $p^E=20$."}
Sc <- data.frame(x=c(0, 5), ymin=c(20, 20), ymax=c(100, 95))
Sp <- data.frame(x=c(0, 5), ymin=c(10, 20), ymax=c(20, 20))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 5, 100), labels=c(0, TeX("$q^E=5$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 20, 95, 100), labels=c(10, 20, TeX("$p^E=95$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=15, y=100, label="Surplus du consommateur", color="blue") +
  annotate("text", x=15, y=15, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=5, y=95, yend=95, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=5, xend=5, y=0, yend=95, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=5, y=20, yend=20, linetype="dashed")
```
Le surplus total est dans ce cas l'aire du trapèze bleu et rouge.
Il nous faut obtenir le point sur la courbe d'offre pour la quantité $q^E$.
En ce point, le prix est $S(q^E)=20$.
\[
S_t=\frac{1}{2}(100-10+95-20)\times(5-0)=\frac{825}{2}=412.5 < S_t^{CPP}
\]
Le surplus total est dans ce cas aussi plus faible qu'en CPP.

Ces deux situations illustrent les deux cas qui s'écartent de la CPP : un prix plus élevé ou un prix plus faible.
Dans les deux cas, on voit que le surplus total est plus faible.
Ce serait vrai pour n'importe quel prix différent du prix de la concurrence pure et parfaite.
On illustre ainsi le fait que l'équilibre de CPP maximise le surplus total.
:::

## Exercices sur le comportement monopole

::: {.exercise #monoexo1 name="Questions de cours"}
Questions de cours :

1. Quand la demande de bien est inélastique, la recette
marginale est-elle positive ?
2. Un monopole maximise son profit dans la zone où les
quantités demandées sont élastiques au prix. Vrai ou faux ?
3. Dans quel cas un monopole se comportera-t-il comme
s'il était en situation de concurrence pure et parfaite (sans
intervention de l'État) ?
4. Une entreprise a un taux de marge (indice de Lerner) de 45%.
Quelle est l'élasticité de la demande à laquelle
elle fait face ?
:::

::: {.solution name="Solution de l'exercice \@ref(exr:monoexo1)"}
Réponses :

1. Non, cf cours.
2. Vrai, cf cours.
3. Si l'élasticité prix de la demande est infini.
4. On a d'après la définition de l'indice de Lerner \@ref(eq:Lerner) :
\[L=\frac{P(q^*)-C_m(q^*)}{P(q^*)}=\frac{1}{\left|\varepsilon_{p/q}(q^*)\right|}=0.45\]
Donc $\left|\varepsilon_{p/q}(q^*)\right| =1/0.45=20/9$.
:::

::: {.exercise #monoexo2}
On considère une entreprise en monopole sur son marché dont la fonction de coût est :
\[C(q)=\frac{1}{20} q^2+15q+500\] 
et qui fait face à la fonction de demande inverse : \[P(q)=45-0,2q\]

1. Déterminer le prix $p_m^*$ et la quantité $q_m^*$ d'équilibre du monopole.
2. Les représenter graphiquement.
3. Calculer l'élasticité prix de la demande au point d'équilibre. Interpréter le résultat.
4. Calculer le surplus des consommateurs et le profit du monopole.
5. Déterminer le prix et la quantité correspondant à l'optimum de Pareto (concurrence pure et parfaite). Montrer que dans cette situation le surplus des consommateurs et le surplus social sont plus élevés, et que le profit du producteur est plus faible.
6. Calculer la charge morte du monopole.
:::

::: {.solution name="Solution de l'exercice \@ref(exr:monoexo2)"}
Réponses.

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=\frac{1}{10}q+15\]
Et :
\[R(q) =qP(q)=45q-\frac{1}{5}q^2\]
Donc :
\[R_m(q)=45-\frac{2}{5}q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&45-\frac{2}{5}q^*&=&\frac{1}{10}q^*+15\\
\Leftrightarrow & 30&=&\frac{1}{2}q^*\\
\Leftrightarrow & q^*&=&60
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-\frac{2}{5}\]
\[C'_m(q)=\frac{1}{10}>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Finalement, le prix est $p^*=P(q^*)=33$.

```{r monoexo21, fig.cap="Représentation graphique"}
P <- function(q){45-0.2*q}
Rm <- function(q){45-0.4*q}
Cm <- function(q){0.1*q+15}
q1 <- 60
q2 <- 100

p_exo2 <- ggplot() +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 50), breaks=c(15, Cm(q1), Cm(q2), P(q1), 45), labels=c(15, 21,TeX("p^*_{CPP}=25"), TeX("p^*_m=33"), 45)) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 250), breaks=c(q1, q2), labels=c(TeX("$q^*_m=60"), TeX("$q^*_{CPP}=100"))) +
  labs(x="quantité", y="prix") +
  geom_function(fun=P, color="darkgreen") +
  geom_function(fun=Rm, color="blue") +
  geom_function(fun=Cm, color="red") +
  annotate("text", x=200, y=P(200), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=120, y=Rm(100), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=200, y=Cm(200), label=TeX("Coût marginal ($C_m$)"), color="red")

p_exo2
```

3. On a l'élasticité prix de la demande à l'équilibre :
\[\varepsilon_{q/p}(q^*)=\frac{p^*}{q^*}\frac{1}{P'(q^*)}=\frac{33}{60}\frac{1}{-0.2}=-\frac{11}{4}\]
La valeur absolue est bien plus grande que 1, nous sommes bien dans la zone où la demande est élastique.
On peut aussi la calculer à l'aide de :
\[\frac{p^*-C_m(q^*)}{p^*}=\frac{33-6-15}{33}=\frac{4}{11}=\frac{1}{|\varepsilon_{q/p}(q^*)|}\]
On calcule ainsi le pouvoir du monopole : sa capacité à imposer au consommateur un prix à l'équilibre supérieur à son coût marginal.

4. Commençons par la représentation graphique.

```{r monoexo22, fig.cap="Avec les surplus en monopole."}
Sc <- data.frame(x=c(0, q1), ymin=c(P(q1), P(q1)), ymax=c(P(0), P(q1)))
Sp <- data.frame(x=c(0, q1), ymin=c(Cm(0), Cm(q1)), ymax=c(P(q1), P(q1)))
perte <- data.frame(x=c(q1, q2), ymin=c(Cm(q1), Cm(q2)), ymax=c(P(q1), P(q2)))

p_exo2 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=q1/2, y=35, label="Sc", color="darkgreen") +
  annotate("text", x=q1/2, y=25, label="Sp", color="red") +
  geom_ribbon(data=perte, aes(x=x, ymin=ymin, ymax=ymax), fill="black", alpha=0.5) +
  annotate("text", x=q1/2+q2/2, y=25, label="Perte sèche", color="black")
  
```

Le surplus des consommateurs se calcule en calculant l'aire du triangle vert dans la figure \@ref(fig:monoexo22).
On obtient :
\[S_c=\frac{(45-33)(60-0)}{2}=360\]
Le surplus du producteur s'obtient en calculant l'aire du trapèze rouge :
\[S_p=\frac{(33-15+33-21)(60-0)}{2}=900\]
Le profit du producteur est le surplus diminué du coût fixe, qui vaut ici 500. Le profit vaut  donc 400.
Le surplus total est la somme des surplus des consommateurs et du producteur, soit $S_T=1260$.

5. En CPP, le prix est fixé par le marché et le prix est égal au coût marginal.
On a (ici $q^*$ et $p^*$ sont différents des parties précédentes) :
\[C_m(q^*)=P(q^*)=p^*\]
Soit : 
\[\frac{1}{10}q^*+15=45-\frac{1}{5}q^*\]
En résolvant l'équation, on obtient $q^*=100$ et on peut en déduire $p^*=25$.
Pour calculer les surplus, on commence par la représentation graphique.

```{r monoexo23, fig.cap="Avec les surplus en CPP."}
Sc <- data.frame(x=c(0, q2), ymin=c(P(q2), P(q2)), ymax=c(P(0), P(q2)))
Sp <- data.frame(x=c(0, q2), ymin=c(Cm(0), Cm(q2)), ymax=c(P(q2), P(q2)))

p_exo2 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=q1/2, y=35, label="Sc", color="darkgreen") +
  annotate("text", x=q1/2, y=20, label="Sp", color="red") 
```

On calcule l'aire du triangle vert pour obtenir le surplus total des consommateurs.
Il vaut 1000, ce qui est supérieur au surplus obtenu en monopole.

On calcule l'aire du triangle rouge pour obtenir le surplus total du producteur.
Il vaut 500.
Si maintenant on enlève le coût fixe pour obtenir le profit, on obtient un profit nul.
Il est donc plus faible qu'en monopole.

Le surplus total en CPP vaudrait donc 1500, ce qui est supérieur au surplus total obtenu en monopole.

6. La charge morte du monopole est la différence entre le surplus total en CPP et en monopole, soit $1500-1260=240$.
On peut aussi la calculer en utilisant l'aire du triangle noir sur la figure \@ref(fig:monoexo22).
:::

::: { .exercise #monoexo3}
Sur un marché dominé par un producteur unique, la fonction de demande inverse pour une quantité $q$ de bien est :
\[P(q)=250-q\] 
La fonction de coût total du monopole est :
\[C(q)=4q^2+10q+400\]


1. Quelle est la production d'équilibre du monopole ? Quel est le
prix de vente ainsi que le profit du producteur ?
2. Comparez la solution précédente avec l'équilibre qui serait
réalisé si l'entreprise se comportait comme en situation de
concurrence pure et parfaite.
3. Dans chacun des cas ci-dessus, calculez le surplus du
producteur, du consommateur, ainsi que le surplus total. Concluez
sur l'impact de la présence d'un monopole sur le niveau de bien-être
social.
4. Supposez que le producteur détienne un stock très important du bien
(son coût marginal de production est nul). Donnez la solution du
monopole dans une telle situation.
:::

::: { .solution name="Solution de l'exercice  \@ref(exr:monoexo3)."}
Réponses:

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=C'(a)=8q+10\]
Et :
\[R(q) =qP(q)=250q-q^2\]
Donc :
\[R_m(q)=R'(q)=250-2q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&250-2q^*&=&8q^*+10\\
\Leftrightarrow & 240&=&10q^*\\
\Leftrightarrow & q^*&=&24
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-2\]
\[C'_m(q)=8>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_M=P(q^*)=33$.
Finalement, on peut calculer le profit :
\[
\pi^M(q^*)=R(q^*)-C(q^*)=p^*q^*-C(q^*)=24\times226-(4\times24^2+10\times24+400)=2480>0
\]
Le profit est bien positif, ce qui est la dernière condition à vérifier pour l'optimum.

A l'optimum, il y a 24 unités de bien échangées sur le marché, au prix de 226.
Cela permet au monopole de faire un profit de 2480.

On représente graphiquement la situation obtenue sur la figure \@ref(fig:monoexo31).



2. En CPP, le prix est fixé par le marché, le producteur le considère comme une donnée dans son optimisation.
La courbe d'offre est égal à la courbe de coût marginal.
À l'équilibre en CPP, l'offre est égale à la demande.
On obtient (ici $q^*$ et $p^*$ sont différents des parties précédentes) :
\[C_m(q^*)=P(q^*)=p^*\]
Soit : 
\[8q^*+10=250-2q^*\]
En résolvant l'équation, on obtient $q^*_{CPP}=80/3$ et on peut en déduire $p^*_{CPP}=670/3$.
On peut maintenant calculer le profit de la même manière que dans la question précédente, et on obtient $\pi^{CPP}(q^*_{CPP})=22000/9<\pi^M$.
Le profit du producteur en concurrence pure et parfaite est inférieur au profit en monpole.
La quantité produite est supérieure et le prix du bien échangé inférieur.


```{r monoexo31, fig.cap="Représentation graphique"}
P <- function(q){250-q}
Rm <- function(q){250-2*q}
Cm <- function(q){8*q+10}
qm <- 24
pm <- P(qm)
qcpp <- 80/3
pcpp <- P(qcpp)

p_exo3 <- ggplot() +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 260), breaks=c(10,pcpp, Rm(qm), pm,250), labels=c(10, TeX("$p^*_{CPP}$"), TeX("$R_m(q_m)$"), TeX("$p^*_m$"), 250)) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 260), breaks=c(qm, qcpp,125, 250), labels=c(TeX("$q^*_m$"), TeX("$q^*_{CPP}$"), 125, 250)) +
  labs(x="quantité", y="prix") +
  geom_function(fun=P, color="darkgreen") +
  geom_function(fun=Rm, color="blue") +
  geom_function(fun=Cm, color="red") +
  annotate("text", x=200, y=P(200), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=120, y=Rm(100), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=20, y=Cm(10), label=TeX("$C_m$"), color="red")

p_exo3
```

3. Pour calculer les surplus en monopole, commençons par la représentation graphique (figure \@ref(fig:monoexo32)).

```{r monoexo32, fig.cap="Avec les surplus en monopole."}
Sc <- data.frame(x=c(0, qm), ymin=c(P(qm), P(qm)), ymax=c(P(0), P(qm)))
Sp <- data.frame(x=c(0, qm), ymin=c(Cm(0), Cm(qm)), ymax=c(P(qm), P(qm)))
perte <- data.frame(x=c(qm, qcpp), ymin=c(Cm(qm), Cm(qcpp)), ymax=c(P(qm), P(qcpp)))

p_exo3 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=qm/2, y=pm+10, label="Sc", color="darkgreen") +
  annotate("text", x=qm/2, y=pm-50, label="Sp", color="red") +
  geom_ribbon(data=perte, aes(x=x, ymin=ymin, ymax=ymax), fill="black", alpha=0.5) +
  annotate("text", x=qm/2+qcpp/2, y=pcpp-5, label="Perte sèche", color="black")
  
```

Le surplus des consommateurs se calcule en calculant l'aire du triangle vert dans la figure \@ref(fig:monoexo32).
On obtient :
\[S_c=\frac{(250-226)(24-0)}{2}=288\]
Le surplus du producteur s'obtient en calculant l'aire du trapèze rouge, ou bien en ajoutant le coût fixe (400 ici) au profit calculé à la question 1 :
\[S_p=\pi^M+CF=2480+400=2880\]
Le surplus total est la somme des surplus des consommateurs et du producteur, soit $S_t^M=3168$.


Pour calculer les surplus en concurrence pure et parfaite, on commence par la représentation graphique (figure \@ref(fig:monoexo33)).

```{r monoexo33, fig.cap="Avec les surplus en CPP."}
Sc <- data.frame(x=c(0, qcpp), ymin=c(P(qcpp), P(qcpp)), ymax=c(P(0), P(qcpp)))
Sp <- data.frame(x=c(0, qcpp), ymin=c(Cm(0), Cm(qcpp)), ymax=c(P(qcpp), P(qcpp)))

p_exo3 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=qcpp/2, y=pcpp+10, label="Sc", color="darkgreen") +
  annotate("text", x=qcpp/2, y=pcpp-50, label="Sp", color="red") 
```

On calcule l'aire du triangle vert pour obtenir le surplus total des consommateurs.
Il vaut 3200/9, ce qui est supérieur au surplus obtenu en monopole.  
On calcule l'aire du triangle rouge pour obtenir le surplus total du producteur, ou bien on ajoute le coût fixe (400 ici) au profit calculé à la question 2. 
Il vaut ici 25600/9.
Il est donc plus faible qu'en monopole.  
Le surplus total en CPP vaudrait donc 3200, ce qui est supérieur au surplus total obtenu en monopole.
Le monopole a un impact négatif sur le niveau de bien-être social.
Il introduit une charge morte de 32.

4. À l'optimum, le monopole égalise recette marginale et coût marginal.
Ici le coût marginal est nul, la recette marginale doit donc être nulle.
On obtient donc l'équation :
\[
0=R_m(q^*)=250-2q^*
\]
On en déduit donc que $q^*=125$.
On peut alors calculer $p^*=P(q^*)=125$.
Quand le coût marginal du monopole est nul, il produit 125 unités de bien, vendues au prix 125.

:::
 

<!--chapter:end:04-exercices.Rmd-->

`r if (knitr::is_html_output()) '
# Bibliographie {-}
'`

<!--chapter:end:07-references.Rmd-->

