# Rappels : Le marché en concurrence pure et parfaite
\chaptermark{Le marché en CPP}

```{r setupcpp, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

## Les hypothèses de la concurrence pure et parfaite (CPP)
\chaptermark{Les hypothèses de la CPP}


```{r theme}
theme_perso <- function(base_size = 14) {
    theme_bw(base_size = base_size) %+replace%
        theme(
      # L'ensemble de la figure
      plot.title = element_text(size = rel(1), face = "bold", margin = margin(0,0,5,0), hjust = 0),
      # Zone où se situe le graphique
      panel.grid.minor = element_blank(),
      panel.border = element_blank(),
      # Les axes
      axis.title = element_text(size = rel(0.85), face = "bold"),
      axis.text = element_text(size = rel(0.70), face = "bold"),
      axis.line = element_line(color = "black", arrow = arrow(length = unit(0.3, "lines"), type = "closed")),
      # La légende
      legend.title = element_text(size = rel(0.85), face = "bold"),
      legend.text = element_text(size = rel(0.70), face = "bold"),
      legend.key = element_rect(fill = "transparent", colour = NA),
      legend.key.size = unit(1.5, "lines"),
      legend.background = element_rect(fill = "transparent", colour = NA),
      # Les étiquettes dans le cas d'un facetting
      strip.background = element_rect(fill = "#17252D", color = "#17252D"),
      strip.text = element_text(size = rel(0.85), face = "bold", color = "white", margin = margin(5,0,5,0))
    )
}

theme_set(theme_perso())
```

Il y a 5 hypothèses qui définissent la concurrence pure et parfaite :

1. Atomicité des agents ;
2. Information parfaite ;
3. Mobilité parfaite des facteurs de production ;
4. Homogénéité des biens ;
5. Libre entrée et sortie du marché.

:::{.hypothesis name="Atomicité des agents"}
L'hypothèse d'atomicité des agents implique que personne n'a d'influence *individuellement* sur les prix.
En d'autres termes, chaque acteur est petit face au marché et considère le prix du marché comme une *donnée* qu'il ne peut pas influencer.
On dit que les agents sont *price-taker* sur le marché.
:::

:::{.hypothesis name="Information parfaite"}
L'hypothèse d'information parfaite signifie que tous les acteurs disposent de toutes les informations pertinentes pour prendre leurs décisions.
Il n'y a, par exemple, pas de coût de recherche d'information.
:::

:::{.hypothesis name="Mobilité parfaite des facteurs de production"}
L'hypothèse de mobilité parfaite des facteurs de production garantit l’homogénéité spatiale du prix des facteurs.
Les facteurs de production se déplacent où ils sont le mieux rémunérés.
Les différences de coûts entre producteurs ne peuvent donc être dus qu'au différence technologique entre ceux-ci, et non à une différence de coût des facteurs de production.
:::

:::{.hypothesis name="Homogénéïté des biens"}
Inhomogénéité des biens signifie que tous les biens vendu sur un marché sont parfaitement substituables.
Sur un marché donné, tous les biens ont la même qualité.
Le consommateur est donc indifférent entre tous les biens vendus.
Il n'y aussi pas d'effet des marques.
:::

:::{.hypothesis name="Libre entrée et sortie du marché"}
L'hypothèse de libre entrée et sortie du marché signifie qu'il n'y pas de barrière à l'entrée dans le marché.
Concrètement, cela implique qu'il est impossible de faire du bénéfice sur la dernière unité vendue en concurrence pure et parfaite, sinon un concurrent pourrait entrer sur le marché et faire des bénéfices.
:::

La violation d'une de ces hypothèses nous fait sortir du cadre de la CPP et confère un *pouvoir de marché* aux producteurs en place.

## Le producteur

### Fonctions de coût

En général, un producteur est caractérisé par une fonction de production, c'est-à-dire une fonction qui donne  les quantités produites de biens en fonction des facteurs de productions.
À l'aide de cette fonction de production, il est possible de construire une fonction de coût.

:::{.definition name="Fonction de coût total"}
La fonction de coût total, notée $C$ ou $CT$ donne le coût total de production de $q$ unités de bien.
Elle peut se décomposer en un *coût fixe* $CF$ (qui ne dépend pas de $q$) et un *coût variable* $CV$ qui dépend de $q$ :
\[CT(q)=CF+ CV(q)\]
:::

:::{.definition name="Coût moyen"}
Le coût moyen est le coût de production moyen d'une unité, noté $C_M$ :
\[C_M(q) = \frac{CT(q)}{q}\]
:::
On peut décomposer le coût moyen en un *coût fixe moyen* $CFM$ :
\[CFM(q)=\frac{CF}{q}\]
Et un *coût variable moyen* $CVM$ :
\[CVM(q)=\frac{CV(q)}{q}\]
On a alors :
\begin{equation}
C_M(q)=CFM(q) +CVM(q)
(\#eq:CM)
\end{equation}

::: {.proof}
\[
\begin{array}{rcl}
C_M(q) &=& \frac{CT(q)}{q}\\
 &=& \frac{CF + CV(q)}{q}\\
 &=& \frac{CF}{q}+\frac{CV(q)}{q}\\
 &=& CFM(q) + CVM(q)
\end{array}
\]
:::

::: {.definition name="Coût marginal"}
Le coût marginal, noté $C_m$, est l'augmentation du coût lié à la production d'une unité supplémentaire :
\[C_m(q)=\lim_{\Delta q\to 0}\frac{CT(q+\Delta q)-CT(q)}{\Delta q}=CT'(q)\]
:::
Autrement dit, le coût marginal est la variation de coût total quand la production varie "un tout petit peu" (infiniment peu en fait).

::: {.proposition name="Forme de courbes de coût"}
Le coût marginal diminue d'abord, puis augmente par la suite, car la productivité marginale est d'abord croissante, puis décroissante, en général.  
Le coût variable moyen est d'abord décroissant, puis croissant, pour la même raison.  
Le coût fixe moyen est toujours décroissant, car le coût fixe ne dépend pas des quantités produites et $CFM=CF/q$ est donc une fonction inverse.  
La décomposition donnée par l'équation \@ref(eq:CM) implique que le coût moyen est d'abord décroissant, puis croissant.
:::

::: {.proposition name="Relation entre les coûts"}
Lorsque le coût marginal est inférieur au coût (variable) moyen ($C_m(q)<C_M(q)$), le coût moyen diminue.
Lorsque le coût marginal est supérieur au coût (variable) moyen ($C_m(q)>C_M(q)$), le coût moyen augmente.
La courbe de coût marginal coupe donc la courbe de coût (variable) moyen à son minimum.
:::
L'intuition de ce résultat est simple : si le coût marginal d'une unité supplémentaire est supérieur au coût moyen, alors l'unité supplémentaire produite sera plus chère que la moyenne du coût des unités précédentes produites, augmentant de ce fait le coût moyen.

:::{ .proof }
En son minimum, le coût moyen est tel que $C_M'(q)=0$.
\[
\begin{array}{crcl}
&C_M'(q)&=&0\\
\Leftrightarrow & \left(\frac{CT(q)}{q}\right)'&=& 0\\
\Leftrightarrow & \frac{CT'(q)q-CT(q)}{q^2}&=& 0\\
\Leftrightarrow & \frac{C_m(q)}{q}-\frac{CT(q)}{q^2}&=& 0\\
\Leftrightarrow & C_m(q)q-CT(q)&=& 0\\
\Leftrightarrow & C_m(q)&=& \frac{CT(q)}{q}\\
\Leftrightarrow & C_m(q)&=& C_M(q)
\end{array}
\]
CQFD.
:::

```{r cppcout, fig.cap="Exemples de fonctions de coût."}
CV <- function(q){log(1+q)+q^2/4}
CF <- function(q){1}
CT <- function(q){CV(q)+CF(q)}
Cm <- function(q){1/(1+q)+q/2}
CM <- function(q){CT(q)/q}
CVM <- function(q){CV(q)/q}

p_cppcout <- ggplot() +
  geom_function(fun=Cm, color="blue") +
  geom_function(fun=CM, color="red") +
  geom_function(fun=CVM, color="darkgreen") +
  labs(x="quantité", y="coût") +
  annotate("text", x=4.5, y=1.3, label=TeX("$CVM$"), color="darkgreen") +
  annotate("text", x=4.5, y=2, label=TeX("$C_M$"), color="red") +
  annotate("text", x=4.5, y=2.5, label=TeX("$C_m$"), color="blue")
  
p_cppcout + scale_y_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(), labels=c()) +
  scale_x_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(), labels=c())
```

### L'offre du producteur

::: {.definition name="Recette totale"}
La recette totale, notée $RT$, est le produit de la vente des unités de biens.
Pour $q$ unités de bien vendus, le producteur gagne $RT(q)$, autrement dit, c'est le chiffre d'affaire du producteur (pour ce bien).
:::

::: {.definition name="Recette marginale"}
La recette marginale, notée $R_m$ est la recette rapportée par une unité supplémentaire de bien.
\[R_m(q)=RT'(q)\]
:::

::: {.definition name="Profit"}
Le profit, noté $\pi$ est la différence entre la recette totale est le coût total de production :
\[\pi(q)=RT(q)-CT(q)\]
:::

Le producteur choisit la quantité produite de manière à maximiser son profit.

::: {.definition name="Programme du producteur"}
Le programme du producteur est :
\[\max_q\pi(q)=\max_q RT(q)-CT(q)\]
:::

::: {.theorem name="Offre du producteur"}
En concurrence pure et parfaite, le programme du producteur est tel que la quantité produite $q$ égalise coût marginal et recette marginale.
À l'optimum :
\begin{equation}
R_m(q) =C_m(q)
(\#eq:cppopti)
\end{equation}
:::

::: {.proof}
Le programme du producteur est de maximiser son profit :
\[\max_q\pi(q)=\max_q RT(q)-CT(q)\]
À l'optimum, et à condition que les fonctions de coût et de recette soient dérivables (ce qui sera toujours le cas ici), cela signifie que l'on doit avoir la condition du premier ordre :
\[\pi'(q)=0\Leftrightarrow RT'(q)-CT'(q)=0\Leftrightarrow R_m(q)=C_m(q)\]
On obtient donc bien l'équation \@ref(eq:cppopti)
:::

L'intuition pour ce résultat est assez simple.
Si on a $R_m(q)>C_m(q)$, alors augmenter la quantité produite rapporte plus que cela ne coûte, et donc augmente le profit.
À l'inverse, si $R_m(q)<C_m(q)$, diminuer la quantité produite diminue plus le coût que la recette du producteur, et donc augmente le profit. 
La situation s'équilibre donc pour $R_m(q)=C_m(q)$.
Si cette égalité n'est pas vérifiée, le producteur peut en effet augmenter son profit en jouant sur la quantité produite.

En concurrence pure et parfaite, le producteur est *price-taker*.
Le prix sur le marché est unique et donné , il vaut $p$ et ne dépend pas des quantités produites par *un* producteur.
Le producteur vend son bien au prix défini par le marché.
La recette totale devient donc $RT(q)=p\times q$, avec $p$ fixé.
La recette marginale est donc $R_m(q)=RT'(q)=p$.
En réécrivant l'équation \@ref(eq:cppopti), on obtient en concurrence pure et parfaite :
\[p=C_m(q)\]

::: {.proposition name="Courbe d'offre en CPP"}
En concurrence pure et parfaite, la courbe d'offre du producteur est la courbe de coût marginal.
\[p=C_m(q)\]
:::

Le profit du producteur s'écrit alors :
\[\pi(q)=RT(q)-CT(q)=pq-CT(q)=pq-C_M(q)q=q(p-C_M(q))\]
Autrement dit, le profit d'un producteur en concurrence pure et parfaite et la différence entre le prix de vente et le coût moyen de production multiplié par le nombre d'unités vendues.
Si ce prix est inférieur au coût moyen de toutes les unités vendues, le profit sera négatif.

```{r cppprofit, fig.cap="Profit d'un producteur en concurrence pure et parfaite."}
q <- 4
pi <- data.frame(x=c(0, q), ymin=c(CM(q), CM(q)), ymax=c(Cm(q), Cm(q)))

p_cppcout + geom_ribbon(data=pi, aes(x=x, ymin=ymin, ymax=ymax), fill="green", alpha=0.5) +
  annotate("text", x=2, y=2, label=TeX("$\\pi$"), color="darkgreen") +
  geom_segment(data=pi, x=q, y=0, xend=q, yend=Cm(q), linetype="dashed") +
  geom_segment(data=pi, x=0, y=CM(q), xend=q, yend=CM(q), linetype="dashed") +
  geom_segment(data=pi, x=0, y=Cm(q), xend=q, yend=Cm(q), linetype="dashed") +
  scale_y_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(CM(q), Cm(q)), labels=c(TeX("$C_M(q^*)$"), TeX("p"))) +
  scale_x_continuous(expand=c(0, 0), limits=c(0, 5), breaks=c(q), labels=c(TeX("$q^*$")))

```

## L'équilibre de marché

:::{.definition name="Demande agrégée (D)"}
La *demande agrégée (D)* est la somme des demandes individuelles pour chaque niveau de prix.
:::

:::{.definition name="Offre agrégée (S)"}
L'*offre agrégée (S)* est la somme des offres individuelles pour chaque niveau de prix.
:::

L'équilibre de marché se fait à l'intersection entre S et D (quand S=D).


```{r marche, fig.cap="Equilibre de marché."}

x=seq(0, 1, length=11)
df <- data.frame(x)

S <- function(q){q}
D <- function(q){1-q}


p <- ggplot(df, aes(x=x)) +
    stat_function(fun=function(x) D(x), colour = "blue") +
    stat_function(fun=function(x) S(x), colour = "red") +
    scale_y_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("p*"), limits = c(0, 1.2)) +
    scale_x_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("q*"), limits = c(0, 1.2)) +
    labs(x="quantité", y = "prix") +
    annotate("text", x = 1.1, y = 1, label ="S", colour = "red") +
    annotate("text", x = 0.1, y = 1, label ="D", colour = "blue") +
    geom_segment(x = 0.5, y = 0, xend = 0.5, yend = 0.5, linetype="dashed") +
    geom_segment(x = 0, y = 0.5, xend = 0.5, yend = 0.5, linetype = "dashed")


p
```


La courbe de demande correspond à la suite des prix de réserve des individus, c'est-à-dire aux prix maximal que chaque individu est prêt à payer pour obtenir une unité *supplémentaire* du bien.

La courbe d'offre correspond à la série des coûts marginaux de production, c'est-à-dire les prix minimaux auxquels les producteurs souhaitent vendre une unité supplémentaire du bien.

La vente de toutes les unités jusqu'à la quantité d'équilibre $q^*$ au prix $p^*$ procure un *surplus* aux agents économiques.

:::{.definition name="Surplus des consommateurs"}
Le surplus des consommateurs est la somme des différences entre le prix de réserve des consommateurs et le prix payé par le consommateur pour obtenir les biens.
Sur le graphique quantité prix $(q, p)$, c'est l'aire compris entre la courbe de demande est la droite horizontale dont l'ordonnée est le prix d'échange.
Formellement :
\[S_c=\int_0^{q^*}P(q)-p^* dq\]
:::

::: {.remark}
Seule la dernière unité de bien achetée par les consommateur l'est au prix de réserve.
Il n'y a pas de gain à l'échange pour cette unité, mais pour toutes les autres, il y en a, ce qui explique pourquoi il y a un surplus à l'échange, et pourquoi celui-ci à lieu.
:::

:::{.definition name="Surplus des producteurs"}
Le surplus des producteurs est la somme des différences entre le prix auquel les producteurs vendent le bien et la courbe de coût marginal, qui représente le coût d'une unité supplémentaire produite.
Sur le graphique quantité prix $(q, p)$, c'est l'aire compris entre le prix de vente et la courbe de coût marginal.
Formellement :
\[S_p=\int_0^{q^*}p^*-S(q) dq\]
:::

En pratique, on utilisera jamais la formule avec des intégrales, mais on calculera l'aire du triangle (ou trapèze) concerné.

```{r surplus, fig.cap="Surplus des consommateurs et des producteurs."}

Sc = data.frame(x = c(0, 0.5), y = c(1, 0.5))
Sp = data.frame(x = c(0, 0.5), y = c(0, 0.5))

p + geom_ribbon(data = Sc, aes(x=x, ymin=0.5, ymax = y), fill="blue") +
    geom_ribbon(data = Sp, aes(x=x, ymin=y, ymax = 0.5), fill="red")
```

:::{ .proposition #cppprop name="Propriétés de l'équilibre en concurrence pure et parfaite"}
L'équilibre en CPP **maximise** le *surplus total*.
Tout autre couple prix/quantité abouti à un surplus total plus faible.  
L'équilibre de CPP est *Pareto-optimal*, i.e., il est impossible d'améliorer la situation d'un agent sans détériorer celle d'un autre.
C'est ce qu'on appelle le *premier théorème du bien-être*.
:::

Ces propriétés font de la CPP une "référence" par rapport à laquelle on peut comparer les résultats des autres structures de marché.

## Perception par les agents isolés

L'hypothèse d'atomicité indique que les agents individuels sont isolés au sein d'un très grand nombre d'autres agents.
Ainsi, aucun agent n'a d'influence sur le prix s'il modifie son comportement.
Une conséquence directe est que le comportement des autres agents est perçu comme étant infiniment élastique.
C'est-à-dire qu'un producteur sait qu'au prix de marché, il pourra vendre toute sa production, mais que s'il pratique un prix même légèrement plus élevé, il ne vendra **rien**.
Il perçoit ainsi une demande infiniment élastique au prix,  au niveau du prix $p^*$.


```{r elasticite, fig.align='center', fig.cap="Perception de la demande globale par un producteur isolé."}

x=seq(0, 1, length=11)
df <- data.frame(x)

S <- function(q){q}
D <- function(q){1-q}


p <- ggplot(df, aes(x=x)) +
    stat_function(fun=function(x) S(x), colour = "red") +
    geom_hline(yintercept = 0.5, colour = "blue") +
    scale_y_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("p*"), limits = c(0, 1.2)) +
    scale_x_continuous(expand = c(0, 0), breaks = c(0.5), labels = c("q*"), limits = c(0, 1.2)) +
    labs(x="quantité", y = "prix") +
    annotate("text", x = 0.9, y = 1, label ="offre individuelle", colour ="red") +
    annotate("text", x = 0.8, y = 0.55, label ="demande perçue", colour ="blue") +
    geom_segment(x = 0.5, y = 0, xend = 0.5, yend = 0.5, linetype="dashed") +
    geom_segment(x = 0, y = 0.5, xend = 0.5, yend = 0.5, linetype = "dashed")


p
```

Dans ce graphique, $q^*$ représente la production optimale de ce producteur quand il est seul.
