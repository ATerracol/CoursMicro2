# Exercices

```{r exercisebase, include=F}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```


## Concurrence pure et parfaite

:::{ .exercise #cppexo1}

On considère un consommateur dont la fonction de demande optimale pour un bien est donnée par :
\[
Q(p)=10-p
\]
où $p$ est le prix du bien.


1. Donnez la fonction de demande inverse correspondante. Représentez la graphiquement.
2. Quel est le prix maximum que le consommateur est prêt à payer pour la première unité de bien ? Et pour la cinquième ?
3. Calculez le surplus du consommateur lorsque le prix est de $p=2$. Interprétez la valeur obtenue. 
:::

:::{.solution name="Exercice \@ref(exr:cppexo1)"}
La fonction de demande inverse est la fonction inverse de la fonction de demande.
Autrement dit, elle exprime le prix $P$ en fonction de la quantité $q$ plutôt que la quantité $Q$ en fonction du prix $p$.
Ici on $q=10-p$, ce qui équivaut à $p=10-q$.
La fonction de demande inverse est donc $P(q)=10-q$.
Graphiquement, on obtient :

```{r cppexo11, fig.cap="Représentation graphique de la demande inverse."}
P <- function(q){10-q}

p <- ggplot() +
  geom_function(fun=P, color="blue") +
  labs(x="quantité", y = "prix") +
  annotate("text", x= 6, y=6, label="Demande inverse", color="blue")

p + scale_x_continuous(expand = c(0, 0), limits=c(0, 12), breaks=c(10), labels=c(10)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 12), breaks=c(10), labels=c(10))

```

2. Pour la première unité de bien, on utilise la fonction de demande inverse.
Le prix que le consommateur est prêt à payer pour la première unité est $P(q=1)=9$.
Pour la cinquième unité, c'est $P(q=5)=5$.
Dans les deux cas, ce sont le prix maximal que les consommateurs sont prêts à payer pour l'unité supplémentaire du bien.
Rappelez-vous que la courbe de demande inverse représente l'ensemble des prix maximaux que les consommateurs sont prêts à payer pour une unité supplémentaire du bien.

3. Le surplus du consommateur est la somme des différences entre le prix maximal que chaque individu est prêt à payer et le prix auquel il paie effectivement le bien.
Mathématiquement, le surplus du consommateur s'exprime toujours ainsi :
\[
S_c=\int_0^{q^*}P(q)-p^*dq
\]
Où $p^*$ et $q^*$ représente le prix sur le marché, et $q^*$ la quantité échangée.


```{r cppexo13, fig.cap="Représentation graphique du surplus du consommateur."}
Sc=data.frame(x=c(0, 8), ymin=c(2, 2), ymax=c(10, 2))

p + geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 12), breaks=c(8, 10), labels=c(TeX("$q^*=8$"), 10)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 12), breaks=c(2, 10), labels=c(TeX("$p^*=2$"), 10)) +
  geom_segment(data=Sc, aes(x=x), x=0, y=2, xend=8, yend=2, linetype="dashed") +
  annotate("text", x=2, y=5, label="Surplus du consommateur", color="blue") +
  geom_segment(data=Sc, aes(x=x), x=8, y=0, xend=8, yend=2, linetype="dashed")
```

En général, comme on peut le voir sur la figure \@ref(fig:cppexo13), il est possible de calculer le surplus en utiliser la formule donnant l'aire d'un triangle.
Ici, on obtient :
\[S_c=\frac{1}{2}(10-2)\cdot(8-0)=32\]
Les consommateurs "gagnent" donc 32 par rapport à la situation où ils devraient payer chacun leur prix de réserve.
:::


:::{ .exercise #cppexo2}
On considère une firme faisant face à la contrainte technologique donnée par la fonction de coût total :
\[C(q)=q^2+10q\]

1. Donnez la fonction de coût marginal correspondant.
2. Déterminez la fonction d'offre de cette firme. Représentez la graphiquement.
3. On suppose que la fonction de demande inverse du marché est donnée par :
\[P(q)=100-q\]
Déterminez le prix d'équilibre sur le marché, le surplus du producteur, le surplus du consommateur ainsi que le surplus total.
4. Supposons que l'État impose un prix $p=80$. Quelle va être la quantité échangée ? Quel sera le surplus total ? Et si l'état impose un prix $p=20$ ? Représentez graphiquement ces deux situations. En déduire que l'équilibre concurrentiel maximise le surplus total.
:::

:::{.solution name="Exercice \@ref(exr:cppexo2)"}
La fonction de coût marginal est la dérivée de la fonction de coût total.
La fonction de coût marginal donne le coût de production d'une unité de bien supplémentaire.
\[C_m(q)=C'(q)=2q+10\]

2. La fonction d'offre des producteurs en concurrence pure et parfaite est égale à la fonction de coût marginal.
Si on la note $S$, $S(q)=C_m(q) = 2q+10$.
C'est le prix minimal auquel elle est prête à vendre une unité de bien supplémentaire.

```{r cppexo22, fig.cap="Représentation graphique de la fonction d'offre."}
S <- function(q){10+2*q}

p <- ggplot() +
  geom_function(fun=S, color="red") +
  labs(x="quantité", y = "prix") +
  annotate("text", x=50, y=75, label="Offre", color="red")

p + scale_x_continuous(expand = c(0, 0), limits=c(0, 100)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 100))

```

3. A l'équilibre sur le marché, une quantité $q^*$ de biens est échangée au prix $p^*$.
Le marché vérifie alors les équations suivantes :
\begin{equation}
p^*=S(q^*)=P(q^*)
(\#eq:cppequilibre)
\end{equation}
Commençons par la deuxième partie de l'équation \@ref(eq:cppequilibre) :
\[
\begin{array}{crcl}
&2q^*+10&=&100-q^*\\
\Leftrightarrow&3q^*&=&90\\
\Leftrightarrow & q^*&=&30
\end{array}
\]
La quantité échangée à l'équilibre est donc de $q^*=30$.
A l'aide de la quantité échangée est de la première partie de l'équation \@ref(eq:cppequilibre), on obtient
\[
p^*=P(q^*=30) = 100-30=70 
\]
Sur le marché, 30 unités de bien sont donc échangés au prix de 70.
On peut alors représenter les surplus sur le marché, comme dans la figure \@ref(fig:cppexo23).
Le surplus des consommateurs est l'aire du triangle bleu, il vaut 
\[S_c=\frac{1}{2}(100-70)\times(30-0)=450\]
Le surplus des producteurs est l'aire du triangle rouge :
\[
S_p=\frac{1}{2}(70-10)\times(30-0) = 900
\]

```{r cppexo23, fig.cap="Surplus en CPP."}
P <- function(q){100 - q}
Sc <- data.frame(x=c(0, 30), ymin=c(70, 70), ymax=c(100, 70))
Sp <- data.frame(x=c(0, 30), ymin=c(10, 70), ymax=c(70, 70))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 30, 100), labels=c(0, TeX("$q^*=30$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 70, 100), labels=c(10, TeX("$p^*=70$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=20, y=80, label="Surplus du consommateur", color="blue") +
  annotate("text", x=20, y=50, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=30, y=70, yend=70, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=30, xend=30, y=0, yend=70, linetype="dashed") 
```

Le surplus total est la somme des surplus des producteurs et des consommateurs :
\[
S_t^{CPP}=S_c+S_p=1350
\]

4. On regarde maintenant le cas l'état impose un prix $p^E=80$.
La demande globale vaut alors de $Q(p^E)=100-p^E=20$, que l'on l'obtient en inversant la demande inverse, autrement dit en trouvant la quantité $q$ telle que $P(q)=p^E=80$.
L'offre globale vaut $S(p^E)=\frac{p^E-10}{2}=35$, que l'on obtient en inversant la fonction d'offre, autrement dit en trouvant la quantité $q$ telle que $S(q)=p^E=80$.
La demande globale est plus faible que l'offre globale, c'est donc la demande globale qui fixera les quantités échangées. 
La quantité échangée vaut donc 20.
Graphiquement, on obtient la figure \@ref(fig:cppexo24prixhaut).

```{r cppexo24prixhaut, fig.cap="Surplus en quand l'Etat impose un prix $p^E=80$."}
Sc <- data.frame(x=c(0, 20), ymin=c(80, 80), ymax=c(100, 80))
Sp <- data.frame(x=c(0, 20), ymin=c(10, 50), ymax=c(80, 80))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 20, 100), labels=c(0, TeX("$q^E=20$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 50, 80, 100), labels=c(10, 50, TeX("$p^E=80$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=20, y=90, label="Surplus du consommateur", color="blue") +
  annotate("text", x=20, y=60, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=20, y=80, yend=80, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=20, xend=20, y=0, yend=80, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=20, y=50, yend=50, linetype="dashed")
```
Le surplus total est dans ce cas l'aire du trapèze bleu et rouge.
Il nous faut obtenir le point sur la courbe d'offre pour la quantité $q^E$.
En ce point, le prix est $S(q^E)=50$.
\[
S_t=\frac{1}{2}(100-10+80-50)\times(20-0)=1200 < S_t^{CPP}
\]
Le surplus total est dans ce cas plus faible qu'en CPP.

On s'intéresse finalement au cas où l'état impose un prix $p^E=20$.
La demande globale vaut alors de $Q(p^E)=100-p^E=80$, que l'on l'obtient en inversant la demande inverse, autrement dit en trouvant la quantité $q$ telle que $P(q)=p^E=20$.
L'offre globale vaut $S(p^E)=\frac{p^E-10}{2}=5$, que l'on obtient en inversant la fonction d'offre, autrement dit en trouvant la quantité $q$ telle que $S(q)=p^E=20$.
L'offre globale est plus faible que la demande globale, c'est donc l'offre globale qui fixera les quantités échangées. 
La quantité échangée vaut donc 20.
Graphiquement, on obtient la figure \@ref(fig:cppexo24prixbas).

```{r cppexo24prixbas, fig.cap="Surplus en quand l'Etat impose un prix $p^E=20$."}
Sc <- data.frame(x=c(0, 5), ymin=c(20, 20), ymax=c(100, 95))
Sp <- data.frame(x=c(0, 5), ymin=c(10, 20), ymax=c(20, 20))

p + geom_function(fun=P, color="blue") +
  annotate("text", x=80, y=20, label="Demande globale", color="blue") +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, 5, 100), labels=c(0, TeX("$q^E=5$"), 100)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(10, 20, 95, 100), labels=c(10, 20, TeX("$p^E=95$"), 100)) +
  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="blue", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=15, y=100, label="Surplus du consommateur", color="blue") +
  annotate("text", x=15, y=15, label="Surplus du producteur", color="red") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=5, y=95, yend=95, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=5, xend=5, y=0, yend=95, linetype="dashed") +
  geom_segment(data=Sc, aes(x=x), x=0, xend=5, y=20, yend=20, linetype="dashed")
```
Le surplus total est dans ce cas l'aire du trapèze bleu et rouge.
Il nous faut obtenir le point sur la courbe d'offre pour la quantité $q^E$.
En ce point, le prix est $S(q^E)=20$.
\[
S_t=\frac{1}{2}(100-10+95-20)\times(5-0)=\frac{825}{2}=412.5 < S_t^{CPP}
\]
Le surplus total est dans ce cas aussi plus faible qu'en CPP.

Ces deux situations illustrent les deux cas qui s'écartent de la CPP : un prix plus élevé ou un prix plus faible.
Dans les deux cas, on voit que le surplus total est plus faible.
Ce serait vrai pour n'importe quel prix différent du prix de la concurrence pure et parfaite.
On illustre ainsi le fait que l'équilibre de CPP maximise le surplus total.
:::

## Exercices sur le comportement monopole

::: {.exercise #monoexo1 name="Questions de cours"}
Questions de cours :

1. Quand la demande de bien est inélastique, la recette
marginale est-elle positive ?
2. Un monopole maximise son profit dans la zone où les
quantités demandées sont élastiques au prix. Vrai ou faux ?
3. Dans quel cas un monopole se comportera-t-il comme
s'il était en situation de concurrence pure et parfaite (sans
intervention de l'État) ?
4. Une entreprise a un taux de marge (indice de Lerner) de 45%.
Quelle est l'élasticité de la demande à laquelle
elle fait face ?
:::

::: {.solution name="Solution de l'exercice \@ref(exr:monoexo1)"}
Réponses :

1. Non, cf cours.
2. Vrai, cf cours.
3. Si l'élasticité prix de la demande est infini.
4. On a d'après la définition de l'indice de Lerner \@ref(eq:Lerner) :
\[L=\frac{P(q^*)-C_m(q^*)}{P(q^*)}=\frac{1}{\left|\varepsilon_{p/q}(q^*)\right|}=0.45\]
Donc $\left|\varepsilon_{p/q}(q^*)\right| =1/0.45=20/9$.
:::

::: {.exercise #monoexo2}
On considère une entreprise en monopole sur son marché dont la fonction de coût est :
\[C(q)=\frac{1}{20} q^2+15q+500\] 
et qui fait face à la fonction de demande inverse : \[P(q)=45-0,2q\]

1. Déterminer le prix $p_m^*$ et la quantité $q_m^*$ d'équilibre du monopole.
2. Les représenter graphiquement.
3. Calculer l'élasticité prix de la demande au point d'équilibre. Interpréter le résultat.
4. Calculer le surplus des consommateurs et le profit du monopole.
5. Déterminer le prix et la quantité correspondant à l'optimum de Pareto (concurrence pure et parfaite). Montrer que dans cette situation le surplus des consommateurs et le surplus social sont plus élevés, et que le profit du producteur est plus faible.
6. Calculer la charge morte du monopole.
:::

::: {.solution name="Solution de l'exercice \@ref(exr:monoexo2)"}
Réponses.

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=\frac{1}{10}q+15\]
Et :
\[R(q) =qP(q)=45q-\frac{1}{5}q^2\]
Donc :
\[R_m(q)=45-\frac{2}{5}q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&45-\frac{2}{5}q^*&=&\frac{1}{10}q^*+15\\
\Leftrightarrow & 30&=&\frac{1}{2}q^*\\
\Leftrightarrow & q^*&=&60
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-\frac{2}{5}\]
\[C'_m(q)=\frac{1}{10}>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Finalement, le prix est $p^*=P(q^*)=33$.

```{r monoexo21, fig.cap="Représentation graphique"}
P <- function(q){45-0.2*q}
Rm <- function(q){45-0.4*q}
Cm <- function(q){0.1*q+15}
q1 <- 60
q2 <- 100

p_exo2 <- ggplot() +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 50), breaks=c(15, Cm(q1), Cm(q2), P(q1), 45), labels=c(15, 21,TeX("p^*_{CPP}=25"), TeX("p^*_m=33"), 45)) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 250), breaks=c(q1, q2), labels=c(TeX("$q^*_m=60"), TeX("$q^*_{CPP}=100"))) +
  labs(x="quantité", y="prix") +
  geom_function(fun=P, color="darkgreen") +
  geom_function(fun=Rm, color="blue") +
  geom_function(fun=Cm, color="red") +
  annotate("text", x=200, y=P(200), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=120, y=Rm(100), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=200, y=Cm(200), label=TeX("Coût marginal ($C_m$)"), color="red")

p_exo2
```

3. On a l'élasticité prix de la demande à l'équilibre :
\[\varepsilon_{q/p}(q^*)=\frac{p^*}{q^*}\frac{1}{P'(q^*)}=\frac{33}{60}\frac{1}{-0.2}=-\frac{11}{4}\]
La valeur absolue est bien plus grande que 1, nous sommes bien dans la zone où la demande est élastique.
On peut aussi la calculer à l'aide de :
\[\frac{p^*-C_m(q^*)}{p^*}=\frac{33-6-15}{33}=\frac{4}{11}=\frac{1}{|\varepsilon_{q/p}(q^*)|}\]
On calcule ainsi le pouvoir du monopole : sa capacité à imposer au consommateur un prix à l'équilibre supérieur à son coût marginal.

4. Commençons par la représentation graphique.

```{r monoexo22, fig.cap="Avec les surplus en monopole."}
Sc <- data.frame(x=c(0, q1), ymin=c(P(q1), P(q1)), ymax=c(P(0), P(q1)))
Sp <- data.frame(x=c(0, q1), ymin=c(Cm(0), Cm(q1)), ymax=c(P(q1), P(q1)))
perte <- data.frame(x=c(q1, q2), ymin=c(Cm(q1), Cm(q2)), ymax=c(P(q1), P(q2)))

p_exo2 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=q1/2, y=35, label="Sc", color="darkgreen") +
  annotate("text", x=q1/2, y=25, label="Sp", color="red") +
  geom_ribbon(data=perte, aes(x=x, ymin=ymin, ymax=ymax), fill="black", alpha=0.5) +
  annotate("text", x=q1/2+q2/2, y=25, label="Perte sèche", color="black")
  
```

Le surplus des consommateurs se calcule en calculant l'aire du triangle vert dans la figure \@ref(fig:monoexo22).
On obtient :
\[S_c=\frac{(45-33)(60-0)}{2}=360\]
Le surplus du producteur s'obtient en calculant l'aire du trapèze rouge :
\[S_p=\frac{(33-15+33-21)(60-0)}{2}=900\]
Le profit du producteur est le surplus diminué du coût fixe, qui vaut ici 500. Le profit vaut  donc 400.
Le surplus total est la somme des surplus des consommateurs et du producteur, soit $S_T=1260$.

5. En CPP, le prix est fixé par le marché et le prix est égal au coût marginal.
On a (ici $q^*$ et $p^*$ sont différents des parties précédentes) :
\[C_m(q^*)=P(q^*)=p^*\]
Soit : 
\[\frac{1}{10}q^*+15=45-\frac{1}{5}q^*\]
En résolvant l'équation, on obtient $q^*=100$ et on peut en déduire $p^*=25$.
Pour calculer les surplus, on commence par la représentation graphique.

```{r monoexo23, fig.cap="Avec les surplus en CPP."}
Sc <- data.frame(x=c(0, q2), ymin=c(P(q2), P(q2)), ymax=c(P(0), P(q2)))
Sp <- data.frame(x=c(0, q2), ymin=c(Cm(0), Cm(q2)), ymax=c(P(q2), P(q2)))

p_exo2 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=q1/2, y=35, label="Sc", color="darkgreen") +
  annotate("text", x=q1/2, y=20, label="Sp", color="red") 
```

On calcule l'aire du triangle vert pour obtenir le surplus total des consommateurs.
Il vaut 1000, ce qui est supérieur au surplus obtenu en monopole.

On calcule l'aire du triangle rouge pour obtenir le surplus total du producteur.
Il vaut 500.
Si maintenant on enlève le coût fixe pour obtenir le profit, on obtient un profit nul.
Il est donc plus faible qu'en monopole.

Le surplus total en CPP vaudrait donc 1500, ce qui est supérieur au surplus total obtenu en monopole.

6. La charge morte du monopole est la différence entre le surplus total en CPP et en monopole, soit $1500-1260=240$.
On peut aussi la calculer en utilisant l'aire du triangle noir sur la figure \@ref(fig:monoexo22).
:::

::: { .exercise #monoexo3}
Sur un marché dominé par un producteur unique, la fonction de demande inverse pour une quantité $q$ de bien est :
\[P(q)=250-q\] 
La fonction de coût total du monopole est :
\[C(q)=4q^2+10q+400\]


1. Quelle est la production d'équilibre du monopole ? Quel est le
prix de vente ainsi que le profit du producteur ?
2. Comparez la solution précédente avec l'équilibre qui serait
réalisé si l'entreprise se comportait comme en situation de
concurrence pure et parfaite.
3. Dans chacun des cas ci-dessus, calculez le surplus du
producteur, du consommateur, ainsi que le surplus total. Concluez
sur l'impact de la présence d'un monopole sur le niveau de bien-être
social.
4. Supposez que le producteur détienne un stock très important du bien
(son coût marginal de production est nul). Donnez la solution du
monopole dans une telle situation.
:::

::: { .solution name="Solution de l'exercice  \@ref(exr:monoexo3)."}
Réponses:

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=C'(q)=8q+10\]
Et :
\[R(q) =qP(q)=250q-q^2\]
Donc :
\[R_m(q)=R'(q)=250-2q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&250-2q^*&=&8q^*+10\\
\Leftrightarrow & 240&=&10q^*\\
\Leftrightarrow & q^*&=&24
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-2\]
\[C'_m(q)=8>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_M=P(q^*)=226$.
Finalement, on peut calculer le profit :
\[
\pi^M(q^*)=R(q^*)-C(q^*)=p^*q^*-C(q^*)=24\times226-(4\times24^2+10\times24+400)=2480>0
\]
Le profit est bien positif, ce qui est la dernière condition à vérifier pour l'optimum.

A l'optimum, il y a 24 unités de bien échangées sur le marché, au prix de 226.
Cela permet au monopole de faire un profit de 2480.

On représente graphiquement la situation obtenue sur la figure \@ref(fig:monoexo31).



2. En CPP, le prix est fixé par le marché, le producteur le considère comme une donnée dans son optimisation.
La courbe d'offre est égal à la courbe de coût marginal.
À l'équilibre en CPP, l'offre est égale à la demande.
On obtient (ici $q^*$ et $p^*$ sont différents des parties précédentes) :
\[C_m(q^*)=P(q^*)=p^*\]
Soit : 
\[8q^*+10=250-q^*\]
En résolvant l'équation, on obtient $q^*_{CPP}=80/3$ et on peut en déduire $p^*_{CPP}=670/3$.
On peut maintenant calculer le profit de la même manière que dans la question précédente, et on obtient $\pi^{CPP}(q^*_{CPP})=22000/9<\pi^M$.
Le profit du producteur en concurrence pure et parfaite est inférieur au profit en monopole.
La quantité produite est supérieure et le prix du bien échangé inférieur.


```{r monoexo31, fig.cap="Représentation graphique"}
P <- function(q){250-q}
Rm <- function(q){250-2*q}
Cm <- function(q){8*q+10}
qm <- 24
pm <- P(qm)
qcpp <- 80/3
pcpp <- P(qcpp)

p_exo3 <- ggplot() +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 260), breaks=c(10,pcpp, Rm(qm), pm,250), labels=c(10, TeX("$p^*_{CPP}$"), TeX("$R_m(q_m)$"), TeX("$p^*_m$"), 250)) +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 260), breaks=c(qm, qcpp,125, 250), labels=c(TeX("$q^*_m$"), TeX("$q^*_{CPP}$"), 125, 250)) +
  labs(x="quantité", y="prix") +
  geom_function(fun=P, color="darkgreen") +
  geom_function(fun=Rm, color="blue") +
  geom_function(fun=Cm, color="red") +
  annotate("text", x=200, y=P(200), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=120, y=Rm(100), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=20, y=Cm(10), label=TeX("$C_m$"), color="red")

p_exo3
```

3. Pour calculer les surplus en monopole, commençons par la représentation graphique (figure \@ref(fig:monoexo32)).

```{r monoexo32, fig.cap="Avec les surplus en monopole."}
Sc <- data.frame(x=c(0, qm), ymin=c(P(qm), P(qm)), ymax=c(P(0), P(qm)))
Sp <- data.frame(x=c(0, qm), ymin=c(Cm(0), Cm(qm)), ymax=c(P(qm), P(qm)))
perte <- data.frame(x=c(qm, qcpp), ymin=c(Cm(qm), Cm(qcpp)), ymax=c(P(qm), P(qcpp)))

p_exo3 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=qm/2, y=pm+10, label="Sc", color="darkgreen") +
  annotate("text", x=qm/2, y=pm-50, label="Sp", color="red") +
  geom_ribbon(data=perte, aes(x=x, ymin=ymin, ymax=ymax), fill="black", alpha=0.5) +
  annotate("text", x=qm/2+qcpp/2, y=pcpp-5, label="Perte sèche", color="black")
  
```

Le surplus des consommateurs se calcule en calculant l'aire du triangle vert dans la figure \@ref(fig:monoexo32).
On obtient :
\[S_c=\frac{(250-226)(24-0)}{2}=288\]
Le surplus du producteur s'obtient en calculant l'aire du trapèze rouge, ou bien en ajoutant le coût fixe (400 ici) au profit calculé à la question 1 :
\[S_p=\pi^M+CF=2480+400=2880\]
Le surplus total est la somme des surplus des consommateurs et du producteur, soit $S_t^M=3168$.


Pour calculer les surplus en concurrence pure et parfaite, on commence par la représentation graphique (figure \@ref(fig:monoexo33)).

```{r monoexo33, fig.cap="Avec les surplus en CPP."}
Sc <- data.frame(x=c(0, qcpp), ymin=c(P(qcpp), P(qcpp)), ymax=c(P(0), P(qcpp)))
Sp <- data.frame(x=c(0, qcpp), ymin=c(Cm(0), Cm(qcpp)), ymax=c(P(qcpp), P(qcpp)))

p_exo3 +  geom_ribbon(data=Sc, aes(x=x, ymin=ymin, ymax=ymax), fill="darkgreen", alpha=0.5) +
  geom_ribbon(data=Sp, aes(x=x, ymin=ymin, ymax=ymax), fill="red", alpha=0.5) +
  annotate("text", x=qcpp/2, y=pcpp+10, label="Sc", color="darkgreen") +
  annotate("text", x=qcpp/2, y=pcpp-50, label="Sp", color="red") 
```

On calcule l'aire du triangle vert pour obtenir le surplus total des consommateurs.
Il vaut 3200/9, ce qui est supérieur au surplus obtenu en monopole.  
On calcule l'aire du triangle rouge pour obtenir le surplus total du producteur, ou bien on ajoute le coût fixe (400 ici) au profit calculé à la question 2. 
Il vaut ici 25600/9.
Il est donc plus faible qu'en monopole.  
Le surplus total en CPP vaudrait donc 3200, ce qui est supérieur au surplus total obtenu en monopole.
Le monopole a un impact négatif sur le niveau de bien-être social.
Il introduit une charge morte de 32.

4. À l'optimum, le monopole égalise recette marginale et coût marginal.
Ici le coût marginal est nul, la recette marginale doit donc être nulle.
On obtient donc l'équation :
\[
0=R_m(q^*)=250-2q^*
\]
On en déduit donc que $q^*=125$.
On peut alors calculer $p^*=P(q^*)=125$.
Quand le coût marginal du monopole est nul, il produit 125 unités de bien, vendues au prix 125.

:::


## Le monopole naturel

::: { .exercise #naturelexo1 }
On considère une entreprise en monopole sur son marché dont la fonction de coût est : 
$$C(q)=\frac{5}{3}q^3-40q^2+340q$$ 
et qui fait face à la fonction de demande inverse : 
$$P(q)=500-50q$$

1. Calculer les grandeurs d'équilibre du monopole $(p^*_m,q^*_m)$.
2. Calculer le prix et la quantité d'équilibre de la concurrence pure et parfaite $(p^*_{cpp},q^*_{cpp}).$
3. Calculer le profit du monopole dans ces deux situations. Interpréter le résultat.
4. Représenter graphiquement le coût marginal, le coût moyen, la demande et la recette marginale. Représenter la variation du profit du monopole entre ces deux situations.
5. Calculer le prix et la quantité assurant l'équilibre des finances du monopole, $(p_{B},q_{B})$.  Comparer cette situation à l'optimum de Pareto de la concurrence pure et parfaite. Conclure.
:::

::: {.solution name="Solutions de l'exercice \@ref(exr:naturelexo1)"}
Réponses :

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=C'(q)=5q^2-80q+340\]
Et :
\[R(q) =qP(q)=500q-50q^2\]
Donc :
\[R_m(q)=R'(q)=500-100q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&500-100q^*&=&5q^{*2}-80q^*+340\\
\Leftrightarrow & 5q^{*2}+20q^*-160&=&0\\
\Leftrightarrow & q^{*2}+4q^*-32&=&0
\end{array}
\]
On doit donc résoudre une équation du second degré pour obtenir le résultat.
On commence par calculer le discriminant :
\[\Delta=b^2-4ac=4^2-4\times(-32)=16+128=144=12^2\]
On en déduit que :
\[q^8=\frac{-4\pm12}{2}=4\text{ ou } -8\]
La solution $q^*=-8$ est impossible, car les quantités sont forcément positives. 
La seule solution est donc $q^*_m=4$. 
Remarquez qu'il est possible de "voir" sur l'équation du second degré que 4 était une racine et de se passer du calcul du discriminant.
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-100\]
\[C'_m(q)=10q-80\]
En évaluant la dérivée du coût marginal en $q^*$, on a $C_m(q^*)=10\times4-80=-40>R_m(q^*)$
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Nous calculerons le profit à la question 3, nous n'allons donc pas le faire ici.
Le prix est $p^*_m=P(q^*_m)=300$.

2. En CPP, le prix est fixé par le marché, le producteur le considère comme une donnée dans son optimisation.
La courbe d'offre est égal à la courbe de coût marginal.
À l'équilibre en CPP, l'offre est égale à la demande.
On obtient (ici $q^*$ et $p^*$ sont différents de la  partie précédente) :
\[C_m(q^*)=P(q^*)=p^*\]
Soit : 
\[
\begin{array}{crcl}
&500-50q^*&=&5q^{*2}-80q^*+340\\
\Leftrightarrow & 5q^{*2}-30q^*-160&=&0q^*\\
\Leftrightarrow & q^{*2}-6q^*-32&=&0q^*
\end{array}
\]
On doit donc résoudre une équation du second degré pour obtenir le résultat.
On commence par calculer le discriminant :
\[\Delta=(-6)^2+4\times32=36+128=164=4\times41\]
On en déduit que :
\[q^*=\frac{6\pm\sqrt{41}}{2}=3+\sqrt{41}\text{ ou } 3-\sqrt{41}\]
La solution $q^*=3-\sqrt{41}<0$ est impossible, car les quantités sont forcément positives. 
La seule solution est donc $q^*_{CPP}=3+\sqrt{41}\approx$ `r round(3+sqrt(41), digits=2)`. 
On peut en déduire $p^*_{CPP}=50(7-\sqrt{41})\approx$ `r round(50*(7-sqrt(41)), digits=2)`.

3. On calcule maintenant les profits.
En monopole :
\[\pi(p^*_m, q^*_m)=p^*_mq^*_m-C(q^*_m)=4\times300-\frac{5}{3}4^3+40\times4^2-340\times4=\frac{1120}{3}\approx 373,33\]
En concurrence pure et parfaite :
\[\pi(p^*_{CPP}, q^*_{CPP})=p^*_{CPP}q^*_{CPP}-C(q^*_{CPP})\approx-765\]
Le profit des entreprises en concurrence pure et parfaite serait négatif.
Le marché n'existerait donc pas, aucune entreprise ne souhaiterait produire pour faire des pertes.
Cela signifie aussi qu'il ne serait pas possible pour l'État d'imposer au monopole une tarification au coût marginal. 
On est en fait dans une situation de monopole naturel, avec des coûts moyens décroissants.
La tarification peut donc se faire au coût marginal, ce qu'on verra à la question 5.

4. Nous allons maintenant représenter graphiquement cette situation.

```{r naturelexo14, fig.cap="Représentation graphique  des équilibres"}
C <- function(q){5/3*q^3-40*q^2+340*q}
Cm <- function(q){5*q^2-80*q+340}
P <- function(q){500-50*q}
Rm <- function(q){500-100*q}
CM <- function(q){C(q)/q}
qm <- 4
pm <- P(qm)
qcpp <- uniroot(function(q){Cm(q)-P(q)}, c(0,10))$root
pcpp <- P(qcpp)
profitcpp <- data.frame(x=c(0, qcpp), ymin=c(pcpp, pcpp), ymax=c(CM(qcpp), CM(qcpp)))
profitm <- data.frame(x=c(0, qm), ymax=c(pm, pm), ymin=c(CM(qm), CM(qm)))
qb <- -3+sqrt(105)
pb <- 50*(13-sqrt(105))


p_naturel1 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=Rm, color='blue') +
  geom_function(fun=CM, color='darkred') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 12.5), breaks=c(0, qm, qcpp, qb, 12), labels=c(0, TeX("$q_m^*$"), TeX("$q_{CPP}^*$"), TeX("$q_B$"), 12)) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 510), breaks=c(0, pm, pcpp, 500, 340, CM(qcpp), CM(qm), pb), labels=c(0, TeX("$p_m^*$"), TeX("$p_{CPP}^*$"), 500, 340, TeX("$C_M(q_{CPP}^*)$"), TeX("$C_M(q_m^*)$"), TeX("$p_B$"))) +
  labs(x="quantité", y="prix") +
  geom_ribbon(data=profitcpp, aes(x=x, ymin=ymin, ymax=ymax), fill='red', alpha=0.5) +
  geom_ribbon(data=profitm, aes(x=x, ymin=ymin, ymax=ymax), fill='green', alpha=0.5) +
  annotate("text", x=6, y=P(6), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=2, y=Rm(2), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=11, y=Cm(11), label=TeX("$C_m$"), color="red") +
  annotate("text", x=11, y=CM(11), label=TeX("$C_M$"), color="darkred") +
  annotate("text", x=6, y=60, label=TeX("$-\\pi_{CPP}$"), color="red") +
  annotate("text", x=2, y=250, label=TeX("$\\pi_{m}$"), color="darkgreen")
  
  
p_naturel1

```

5. Assurer l'équilibre des finances du monopole signifie faire en sorte qu'il ne fasse ni profits, ni pertes.
Autrement dit, $\pi(p_B, q_B)=0$.
Cela se traduit par :
\[
\begin{array}{crcl}
&p_Bq_B-C(q_B)&=&0 \\
\Leftrightarrow & p_B&=&\frac{C(q_B)}{q_B}\\
\Leftrightarrow & P(q_B)&=&C_M(q_B)
\end{array}
\]
On oblige ainsi le monopole à fixer le prix à son coût moyen, ce qui est une manière de réguler un monopole naturel.
On a $C_M(q)=\frac{5}{3}q^2-40q+340$
On résout ainsi le problème :
\[
\begin{array}{crcl}
&500-50q_B&=&\frac{5}{3}q_B^2-40q_B+340\\
\Leftrightarrow & \frac{5}{3}q_B^2+10q_B-160&=&0\\
\Leftrightarrow & q_B^2+6q_B-96&=&0
\end{array}
\]
On doit donc résoudre une équation du second degré pour obtenir le résultat.
On commence par calculer le discriminant :
\[\Delta=6^2+4\times96=36+384=164=4\times105\]
On en déduit que :
\[q_B=\frac{-6\pm2\sqrt{105}}{2}=-3+\sqrt{105}\text{ ou } -3-\sqrt{105}\]
La solution $q_B=-3-\sqrt{105}<0$ est impossible, car les quantités sont forcément positives. 
La seule solution est donc $q_{B}=-3+\sqrt{105}\approx$ `r round(-3+sqrt(105), digits=2)`. 
On peut en déduire $p_{B}=50(13-\sqrt{105})\approx$ `r round(50*(13-sqrt(105)), digits=2)`.  
On observe que $p_B>p_{CPP}^*$ et $q_B<q_{CPP}^*$, mais en échange, le monopole est à l'équilibre financier et produira.
La situation n'est pas optimale au sens de Pareto, et il y aura une charge morte, mais l'optimum de Pareto est inatteignable sans subventionner le monopole.
Il est impossible de le forcer à tarifer au coût marginal, en utilisant par exemple un prix maximal, car il ferait alors des pertes et ne produirait simplement pas.
La solution de la tarification au coût moyen est en quelques sorte la deuxième meilleure solution possible, mais c'est la seule faisable.
:::

::: {.exercise #naturelexo2}
 Un entreprise est en monopole sur un marché où la fonction de
demande est : 
\[Q\left(p\right)=30-p\] 
La fonction de coût total du monopole est :
\[C(q)=100+\frac{q^2}{2}\]


1. Calculez le prix, la quantité d'équilibre et le profit. Représentez graphiquement cet équilibre et le surplus collectif.
2. L'État décide d'imposer au monopole une tarification au coût marginal. Expliquez cette décision. Représentez le nouvel équilibre et les surplus sur le précédent graphique. Commentez.
3. Calculez le surplus du consommateur et le surplus collectif sans et avec tarification au coût marginal.  
Après une innovation technologique, la fonction de coût devient :
\[C(q)=100+\frac{q}{2}\]

4. L'État peut-il continuer à imposer une tarification au coût marginal ?
5. Quelle situation peut-il retenir ? Pourquoi ? Calculez et représentez le nouveau surplus collectif.
:::


::: { .solution name="Solution de l'exercice \@ref(exr:naturelexo2)"}
1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[C_m(q^*)=C'(q)=q\]
Et :
\[R(q) =qP(q)=30q-q^2\]
La fonction qui nous est donnée est la demande $Q$ et non la demande inverse $P$.
On doit donc trouver la demande inverse, c'est à dire la fonction $P$ telle que $Q(P(q))=q$ :
\[30-P(q)=q \Leftrightarrow P(q) = 30-q\]
La fonction de demande inverse $P$ est donc $P(q)=30-q$.
Donc :
\[R_m(q)=R'(q)=30-2q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&30-2q^*&=&q^*\\
\Leftrightarrow & q^*&=&10
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-2\]
\[C'_m(q)=1>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_m=P(q^*_m)=20$.
Le profit est :
\[\pi(q_m^*, p_m^*)=p_m^*q_m^*-C(q_m^*)=20\times10-\left(100+\frac{10^2}{2}\right)=50>0\]
Le profit est bien positif.
À l'optimum, 10 unités sont échangées sur ce marché, au prix de 20. 
Le monopole réalise alors un profit de 50.

```{r naturelexo21, fig.cap="Représentation graphique  des équilibres"}
C <- function(q){100+q^2/2}
Cm <- function(q){q}
P <- function(q){30-q}
Rm <- function(q){30-2*q}
CM <- function(q){C(q)/q}
qm <- 10
pm <- P(qm)
qcpp <- uniroot(function(q){Cm(q)-P(q)}, c(0,30))$root
pcpp <- P(qcpp)
Stm <- data.frame(x=c(0, qm), ymin=c(Cm(0), Cm(qm)), ymax=c(P(0), P(qm)))
Stcpp <- data.frame(x=c(0, qcpp), ymin=c(Cm(0), Cm(qcpp)), ymax=c(P(0), P(qcpp)))


p_naturel2 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=Rm, color='blue') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 32), breaks=c(0, qm, qcpp), labels=c(0, TeX("$q_m^*$"), TeX("$q_{CPP}^*$"))) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 32), breaks=c(0, pm, pcpp, 30), labels=c(0, TeX("$p_m^*$"), TeX("$p_{CPP}^*$"), 30)) +
  labs(x="quantité", y="prix") +
  geom_ribbon(data=Stm, aes(x=x, ymin=ymin, ymax=ymax), fill='red', alpha=0.5) +
  geom_ribbon(data=Stcpp, aes(x=x, ymin=ymin, ymax=ymax), fill='blue', alpha=0.5) +
  annotate("text", x=6, y=P(6), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=13, y=Rm(13), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=11, y=Cm(11), label=TeX("$C_m$"), color="red") +
  annotate("text", x=5, y=10, label=TeX("$S_t^m$"), color="red") +
  annotate("text", x=12, y=15, label=TeX("$S_t^{CPP}$"), color="blue")
  
p_naturel2

```

2. La tarification au coût marginal du monopole a pour but d'obtenir l'équilibre de concurrence pure et parfaite, qui est un optimum de Pareto.
L'État cherche en fait a augmenter le surplus collectif.
Nous allons représenter ce nouvel équilibre comme étant l'équilibre de concurrence pure et parfaite.

3. Le surplus des consommateurs dans la situation de monopole (question 1) est donné par :
\[S_c^m=\frac{1}{2}(30-p_m^*)\times q_m^*=\frac{1}{2}(30-20)\times 10=50\]
Le surplus du monopole est donné par :
\[S_p^m=\pi^m+CF=50+100=150\]
Car le coût fixe vaut 50.
Le surplus collectif est donc de :
\[S_t^m=S_c^m+S_p^m=150+50=200\]
Pour calculer les surplus avec la tarification au coût marginal, nous devons commencer par calculer les quantités et prix de l'échange.
Nous avons l'équation suivante dans cette configuration :
\[C_m(q^*)=P(q^*)=p^*\]
Soit :
\[q^*=30-q^*\Leftrightarrow q^*_{CPP}=15\]
Et :
\[p^*_{CPP}=P(q^*)=q^*=15\]
En tarifiant au coût marginal, il y a donc 15 unités de biens échangées sur le marché, au prix de 15.
Le surplus des consommateurs est alors :
\[S_c^{CPP}=\frac{1}{2}(30-p_{CPP}^*)\times q_{CPP}^*=\frac{1}{2}(30-15)\times 15=\frac{225}{2}>S_c^m\]
Le surplus du producteur est :
\[S_p^{CPP}=\frac{1}{2}(p_{CPP}^*-0)\times q_{CPP}^*=\frac{1}{2}(30-15)\times 15=\frac{225}{2}<S_p^m\]
On en déduit que le surplus total est :
\[S_t^{CPP}=S_c^{CPP}+S_p^{CPP}=\frac{225}{2}+\frac{225}{2}=225>S_t^m\]
Le surplus collectif est plus important quand l’État impose une tarification au coût marginal que quand il le laisse choisir sa quantité ou son prix.

4. Avec cette nouvelle fonction de coût, le coût marginal devient :
\[C_m(q)=\frac{1}{2}\]
La tarification au coût marginal donnerait donc un prix de l'échange de $p^*=1/2$.
On peut calculer le coût moyen d'une unité produite :
\[C_M(q)=\frac{C(q)}{q}=\frac{100}{q}+\frac{1}{2}>\frac{1}{2}=p^*\]
Le coût moyen d'une unité produite serait donc supérieur au prix de l'échange, et ce, quelque soit le nombre d'unités produites.
Le producteur ferait donc systématiquement des pertes, à cause de ces coûts fixes, ce qui n'est pas une situation soutenable.
Il se retirerait donc du marché.

Rappel : $\pi(q)=pq-C(q)=q(p-C(q)/q)=q(p-C_M(q))$.

5. L’État peut forcer le monopole à tarifer au coût moyen et à répondre à toute la demande.
En l'obligeant à vendre à son coût moyen de production, il s'assure que le monopole ne fait ni bénéfices, ni pertes.
On a alors la condition d'équilibre :
\[C_M(q^*)=P(q^*)=p^*\]
On résout l'équation de gauche :
\[
\begin{array}{crcl}
&C_M(q^*)&=&P(q^*)\\
\Leftrightarrow&\frac{100}{q^*}+\frac{1}{2}&=&30-q^*\\
\Leftrightarrow&200+q^*&=&60q^*-2q^{*2}\\
\Leftrightarrow&2q^{*2}-59q^*+200&=&0\\
\end{array}
\]
Pour trouver la solution, on doit donc résoudre une équation du second degré.
On commence par calculer le discriminant :
\[\Delta=(-59)^2-4\times200\times2=3481-1600=1881=9\times209\]
On en déduit que :
\[q^*=\frac{59\pm3\sqrt{209}}{4}\]
Les deux racines sont positives, l'obligation de satisfaire toute la demande font que l'on prend la racine la plus grande.
La solution est donc $q^*=\frac{59+3\sqrt{209}}{4}\approx$ `r round(59/4+sqrt(209)*3/4, digits=2)`. 
On peut en déduire $p^*=\frac{61-3\sqrt{209}}{4}\approx$ `r round(61/4-3*sqrt(209)/4, digits=2)`.  


```{r naturelexo25, fig.cap="Représentation graphique avec un coût marginal constant."}
C <- function(q){100+q/2}
Cm <- function(q){1/2}
P <- function(q){30-q}
CM <- function(q){C(q)/q}
q <- uniroot(function(q){CM(q)-P(q)}, c(10,30))$root
p <- P(q)
St <- data.frame(x=c(0, q), ymin=c(Cm(0), Cm(q)), ymax=c(P(0), P(q)))


p_naturel3 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=CM, color='darkred') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 32), breaks=c(0, q), labels=c(0, TeX("$q^*$"))) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 32), breaks=c(0, 0.5, p, 30), labels=c(0, 1/2, TeX("$p^*$"), 30)) +
  labs(x="quantité", y="prix") +
  geom_ribbon(data=St, aes(x=x, ymin=ymin, ymax=ymax), fill='red', alpha=0.5) +
  annotate("text", x=6, y=P(6), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=13, y=CM(13), label=TeX("$C_{M}$"), color="darkred") +
  annotate("text", x=11, y=Cm(11), label=TeX("$C_m$"), color="red") +
  annotate("text", x=5, y=10, label=TeX("$S_t$"), color="red")

p_naturel3

```
On représente graphiquement le surplus collectif sur la figure \@ref(fig:naturelexo25). 
On voit que le surplus collectif est un trapèze : \[S_t=\left(30−\frac{1}{2}+p^*−\frac{1}{2}\right)×\frac{q^*}{2}=(29−p^*)\times \frac{q^*}{2}\]
En calculant (à la calculatrice), on obtient $S_t\approx$ `r round((29-p)*q/2, digits=2)`.

:::

::: { .exercise #naturelexo3 }
La demande d'un bien est donnée par : \[Q\left(p\right)=1000-50p\] Le coût
marginal et le coût moyen sont fixes à 10€ l'unité.


1. Quels sont les prix et les quantités d'équilibre en concurrence
et en monopole ?
2. L'État impose une taxe de 2 euros par unité. Quels sont les nouveaux prix et quantités en concurrence et en monopole ?
3. Quelle est la part de l'augmentation des prix supportée par les consommateurs en monopole et en concurrence ?
:::

::: { .solution name="Solution de l'exercice \@ref(exr:naturelexo2)"}
En lisant les données, nous pouvons écrire les fonctions de coût marginal et de coût moyen :
\[C_m(q)=10\qquad C_M(q)=10\]
On peut en déduire que la fonction de coût total est $C(q)=10q$.  
La fonction qui nous est donnée est la demande $Q$ et non la demande inverse $P$.
Pour résoudre l'exercice, nous avons besoin de la fonction de demande inverse, c'est à dire la fonction $P$ telle que $Q(P(q))=q$ :
\[1000-50P(q)=q \Leftrightarrow P(q) = 20-\frac{q}{50}\]


1. Nous allons commencer par résoudre le problème du monopole.
À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[R(q) =qP(q)=20q-\frac{1}{50}q^2\]
Donc :
\[R_m(q)=R'(q)=20-\frac{1}{25}q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&20-\frac{1}{25}q^*_m&=&10\\
\Leftrightarrow & q^*_m&=&250
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-1/25\]
\[C'_m(q)=10>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_m=P(q^*_m)=15>10=C_M(q)$.
Le prix est supérieur au coût moyen, donc les profits seront positifs.
À l'optimum, 250 unités sont échangées sur ce marché, au prix de 15€.  
Résolvons maintenant le problème en concurrence pure et parfaite.
La condition d'équilibre en concurrence pure et parfaite est :
\[C_m(q^*)=P(q^*)=p^*\]
Soit :
\[10=20-\frac{1}{50}q^*_{CPP}\Leftrightarrow q^*_{CPP}=500>q_m^*\]
Et :
\[p^*_{CPP}=P(q^*)=10<p_m^*\]
En concurrence pure et parfaite, 500 unités de biens sont échangées sur le marché à un prix de 10€.
Les quantités échangées sont plus importantes et le prix plus faible qu'en monopole.  
*Remarque :* On peut procéder à une résolution alternative en CPP, sans utiliser la demande inverse.
On a en effet la condition d'équilibre du marché : $C_m(q^*)=P(q^*)=p^*$.
Ici, $C_m(q^*)$ est constant et égal à 10, on a donc immédiatement $p^*=C_m(q^*)=10$.
On peut alors utiliser la fonction de demande $Q$ : $q^*=Q(p^*)=1000-50\times10=500$.
On obtient bien les mêmes résultats qu'en utilisant la demande inverse.
Dans cette exercice, on a néanmoins besoin de la demande inverse pour le monopole, s'en passer n'est donc pas possible.
2. L'imposition d'une taxe unitaire (une taxe sur chaque unité produite) revient à augmenter le coût marginal et le coût moyen du producteur de 2€.
On a donc maintenant $C_m(q)=C_M(q)=10+2=12$ (et $C(q)=12q$).
On résout maintenant le problème comme précédemment.  
Nous allons commencer par résoudre le problème du monopole.
À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[R(q) =qP(q)=20q-\frac{1}{50}q^2\]
Donc :
\[R_m(q)=R'(q)=20-\frac{1}{25}q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&20-\frac{1}{25}q^*_m&=&12\\
\Leftrightarrow & q^*_m&=&200
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-1/25\]
\[C'_m(q)=12>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_m=P(q^*_m)=16>12=C_M(q)$.
Le prix est supérieur au coût moyen, donc les profits seront positifs.
À l'optimum, 200 unités sont échangées sur ce marché, au prix de 16€.  
Résolvons maintenant le problème en concurrence pure et parfaite.
La condition d'équilibre en concurrence pure et parfaite est :
\[C_m(q^*)=P(q^*)=p^*\]
Soit :
\[12=20-\frac{1}{50}q^*_{CPP}\Leftrightarrow q^*_{CPP}=400>q_m^*\]
Et :
\[p^*_{CPP}=P(q^*)=12<p_m^*\]
En concurrence pure et parfaite, 400 unités de biens sont échangées sur le marché à un prix de 12€.
Les quantités échangées sont plus importantes et le prix plus faible qu'en monopole.
3. En concurrence pure et parfaite, l'augmentation du prix lié à la taxe est entièrement supportée par les consommateurs, puisque le nouveau prix est supérieur de 2€ au précédent.
En monopole, le nouveau prix est supérieur de 1€ au précédent.
Les consommateurs absorbent donc la moitié de l'augmentation du prix, et le monopole en absorbe l'autre moitié.

```{r naturelexo3, fig.cap="Représentation graphique  des équilibres avec et sans taxe. Les flèches noires représentent le changement d'équilibre suite à la taxe."}
Cmt <- function(q){12}
Cm <- function(q){10}
P <- function(q){20-q/50}
Rm <- function(q){20-q/25}
qm <- 250
pm <- P(qm)
qmt <- 200
pmt <- P(qmt)
qcpp <- 500
pcpp <- P(qcpp)
qcppt <- 400
pcppt <- P(qcppt)

x=seq(0, 1000, length=1001)
df <- data.frame(x)

p_naturel1 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=Rm, color='blue') +
  geom_function(fun=Cmt, color='darkred') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 600), breaks=c(0, qm, qcpp, qmt, qcppt), labels=c(0, TeX("$q_m^*$"), TeX("$q_{CPP}^*$"), TeX("$q_{mt}^*$"), TeX("$q_{CPPt}^*$"))) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 30), breaks=c(0, pm, pcpp, pmt, pcppt, 20), labels=c(0, TeX("$p_m^*$"), TeX("$p_{CPP}^*$"), TeX("$p_{mt}^*$"), TeX("$p_{CPPt}^*$"), 20)) +
  labs(x="quantité", y="prix") +
  geom_ribbon(data=profitcpp, aes(x=x, ymin=ymin, ymax=ymax), fill='red', alpha=0.5) +
  geom_ribbon(data=profitm, aes(x=x, ymin=ymin, ymax=ymax), fill='green', alpha=0.5) +
  annotate("text", x=100, y=P(100), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=100, y=Rm(100), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=100, y=Cm(100), label=TeX("$C_m$"), color="red") +
  annotate("text", x=100, y=Cmt(100), label=TeX("$C_m^t$"), color="darkred") +
  geom_segment(data=df, x=qm, y=pm, xend=qmt, yend=pmt, colour='black', arrow=arrow(length=unit(0.3, 'cm'), ends='last'), size=1) +
    geom_segment(data=df, x=qcpp, y=pcpp, xend=qcppt, yend=pcppt, colour='black', arrow=arrow(length=unit(0.3, 'cm'), ends='last'), size=1)
  
  
p_naturel1

```
:::


::: { .exercise #naturelexo4 } 
Une entreprise en monopole a une fonction de coût total de :
\[C(q)=3q^2\]
La fonction de demande sur son marché est :
\[P(q)=1200-q\]


1. Donnez la quantité produite, le prix de vente ainsi que le
profit à la solution du monopole.
2. Que fera l'entreprise si elle est confrontée à une taxe
forfaitaire de 50 000€ ? Et si la taxe est de 100 000€ ?
3. L'État souhaite maximiser le surplus total en instaurant un
prix plafond. À quel niveau doit-il le fixer ?
4. Que fera le monopole s'il doit payer une taxe de 40€
par unité ? Quels seront alors ses profits ?
:::

::: {.solution name="Solutions de l'exercice \@ref(exr:naturelexo4)"}
Réponses

1. À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Ici, on a :
\[R(q) =qP(q)=1200q-q^2\]
Et :
\[C_m(q)=C'(q)=6q\]
Donc :
\[R_m(q)=R'(q)=1200-2q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&1200-2q^*_m&=&6q^*_m\\
\Leftrightarrow & q^*_m&=&150
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-2\]
\[C'_m(q)=6>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_m=P(q^*_m)=1050$.
On calcule le profit :
\[\pi_m=p_m^*q_m^*-C(q^*_m)=1050\times150-3\times150^2=90000>0\]
À l'optimum, 150 unités sont échangées sur ce marché, au prix de 1050€.
Le monopole réalise alors un profit de 90 000€.
2. Une taxe forfaitaire ne change pas le comportement du monopole, sauf si la taxe forfaitaire transforme le profit du monopole en pertes.
Le profit réalisé par le monopole devient avec la taxe forfaitaire $T$ :
\[\pi_m=p_m^*q_m^*-C(q^*_m)-T=1050\times150-3\times150^2-T=90000-T\]
On en conclut que si la taxe forfaitaire est de 50 000€, le monopole continuera de produire normalement, mais si la taxe est de 100 000€, il arrêtera de produire et fermera.
3. L’État doit fixer un prix plafond qui est égal au prix de la concurrence pure et parfaite pour maximiser le surplus total.
Cherchons donc l'équilibre de concurrence pure et parfaite.
La condition d'équilibre en concurrence pure et parfaite est :
\[C_m(q^*)=P(q^*)=p^* (=p_{max})\]
Soit :
\[6q^*_{CPP}=1200-q^*_{CPP}\Leftrightarrow q^*_{CPP}=\frac{1200}{7}>150=q_m^*\]
Et :
\[p_{max}=P(q^*)=\frac{7200}{7}<1050=p_m^*\]
L’État doit donc fixer un prix plafond de $\frac{7200}{7}\approx$ `r round(7200/2, digits=2)`€ pour maximiser le surplus total.
4.  Une taxe unitaire de 40€ revient donc à augmenter le coût de production par unité de 40€ pour le monopole.
Le coût marginal du monopole devient donc $C_m(q)=6q+40$.
À l'optimum, un monopole choisit la quantité telle que son coût marginal est égale à son revenu marginal :
\[R_m(q^*)=C_m(q^*)\]
Avec :
\[R_m(q)=1200-2q\]
À l'optimum, on doit donc avoir :
\[
\begin{array}{crcl}
&1200-2q^*_m&=&6q^*_m+40\\
\Leftrightarrow & q^*_m&=&145
\end{array}
\]
On vérifie aussi la condition de second ordre \@ref(eq:cso) :
\[R_m'(q^*)<C_m'(q^*)\]
\[R'_m(q)=-2\]
\[C'_m(q)=6>R_m'(q)\]
La condition du second est bien vérifiée, nous avons bien un maximum ici.
Le prix est $p^*_m=P(q^*_m)=1055$.
On calcule le profit :
\[\pi_m=p_m^*q_m^*-C(q^*_m)=1055\times145-(3\times145^2+40\times 145)=84100>0\]
À l'optimum avec une taxe unitaire de 40€, 145 unités sont échangées sur ce marché, au prix de 1055€.
Le monopole réalise alors un profit de 84 100€.
L'augmentation du prix est de 5€, cela signifie que 35€ de la taxe sera payée par le monopole. 
Nous sommes ici dans un cas où le monopole supportera l'essentiel du prix de la taxe.
:::
 
 
## Politique tarifaire du monopole

::: { .exercise #discriminationquestions} 
Pour chacune des pratiques ci-dessous, dites s'il s'agit de discrimination au deuxième ou au troisième degré.

1. Un professeur de tennis fait payer les leçons 15 euros de l'heure pour un enfant de moins de 14 ans et 30 euros au-delà.
2. Un supermarché propose la promotion suivante sur des soupes: la deuxième achetée et toutes les suivantes sont à moitié prix. 
3. Un médecin de campagne accepte d'être payé en nature par les paysans mais exige d'être payé en monnaie par les commerçants et les châtelains.
4. Pour trois articles achetés, le moins cher est offert.
:::

:::{.solution name="Réponses aux questions"}
Discrimination du *deuxième degré* : discrimination sur les quantités achetées.
Le prix unitaire des biens est décroissant avec la quantité achetée par le consommateur.  
Discrimination du *troisième degré* : le monopole est capable de différencier les consommateurs et de vendre à des prix différents pour différents groupes de consommateurs.

1. 3^e^ degré
2. 2^e^ degré
3. 3^e^ degré
4. 2^e^ degré
:::

::: { .exercise #discriminationexo1 name="Discrimination au deuxième degré"} 
Un monopole fait face à la fonction de demande :
\[Q(p)=100-p\]  et à la fonction de coût :
\[C(q)=25+10q.\]

Le monopole pratique la discrimination au deuxième degré : les $q_1$ premières unités sont vendues au prix $p_1=P(q_1)$, où $P\left(.\right)$ est la fonction de demande inverse. Les suivantes sont vendues au prix $p_2$.

1. Déterminez le prix auquel les premières unités sont vendues et le prix auxquelles les suivantes sont vendues, la quantité $q_1$ et la quantité totale vendue.
2. Calculez le surplus du consommateur et le profit du producteur.
3. (facultatif) L'État impose au monopole une taxe de 6 euros par unité produite. Le revenu de la taxe est reversé aux consommateurs. Refaites les calculs précédents dans ce cas. Comparez aux résultats précédents et commentez.
:::

:::{ .solution name="Solution de l'exercice \@ref(exr:discriminationexo1)"}
On note dans la correction $q_2$ la quantité de bien vendue au prix $p_2$.
Ainsi, la quantité totale $q$ est égale à $q_1+q_2$.
On remarque que l'énoncé nous donnes ici la fonction de demande $Q(p)=100-p$, alors que nous avons besoin de la fonction de demande inverse $P(q)$.
En résolvant $Q(P(q))=q$, on obtient $P(q)=100-q$.

1. On commence par écrire le profit du monopole discriminant :
\[\pi(q_1, q_2)=q_1\times P(q_1)+p_2\times q_2-C(q_1+q_2)\]
On commence par dériver suivant $q_1$ pour obtenir la condition du premier sur les premières unités vendues.
\[\frac{\partial \pi}{\partial q_1}=P'(q_1)\times q_1+P(q_1)-C_m(q_1+q_2)\]
On par ailleurs :
\[P'(q)=-1\]
\[C_m(q)=C'(q)=10\]
On réécrit donc la dérivée partielle suivant $q_1$ :
\[\frac{\partial \pi}{\partial q_1}=-q_1+(100-q_1)-10\]
En utilisant condition du premier ordre $\frac{\partial \pi}{\partial q_1}(q_1^*)=0$, cela donne donc :
\[-2q_1^*+90=0\Leftrightarrow q_1^*=45\]
Et $p_1^*=P(q_1^*)=100-45=55$.
On peut maintenant étudier la maximisation sur le groupe 2, en calculant la dérivée partielle du profit suivant q_2 :
\[\frac{\partial \pi}{\partial q_2}=p_2-C_m(q_1+q_2)\]
En utilisant la condition du premier ordre, $\frac{\partial \pi}{\partial q_2}(q_2^*)=0$, on obtient :
\[p_2^*=10\]
On peut en déduire la quantité *totale* achetée par les consommateurs :
$q=Q(p_2^*)=100-p_2^*=90$, et donc $q_2^*=45$.
Attention, $Q(p_2^*)$ nous donne bien la quantité totale achetée sur le marché, et pas la quantité achetée au prix $p_2^*$.
En effet, les premières unités sont vendues au prix $p_1^*=P(q_1^*)$, et ensuite la deuxième partie des unités est vendue au prix $p_2^*$.
2. Représentons d'abord la situation.

```{r discriminationexo2, fig.cap="Représentation graphique de la discrimination du second degré."}
Cmt <- function(q){16}
Cm <- function(q){10}
P <- function(q){100-q}
Rm <- function(q){100-2*q}
q1 <- 45
p1 <- P(q1)
q2 <- 90
p2 <- P(q2)

profitm <- data.frame(x=c(0, q1), ymax=c(p1, p1), ymin=c(Cm(q1), Cm(q1)))
Sc1 <- data.frame(x=c(0, q1), ymax=c(P(0), p1), ymin=c(p1, p1))
Sc2 <- data.frame(x=c(q1, q2), ymax=c(p1, p2), ymin=c(p2, p2))


x=seq(0, 1000, length=1001)
df <- data.frame(x)

p_discri2 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=Rm, color='blue') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, q1, q2), labels=c(0, TeX("$q_1^*$"), TeX("$q_2^*$"))) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 110), breaks=c(0, p1, p2, 100), labels=c(0, TeX("$p_1^*$"), TeX("$p_2^*$"), 100)) +
  labs(x="quantité", y="prix") +
  geom_ribbon(data=Sc1, aes(x=x, ymin=ymin, ymax=ymax), fill='green', alpha=0.5) +
  geom_ribbon(data=Sc2, aes(x=x, ymin=ymin, ymax=ymax), fill='green', alpha=0.5) +
  geom_ribbon(data=profitm, aes(x=x, ymin=ymin, ymax=ymax), fill='blue', alpha=0.5) +
  annotate("text", x=95, y=P(95), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=52, y=Rm(52), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=95, y=Cm(95), label=TeX("$C_m$"), color="red") +
  annotate("text", x=20, y=30, label=TeX("$S_p$"), color="blue") +
  annotate("text", x=20, y=70, label=TeX("$S_c$"), color="darkgreen") +
  annotate("text", x=70, y=20, label=TeX("$S_c$"), color="darkgreen") 

p_discri2

```
Les quantités vendues au prix $p_2^*$ par le producteur sont produites au coût marginal.
Il n'en retire donc aucun surplus. 
Le seul surplus obtenu par le monopole discriminant l'est quand il vend les unités vendues au prix $p_1^*$.
On remarque alors que le surplus obtenu est donné par un rectangle :
\[S_P=(p_1^*-p_2^*)\times(q_1^*-0)=45^2=2025\]
Le profit du producteur est donc $\pi=S_p-CF=2000$, où CF est le coût fixe du monopole.
Le surplus des consommateurs est divisé en deux. 
Le surplus obtenu grâce aux unités vendues au prix $p_1^*$ et le surplus obtenu grâce aux unités vendues au prix $p_2^*$.
On obtient ainsi l'aire de deux triangles :
\[S_c=\frac{1}{2}\left((100-p_1^*)\times(q_1^*-0)+(q_2^*-q_1^*)(p_1^*-p_2^*)\right)=\frac{1}{2}(45^2+45^2)=45^2=2025\]

3. Si l'État impose une taxe de $t=6$ euros par unité produite, le coût du monopole devient alors :
\[C(q)=25+(10+t)q=25+16q\]
Le coût marginal devient donc $C_m(q)=16$.
Comme l'État reverse le produit de la taxe au consommateurs, leur capacité à payer (=pouvoir d'achat) augmente de $t$ euros. 
Autrement dit, la demande inverse devient $P(q)=100+t-q=106-q$.
En réutilisant les calculs de la question 1., et en particulier la dérivée partielle du profit suivant $q_1$.
\[\frac{\partial \pi}{\partial q_1}=-q_1+(106-q_1)-16=-2q_1+90\]
On se rend compte qu'on obtient la même condition du premier ordre.
On obtient aussi la même condition du premier ordre pour 2.
La taxe et sa redistribution n'ont donc aucun effet.
:::

:::{ .exercise #discriminationexo2}
L'entreprise de surgelés Equus vend des lasagnes au cheval sur deux marchés : le marché standard et le marché du hard discount. 
Sur le premier marché les lasagnes sont directement vendues sous la marque Equus ; sur le second elles sont vendues moins chères sous la marque Fer-à-Cheval.

1. Question préliminaire.
Soit une fonction de demande donnée par:
\[Q(p)=\frac{A}{p^\varepsilon},\] 
avec $A>0$ et $\varepsilon >0$.
Montrez que la valeur absolue de l'élasticité de $Q$ par rapport au prix vaut $\varepsilon$. 
Ce résultat pourra être utilisé directement dans la suite.
2.Le prix de vente optimal des lasagnes de la marque Equus est de $p_E=42$ euros le kg. 
D'après les recherches du département marketing, la demande pour les lasagnes de marque Equus est donnée par  $Q_E(p_E)=\frac{10000}{p_E^2}$ et pour la marque Fer-à-Cheval  par $Q_F(p_F)=\frac{10000}{p_F^4}$. 
		a. Donnez la formule qui, à la solution du monopole discriminant, relie le rapport des prix $\frac{p_E}{p_F}$ aux élasticités-prix $\varepsilon_E$ et $\varepsilon_F$ sur les deux marchés.
		b. Déduisez-en le prix $p_F$ qui maximise le profit du monopole discriminant.
		c. Déduisez-en également le coût marginal de production de la quantité totale $q_E+q_F$ maximisant le profit du monopole. 
:::

::: {.solution name="Réponses de l'exercice \@ref(exr:discriminationexo2)"}
*Rappel :* Élasticité prix de la demande

\[\varepsilon_{q/p}=\frac{p}{Q(p)}\frac{1}{Q'(p)}\]

1. Pour répondre à cette question, on doit donc dériver la fonction de demande (qui est une fonction puissance).
\[Q'(p)=\frac{A\varepsilon}{p^{\varepsilon+1}}\]
On a donc :
\[\varepsilon_{q/p} =\frac{p}{\frac{A}{p^\varepsilon}}\times\frac{A\varepsilon}{p^{\varepsilon+1}}=\varepsilon\]
Les puissances et les A se simplifiant.
On a donc bien le résultat demandé.
2. On remarque que les fonctions de demande donnée pour les consommateurs des deux marques ont la forme donnée dans la question 1., avec $A=10000$ et $\varepsilon_E=2$ et $\varepsilon_F=4$.
    a. On a ici une discrimination du 3^e^ degré. 
Le producteur répartit la production entre les deux groupes de manières à égaliser les revenus marginaux des deux groupes :
\[R_{mE}(q^*_E)=R_{mF}(q^*_F)\]
Or par définition :
\[R_{mi}(q_i)=P_i(q_i)-q_iP_i'(q_i)=P_i(q_i)\left(1+\frac{q_i}{P_i(q_i)}P_i'(q_i)\right)\]
On reconnaît à gauche l'expression de l'élasticité prix de la demande du groupe $i$, on a donc :
\[R_{mi}(q_i)=P_i(q_i)\left(1-\frac{1}{|\varepsilon_{q_i/p}(q_i)|}\right)\]
On peut donc en déduire qu'à l'équilibre :
\begin{gather*}
R_{mE}(q^*_E)=R_{mF}(q^*_F)\\
\Leftrightarrow p_E\left(1-\frac{1}{\varepsilon_E}\right) = p_F\left(1-\frac{1}{\varepsilon_F}\right) \\
\Leftrightarrow \frac{p_E}{p_F}=\frac{1-\frac{1}{\varepsilon_F}}{1-\frac{1}{\varepsilon_E}}
\end{gather*}
    b. Dans l'expression précédente, on connaît le prix $p_E$ et les élasticité prix de la demande.
On peut donc les remplacer, on a alors :
\[\frac{42}{p_F}=\frac{1-\frac{1}{4}}{1-\frac{1}{2}}=\frac{\frac{3}{4}}{\frac{1}{2}}=\frac{3}{4}\frac{2}{1}=\frac{3}{2}\]
On en déduit donc $p_F=\frac{2}{3}42=28$€/kg.
    c. À l'équilibre du monopole discriminant, on a, en plus de l'égalité entre les revenu marginaux, que ceux-ci sont égaux au coût marginal total :
\[R_{mE}(q^*_E)=R_{mF}(q^*_F)=C_m(q_E^*+q_F^*)\]
Donc :
\[C_m(q^*)=R_{mE}(q^*_E)=p_E\left(1-\frac{1}{\varepsilon_E}\right)=42\frac{1}{2}=21\]
Le coût marginal total à l'équilibre est de 21€/kg.
:::

::: {.exercise #discriminationexo3 }
La fonction de coût d'un monopole est donnée par :
\[C(q)=30-q+\frac{q^2}{2}\] Il existe deux types de consommateurs (A et
B) dont les fonctions de demande sont respectivement :
\[P_{A}(q_{A})=64-4q_{A}\] et : \[P_{B}(q_{B})=32-2q_{B}\]

1. Calculez la solution du monopole discriminant.
2. Répondez à nouveau à la question ci-dessus lorsque la
demande de la population B devient \[P_{B}(q_{B})=64-2q_{B}\] et que
la demande du marché A ne change pas.
:::


::: {.solution name="Réponses de l'exercice \@ref(exr:discriminationexo3)"}
La propriété fondamentale à utiliser dans ce problème est l'égalité entre le revenu marginal sur chacun des marchés et le coût marginal total du monopole discriminant :
\begin{equation}
R_{mA}(q_A)=R_{mB}(q_B)=C_m(q_A+q_B) 
(\#eq:discriminant3e)
\end{equation}
1. D'après l'équation \@ref(eq:discriminant3e), on doit calculer le revenu marginal sur chacun des marché et le coût marginal total.
Le coût marginal total :
\[C_m(q)=C'(q)=-1+2q\]
Revenu sur les deux marchés :
\[
\begin{array}{rl}
R_A(q_A)&=q_AP(q_A)=64q_A-4q_A^2\\
R_B(q_B)&=q_BP(q_B)=32q_B-2q_B^2
\end{array}
\]
Revenu marginal sur les deux marchés :
\[
\begin{array}{rl}
R_{mA}(q_A)&=R'_A(q_A)=64-8q_A\\
R_{mB}(q_B)&=R'_B(q_B)=32-4q_B
\end{array}
\]
On a alors au moins deux méthodes pour résoudre le problème.
La première est d'égaliser les deux recettes marginales (égalité gauche de l'équation \@ref(eq:discriminant3e)) pour connaître la quantité relative dans un marché par rapport à l'autre :
\[
\begin{array}{crcl}
&R_{mA}(q_A)&=&R_{mB}(q_B)\\
\Leftrightarrow&64-8q_A&=&32-4q_B\\
\Leftrightarrow&-16+2q_A&=&-8+q_B\\
\Leftrightarrow&q_B&=&2q_A-8
\end{array}
\]
Nous avons donc une relation entre $q_A$ et $q_B$.
La deuxième étape est d'utiliser l'égalité entre le coût marginal total et un des revenu marginal.
Ici, nous allons utiliser $R_{mA}(q_A)=C_m(q_A+q_B)$ et l'égalité trouvée avant pour remplacer $q_B$ :
\[
\begin{array}{crcl}
&R_{mA}(q_A)&=&C_m(q_A+q_B)\\
\Leftrightarrow&64-8q_A&=q_A+q_B-1\\
\Leftrightarrow&65-9q_A&=2q_A-8\\
\Leftrightarrow&11q_A&=73\\
\Leftrightarrow&q_A&=&\frac{73}{11}
\end{array}
\]
Une fois $q_A$ trouvée, on peut en déduire $q_B=2\times\frac{73}{11}-8=\frac{58}{11}$, et enfin calculer les prix :
\[p_A=P_A(q_A)=64-4q_A=64-4\frac{73}{11}=\frac{412}{11}\]
\[p_B=P_B(q_B)=32-2q_B=32-2\frac{58}{11}=\frac{236}{11}\]
On a ainsi trouvé les quantités et prix pour chaque groupe.
2. On a maintenant une nouvelle demande inverse pour le groupe B, on doit donc changer la recette et la recette marginale du groupe B.
\[
\begin{array}{rl}
R_B(q_B)&=q_BP(q_B)=64q_B-2q_B^2\\
R_{mB}(q_B)&=R'_B(q_B)=64-4q_B
\end{array}
\]
On doit donc recalculer la condition d'égalité entre les deux groupes :
\[
\begin{array}{crcl}
&R_{mA}(q_A)&=&R_{mB}(q_B)\\
\Leftrightarrow&64-8q_A&=&64-4q_B\\
\Leftrightarrow&q_B&=&2q_A
\end{array}
\]
On peut alors recalculer la deuxième condition :
\[
\begin{array}{crcl}
&R_{mA}(q_A)&=&C_m(q_A+q_B)\\
\Leftrightarrow&64-8q_A&=q_A+q_B-1\\
\Leftrightarrow&65-9q_A&=2q_A\\
\Leftrightarrow&11q_A&=65\\
\Leftrightarrow&q_A&=&\frac{65}{11}
\end{array}
\]
On peut donc en déduire $q_B=\frac{130}{11}$. On peut en déduire les prix pour chaque groupe :
\[p_A=P_A(q_A)=64-4q_A=64-4\frac{65}{11}=\frac{444}{11}\]
\[p_B=P_B(q_B)=64-2q_B=64-2\frac{130}{11}=\frac{444}{11}\]
Les prix sur les deux marchés sont égaux.
:::

:::{ .exercise #discriminationexo4 }
Une entreprise en situation de monopole a réussi à percevoir
une différence parmi les consommateurs. Elle est alors capable de
séparer les consommateurs qui s'adressent à lui en deux marchés
distincts. Sur le premier marché, la fonction de demande
inverse est de : \[P_{1}(q_{1})=60-5q_{1}\] Sur le second marché,
elle est de : \[P_{2}(q_{2})=180-20q_{2}\]


1. Calculez les prix, les quantités d'équilibre et le profit sachant que la fonction de coût du monopole est la suivante : \[C(q)=50+20q\]
avec $q=q_1+q_2$ la quantité totale produite.
2. Calculez $\left.\frac{p_{i}-C_m(q)}{p_i}\right|_{i=1,2}$, et
montrez que
$\frac{p_{i}-C_m(q)}{p_{i}}=\frac{1}{\left|\varepsilon_{q_i/p_i}\right|}$ à l'optimum du monopole.
:::

::: { .solution name="Réponses à l'exercice \@ref(exr:discriminationexo4)"}
Nous sommes dans une situation de discrimination au troisième degré.
1. On veut utiliser l'équation \@ref(eq:discriminant3e) : à l'équilibre du monopole discriminant au 3^e^ degré, le coût marginal total est égal au revenu marginal obtenu de chacun des groupes.
Le coût marginal total :
\[C_m(q)=C'(q)=20\]
Revenu sur les deux marchés :
\[
\begin{array}{rl}
R_1(q_1)&=q_1P(q_1)=60q_1-5q_1^2\\
R_2(q_2)&=q_2P(q_2)=180q_2-20q_2^2
\end{array}
\]
Revenu marginal sur les deux marchés :
\[
\begin{array}{rl}
R_{m1}(q_1)&=R'_1(q_1)=60-10q_1\\
R_{m2}(q_2)&=R'_2(q_2)=180-40q_2
\end{array}
\]
Nous allons ici montrer la deuxième méthode pour résoudre le problème du monopole discriminant.
Nous allons résoudre un système de deux équations à deux inconnues :
\begin{align*}
R_{m1}(q_1^*)=C_m(q_1^*+q_2^*) & \Leftrightarrow & 60-10q_1^*=20 & \Leftrightarrow &q_1^*=4\\
R_{m2}(q_2^*)=C_m(q_1^*+q_2^*) & \Leftrightarrow & 180-40q_2^*=20 & \Leftrightarrow &q_2^*=4
\end{align*}
On peu alors grâce aux demandes inverse en déduire les prix :
\begin{gather*}
p_1^*=P_1(q_1^*) = 60-5\times4=40\\
p_2^*=P_2(q_2^*) = 180-20\times4=100
\end{gather*}
On peut finalement en déduire le profit :
\[\pi(q_1^*, q_2^*)=p_1^*q_1^*+p_2^*q_2^*-C(q_1^*+q_2^*)=160+400-(50+20\times8)=350\]
2. On va commencer par calculer le taux de marge sur chaque marché.
Sur le marché 1 :
\[\frac{p_1^*-C_m(q_1^*+q_2^*)}{p_1^*}=\frac{40-20}{40}=\frac{1}{2}\]
Sur le marché 2 :
\[\frac{p_2^*-C_m(q_1^*+q_2^*)}{p_2^*}=\frac{100-20}{100}=\frac{4}{5}\]
On calcule maintenant l'élasticité prix de la demande pour chacun des groupes :
\[|\varepsilon_{q_1/p_1}|=\left|\frac{p_1^*}{q_1^*}\frac{1}{P'(q^*_1)}\right|=\left|\frac{40}{4}\frac{1}{-5}\right|=2\]
On a donc bien :
\[\frac{p_1^*-C_m(q_1^*+q_2^*)}{p_1^*}=\frac{1}{|\varepsilon_{q_1/p_1}|}\]
On peut faire un calcul similaire pour le groupe 2 :
\[|\varepsilon_{q_2/p_2}|=\left|\frac{p_2^*}{q_2^*}\frac{1}{P'(q^*_2)}\right|=\left|\frac{100}{4}\frac{1}{-20}\right|=\frac{5}{4}\]
On a donc bien :
\[\frac{p_2^*-C_m(q_1^*+q_2^*)}{p_2^*}=\frac{1}{|\varepsilon_{q_2/p_2}|}\]
:::

## Oligopoles

::: {.exercise #oligopolequestions name="Questions de cours"}
Questions :

1. Dans un duopole à la Cournot, comme chaque entreprise
cherche à maximiser son profit, l'équilibre est tel qu'aucune des
deux firmes ne peut améliorer son profit sans réduire celui de
l'autre. Vrai ou Faux ?
2. Lorsque deux firmes produisent un bien homogène, est-il
plus avantageux, du point de vue des consommateurs, que la
concurrence se fasse à la Cournot ou à la Stackelberg ?
3. Expliquez pourquoi la lutte contre les collusions fait
partie des objectifs de nombreux gouvernements.
:::

::: {.solution} 
Réponses :

1. Faux, une situation de cartel est une situation où les deux entreprises peuvent améliorer leur profit par rapport au duopole de Cournot.
2. Il est plus avantageux d'être en Stackelberg, en effet la quantité échangée sur le marché sera plus importante et le prix plus faible.
Le surplus des consommateurs sera donc plus élevé.
3. La collusion entre deux entreprises a pour effet de diminuer les quantités sur le marché et d'augmenter les prix.
Cela diminue le surplus collectif.
:::

### Cournot

::: {.exercise #cournotexo1 name="Duopole de Cournot"}
On suppose que la demande pour l'eau de source est donnée par la fonction de demande inverse:
\[P(q)=1200-q\]
On suppose également que le coût marginal de production d'une bouteille d'eau est égal à 300. Deux entreprises se partagent le marché de l'eau et se font concurrence en quantité.
1. Déterminez les quantités produites et le prix de vente à l'équilibre de Cournot-Nash.
2. Déterminez le taux de marge de chaque firme et l'indice de Lerner du marché.
:::

::: {.solution name="Réponses à l'exercice \@ref(exr:cournotexo1)"}
On peut lire ici que le coût marginal de production des deux entreprises est identiques et vaut 300.
Elles sont donc parfaitement symétriques.
On peut supposer le coût fixe constant, on a alors que le coût de production pour une entreprise est donné par $C(q)=300q$.

1. Chaque entreprise cherche à maximiser son profit en prenant la quantité produite par l'autre entreprise comme une donnée.
On cherche d'abord à calculer les fonctions de réaction (qui seront identiques entre les deux entreprises, puisqu'elles sont symétriques).
On commence par écrire le profit de l'entreprise A :
\begin{align*}
\pi_A(q_A, q_B)&=q_AP(q_A+q_B)-C_A(q_A)\\
&=q_A(1200-q_A-q_B)-300q_A\\
&=(900-q_B)q_A-q_A^2
\end{align*}
L'entreprise A va maintenant anticiper que l'entreprise B va produire une quantité $q_B^a$ et maximiser son profit.
On obtient la dérivée partielle suivant $q_A$ :
\[\frac{\partial\pi_A}{\partial q_A}=900-q_B^a-2q_A\]
En utilisant la condition du premier ordre :
\[\frac{\partial_A\pi}{\partial q_A}(q_A^*+q_B^a)=0\]
On obtient la fonction de réaction de A :
\[2q_A^*+q_B^a=900\Leftrightarrow q_A^*=450-\frac{1}{2}q_B^a\]
Comme le problème est symétrique, on peut en déduire la fonction de réaction de B :
\[q_B^*=450-\frac{1}{2}q_A^a\]
Pour calculer l'équilibre de Cournot, les anticipations de chacune des entreprises doit correspondre à ce que fait réellement l'autre entreprise.
Autrement dit $q_A^a=q_A^*$ et  $q_B^a=q_B^*$.
On obtient donc :
\begin{gather*}
q_A^*=450-\frac{1}{2}q_B^*\\
q_B^*=450-\frac{1}{2}q_A^*
\end{gather*}
Pour résoudre ce système, on peut, par exemple, remplacer dans la première expression $q_B^*$ par son expression dans la deuxième. 
On obtient :
\begin{gather*}
q_A^*=450-\frac{1}{2}\left(450-\frac{1}{2}q_A^*\right) \\
\Leftrightarrow \frac{3}{4}q_A^*=450-225\\
\Leftrightarrow q_A^*=300
\end{gather*}
Par symétrie des entreprises A et B, on obtient immédiatement que $q_B^*=300$.
On peut en déduire le prix sur le marché :
\[p^*=P(q_A^*+q_B^*)=1200-(q_A^*+q_B^*)=600\]
À l'équilibre de Cournot, chaque entreprise produit donc 300 bouteilles, qui sont vendues à 600.
2. Le taux de marge d'une entreprise est aussi son indice de Lerner :
\[L_i=\frac{p^*-C_{mi}(q_i^*)}{p^*}=\frac{S_i}{|\varepsilon_{q/p}{q^*}|}\]
Les entreprises sont symétriques, elles auront donc le même indice de Lerner :
\[L_A=L_B=\frac{600-300}{600}=\frac{1}{2}\]
On peut trouver le même résultat en utilisant la propriété liant indice de Lerner et élasticité prix de la demande.  
On calcule maintenant l'indice de Lerner du marché :
\[L=S_AL_A+S_BL_B\]
Ici, les parts de marché de chaque entreprise sont identiques et valent : $S_A=S_B=q_A^*/q^*=1/2$.
On a donc :
\[L=\frac{1}{2}\frac{1}{2}+\frac{1}{2}\frac{1}{2}=\frac{1}{2}\]
L'indice de Lerner du marché est de $\frac{1}{2}$.
:::

::: { .exercise #cournotexo2}
Supposons un marché sur lequel il n'y a que deux entreprises, A et B, qui vendent une marchandise homogène produite sans coûts. La demande sur ce marché est donnée par la fonction : 
\[Q\left(p\right)=240-10p\] $p$ étant le prix de la marchandise.

1. Dans cette question, on suppose que, chacune des deux entreprises, en déterminant sa production optimale, *considère la production de l'autre comme donnée.*
    a. Dans quel type de duopole se trouvent les deux firmes?
    b. Déterminez la meilleure réponse de la firme $i$ à la quantité produite par la firme $j$, $i,j=A,B$.
    c. Représentez graphiquement ces deux courbes et identifiez l'équilibre sur le graphique. 
    d.  Calculez les quantités et le prix d'équilibre. Calculez le profit de chaque firme.
    e. Comparez-les aux prix, quantités et profits qui prévaudraient si les firmes étaient en monopole et si elles étaient en concurrence parfaite.
    f. Calculez le surplus social dans les situations de concurrence, de duopole et de monopole et comparez-les.
    g. Que se passerait-il au niveau de la production et du prix d'équilibre de la branche si une troisième entreprise entrait? Si $n-2$ entreprises entraient, $n>2$?
2. On suppose maintenant que le coût marginal de la firme $A$ est $c_A$, alors que celui de la firme $B$ est $c_B$. Les coûts fixes sont toujours nuls.
 Calculez à nouveau les quantités et le prix d'équilibre lorsqu'on se place dans le cadre de la question 1). Calculez les profits de chaque firme. Commentez.
:::

::: {.solution name="Réponse à l'exercice \@ref(exr:cournotexo2)"}
L'énoncé nous donne la fonction de demande, mais nous allons utiliser la fonction de demande inverse.
On résout $Q(P(q))=q$, soit :
\[240-10P(q)=q\Leftrightarrow P(q)=24-\frac{q}{10}\]

1. Les deux entreprises n'ont aucun coût de production.
On a donc :
\[C_{A}(q_A)=C_{B}(q_B)=0\]
La production de l'autre entreprise est considérée comme donnée.
    a. Les deux entreprises se trouvent en duopole de Cournot : elles se font concurrence en quantité et ne connaissent pas la quantité produite par l'autre entreprise.
Comme leur coût de production est identique, ces deux entreprises sont symétriques, tout ce qu'on écrira pour l'une peut s'écrire pour l'autre en changeant ce qu'il faut changer.
    b. On commence par écrire le profit de l'entreprise A :
\[\pi_A(q_A, q_B)=q_AP(q_A+q_B)-C_A(q_A)=q_AP(q_A+q_B)\]
L'entreprise A va maintenant anticiper que l'entreprise B va produire une quantité $q_B^a$ et maximiser son profit.
On obtient la dérivée partielle suivant $q_A$ :
\begin{align*}
\frac{\partial\pi_A}{\partial q_A}&=q_AP'(q_A+q_B^a)+P(q_A+q_B^a)\\
&=q_A\frac{-1}{10}+(24-\frac{1}{10}(q_A+q_B^a))\\
&=-\frac{1}{10}(2q_A+q_B^a)+24
\end{align*}
En utilisant la condition du premier ordre :
\[\frac{\partial\pi_A}{\partial q_A}(q_A^*+q_B^a)=0\]
On obtient la fonction de réaction de A :
\[2q_A^*+q_B^a=240\Leftrightarrow q_A^*=120-\frac{1}{2}q_B^a\]
Comme le problème est symétrique, on peut en déduire la fonction de réaction de B :
\[q_B^*=120-\frac{1}{2}q_A^a\]
    c. On représente graphiquement l'équilibre.
    
```{r cournotexo2, fig.cap="Représentation des fonctions de réaction d'un équilibre de Cournot."}

f2 <- function(q){120-q/2}
f1 <- function(q){240-2*q}

qc <- uniroot(function(q){f1(q)-f2(q)}, c(0, 120))$root

p_equilibre <- ggplot() +
  labs(x="quantité A", y = "quantité B") +
  geom_function(fun=f1, colour="red") +
  geom_function(fun=f2, colour="blue") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 250), breaks=c(qc, 120, 240), labels=c(TeX("$q_{B}^*$"), 120, 240)) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 250), breaks=c(qc), labels=c(TeX("$q_{A}^*$"))) +
  annotate("point", x=qc, y=qc) +
  annotate("text", x=qc, y=qc+10, label='Equilibre de Cournot') +
  annotate("text", x=50, y=f1(20), label='Fonction de réaction 1', colour='red') +
  annotate('text', x=200, y=f2(200), label='Fonction de réaction 2', colour='blue')

p_equilibre
```
    
d. Pour calculer l'équilibre de Cournot, les anticipations de chacune des entreprises doit correspondre à ce que fait réellement l'autre entreprise.
Autrement dit $q_A^a=q_A^*$ et  $q_B^a=q_B^*$.
On obtient donc :
\begin{gather*}
q_A^*=120-\frac{1}{2}q_B^*\\
q_B^*=120-\frac{1}{2}q_A^*
\end{gather*}
Pour résoudre ce système, on peut, par exemple, remplacer dans la première expression $q_B^*$ par son expression dans la deuxième. 
On obtient :
\begin{gather*}
q_A^*=120-\frac{1}{2}\left(120-\frac{1}{2}q_A^*\right) \\
\Leftrightarrow \frac{3}{4}q_A^*=120-60\\
\Leftrightarrow q_A^*=80
\end{gather*}
Par symétrie des entreprises A et B, on obtient immédiatement que $q_B^*=80$.
On peut en déduire le prix sur le marché :
\[p^*=P(q_A^*+q_B^*)=24-\frac{1}{10}(q_A^*+q_B^*)=24-\frac{160}{10}=8\]
Le profit de la firme A est alors :
\[\pi_A(q_A^*, q_B^*)=q_A^*\times p^*=8*80=640\]
Il en est de même pour l'entreprise B.
Le profit total en duopole est donc $1280$.
    e. En monopole, on aurait égalité de la recette marginale avec le coût marginal ($R_m(q)=C_m(q)$).
Ici, le coût marginal est nul, on a donc $R_m(q)=0$ sur ce marché.
Avec $R(q)=qP(q)=24q-\frac{1}{10}q^2$, donc $R_m(q)=24-\frac{1}{5}q$.
On a donc à l'optimum du monopole :
\[24-\frac{1}{5}q^*_m=0\Leftrightarrow q_m^*=120\]
On en déduit le prix en monopole $p_m^*=24-\frac{1}{10}120=12$.  
Et le profit en monopole $\pi_m=12\times 120=1440$.  
En concurrence pure et parfaite, l'offre est égale à la demande et l'offre est donnée par le coût marginal.
Celui-ci est nul ici. 
On a donc $P(q^*_{CPP})=0$, soit $24-\frac{1}{10}q^*_{CPP}=0$, donc $q_{CPP}^*=240$, et $p_{CPP}^*=0$.
Le profit en CPP est donc nul.  
On constate que la situation de duopole de Cournot est intermédiaire entre la concurrence pure et parfaite et le monopole.
La quantité échangée est entre celle de monopole et de CPP, de même que le prix et le profit des producteurs.
    f. Il n'y a ici pas de coût fixe, on a donc déjà calculé le surplus des producteurs : ce sont exactement les profits. 
Représentons graphiquement la situation pour le reste.

```{r cournotexo21f, fig.cap="Représentation graphique des différentes situations."}

Cm <- function(q){0}
P <- function(q){24-q/10}
Rm <- function(q){24-q/5}
qm <- 120
qd <- 160
qcpp <- 240
pm <- P(qm)
pd <- P(qd)
pcpp <- P(qcpp)


x=seq(0, 1000, length=1001)
df <- data.frame(x)

p_exocournot21 <- ggplot() +
  geom_function(fun=P, color='darkgreen') +
  geom_function(fun=Cm, color='red') +
  geom_function(fun=Rm, color='blue') +
  scale_x_continuous(expand = c(0, 0), limits=c(0, 250), breaks=c(0, qm, qd, qcpp), labels=c(0, TeX("$q_m^*$"), TeX("$q_{c}^*$"), TeX("$q_{CPP}^*$"))) +
  scale_y_continuous(expand = c(0, 0), limits=c(0, 25), breaks=c(0, pm, pd, pcpp, 24), labels=c(0, TeX("$p_m^*$"), TeX("$p_c^*$"), TeX("$p_{CPP}^*$"), 24)) +
  labs(x="quantité", y="prix") +
  annotate("text", x=95, y=P(95), label=TeX("demande ($P$)"), color="darkgreen") +
  annotate("text", x=52, y=Rm(52), label=TeX("$R_{m}$"), color="blue") +
  annotate("text", x=95, y=10, label=TeX("$C_m$"), color="red")

p_exocournot21

```
À l'aide du graphique, on peut calculer les différents surplus des consommateurs :
\[S_c^m=\frac{1}{2}(24-p_m^*)\times q_m^*=\frac{1}{2}(24-12)120=720\]
\[S_c^c=\frac{1}{2}(24-p_c^*)\times q_c^*=\frac{1}{2}(24-8)160=1280\]
\[S_c^{cpp}=\frac{1}{2}(24-p_{cpp}^*)\times q_{cpp}^*=\frac{1}{2}(24-0)240=2880\]
On peut donc en déduire le surplus total dans chacun des cas :
\[S_t^m=S_c^m+S_p^m=720+1440=2160\]
\[S_t^c=S_c^c+S_p^c=1280+1280=2560\]
\[S_t^{CPP}=S_c^{CPP}+S_p^{CPP}=2880+0=2880\]
Le surplus social est donc le plus élevé en situation de concurrence pure et parfaite.
Dans les deux autres cas, il est possible d'améliorer la situation des producteurs et des consommateurs simultanément.
    g. Nous allons directement poser le problème comme si le marché contenait $n$ entreprises (autrement dit, comme si $n-2$ entreprises entraient sur le marché).
On peut écrire le profit de l'entreprise $i$ :
\[\pi_i(q_i, q)=P(q)q_i-C_i(q_i)\]
Où $q=\sum_{i=1}^nq_i$ est la quantité totale produite, et $C_i(q_i)=0$ ici.
On cherche d'abord la fonction de réaction de l'entreprise $i$, en maximisant son profit et considérant les productions des autres entreprises comme données.
Attention, dans cette maximisation, $q$ dépend de $q_i$.
On calcule donc la dérivée partielle suivant $q_i$ :
\[\frac{\partial \pi_i}{\partial q_i}=q_iP'(q)+P(q)\]
Avec la condition du premier ordre de l'entreprise $i$ :
\[\frac{\partial \pi_i}{\partial q_i}=0 \Leftrightarrow q_iP'(q)+P(q)=0\]
On peut remplacer $P(q)$ et $P'(q)$ par leur expression.
\[q_i^*\times\left(-\frac{1}{10}\right)+24-\frac{1}{10}q^*=0\]
Les entreprises sont toutes identiques, elles produiront donc la même quantité à l'équilibre de Cournot.
On peut en déduire que $q_i^*=\frac{q^*}{n}$.
On peut alors réécrire l'équation d'équilibre :
\[-\frac{1}{10}\frac{q^*}{n}+24-\frac{1}{10}q^*=0\quad\Leftrightarrow \quad \frac{1}{10}q^*\left(1+\frac{1}{n}\right)=24\]
Autrement dit :
\[q^*\frac{n+1}{n}=240\quad\Leftrightarrow\quad q^*=\frac{n}{n+1}240\]
On en déduit le prix :
\[p^*=P(q^*)=24-\frac{1}{10}q^*=\frac{24}{n+1}\]
On constate que plus le nombre d'entreprise est élevée, plus la quantité échangée sur le marché est grande et se rapproche de celle de la concurrence pure et parfaite.
A l'inverse, le prix diminue et se rapproche lui aussi du prix de la CPP.
2. Les deux entreprises ont maintenant des coût marginaux de production non nuls.
On peut refaire les raisonnements de b. et d. avec des nouveaux profits :
On commence par écrire le profit de l'entreprise A :
\[\pi_A(q_A, q_B)=q_AP(q_A+q_B)-C_A(q_A)\]
L'entreprise A va maintenant anticiper que l'entreprise B va produire une quantité $q_B^a$ et maximiser son profit.
On obtient la dérivée partielle suivant $q_A$ :
\begin{align*}
\frac{\partial_A\pi}{\partial q_A}&=q_AP'(q_A+q_B^a)+P(q_A+q_B^a)-C'_A(q_A)\\
&=q_A\frac{-1}{10}+(24-\frac{1}{10}(q_A+q_B^a))-c_A\\
&=-\frac{1}{10}(2q_A+q_B^a)+24-c_A
\end{align*}
En utilisant la condition du premier ordre :
\[\frac{\partial_A\pi}{\partial q_A}(q_A^*+q_B^a)=0\]
On obtient la fonction de réaction de A :
\[2q_A^*+q_B^a=240-10c_A\Leftrightarrow q_A^*=120-5c_A-\frac{1}{2}q_B^a\]
Comme le problème est presque symétrique, on peut en déduire la fonction de réaction de B :
\[q_B^*=120-5c_B-\frac{1}{2}q_A^a\]
Pour calculer l'équilibre de Cournot, les anticipations de chacune des entreprises doit correspondre à ce que fait réellement l'autre entreprise.
Autrement dit $q_A^a=q_A^*$ et  $q_B^a=q_B^*$.
On obtient donc :
\begin{gather*}
q_A^*=120-5c_A-\frac{1}{2}q_B^*\\
q_B^*=120-5c_B-\frac{1}{2}q_A^*
\end{gather*}
Pour résoudre ce système, on peut, par exemple, remplacer dans la première expression $q_B^*$ par son expression dans la deuxième. 
On obtient :
\begin{gather*}
q_A^*=120-5c_A-\frac{1}{2}\left(120-c_B-\frac{1}{2}q_A^*\right) \\
\Leftrightarrow \frac{3}{4}q_A^*=120-60-5c_A+\frac{5}{2}c_B\\
\Leftrightarrow q_A^*=80-\frac{20}{3}c_A+\frac{10}{3}c_B
\end{gather*}
Par symétrie des entreprises A et B, on obtient immédiatement que $q_B^*=80-\frac{20}{3}c_B+\frac{10}{3}c_A$.
On peut en déduire le prix sur le marché :
\[p^*=P(q_A^*+q_B^*)=24-\frac{1}{10}(q_A^*+q_B^*)=8+\frac{1}{3}(c_A+c_B)\]
Le profit de la firme A est alors :
\[\pi_A(q_A^*, q_B^*)=q_A^*\times p^*-C_A(q_A^*)=10\left(8+\frac{1}{3}\left(c_B-2c_A\right)\right)^2\]
On en déduit le profit de l'entreprise B :
\[\pi_B(q_A^*, q_B^*)=10\left(8+\frac{1}{3}\left(c_A-2c_B\right)\right)^2\]
On constate que les quantités augmentent avec le coût marginal de l'autre entreprise et diminue avec son propre coût marginal.
Il en est de même pour les profits.
Plus cela coûte cher de produire pour l'autre entreprise, plus je ferai de profits.
On remarque que dans tous les cas, si on prend $c_A=c_B=0$, on retombe sur les résultats de la question 1, ce qui est rassurant pour nos calculs.
:::


### Stackelberg

::: { .exercise #stackexo1}
On se place dans le cadre de l'exercice \@ref(exr:cournotexo2), mais on suppose que l'entreprise A entre d'abord sur le marché, suivi de la firme B. 

1. On suppose maintenant que chaque firme détermine sa production juste après son entrée sur le marché, en tenant compte de la réaction de l'autre: $A$ entre d'abord, choisit sa quantité et l'impose à $B$, qui se comporte en suiveuse.
    a. Dans quel type de duopole sommes-nous ? A priori laquelle des deux firmes va être favorisée par la situation ?
    b. Calculez la meilleure réponse de la firme $B$ à la production de la firme $A$. 
    c. Déduisez-en la production de la firme $A$, le prix d'équilibre de la branche et les profits des deux firmes. Commentez.
    d. Comparez les profits des deux firmes à leurs profits dans la situation de la question 1) de l'exercice 3.3. Commentez.
2. On suppose maintenant que le coût marginal de la firme $A$ est $c_A=4$, alors que celui de la firme $B$ est $c_B=0$. Les coûts fixes sont toujours nuls.
 Calculez à nouveau les quantités et le prix d'équilibre lorsqu'on se place dans le cadre de la question 1). Calculez les profits de chaque firme. Que constatez-vous? Commentez.
:::

::: {.solution name="Solution de l'exercice \@ref(exr:stackexo1)"}
On va pouvoir reprendre une partie des calculs de l'exercice \@ref(exr:cournotexo2).

1. Ici, cela signifie donc que $A$ est leader et $B$ follower.
    a. Duopole de Stackelberg.
    b. La meilleure réponse a déjà été calculé à la question 1.B de l'exercice \@ref(exr:cournotexo2).
Elle vaut : 
\[q_B^*=120-\frac{1}{2}q_A^a\]
    c. La résolution est maintenant différente de la résolution de Cournot.
Le producteur A peut *internaliser* la fonction de réaction du producteur B.
Il sait comment B va réagir à sa production et en plus est le premier à entrer sur le marché et peut donc imposer sa quantité à B.
On a donc le profit de A :
\[\pi_A(q_A, q_B(q_A))=q_AP(q_A+q_B(q_A))-C_A(q_A)=q_AP(q_A+q_B(q_A))\]
La maximisation du producteur A aboutit à la condition du premier ordre :
\[\frac{\partial \pi_A}{\partial q_A}=0\]
Ici, contrairement à précédemment, $q_B$ dépend de $q_A$ et A le sait, il va donc prendre en compte cette dépendance :
\begin{align*}
\frac{\partial \pi_A}{\partial q_A}&=P(q_A + q_B(q_A))+q_A(1+q'_B(q_A))P'(q_A+q_B(q_A))\\
&=24-\frac{1}{10}(q_A+q_B(q_A))+\frac{1}{2}q_A\frac{-1}{10}\\
&=24-\frac{1}{10}\left(q_A+120-\frac{1}{2}q_A\right)+\frac{1}{2}q_A\frac{-1}{10}\\
&=24-12-\frac{1}{20}q_A-\frac{1}{20}q_A\\
&=12-\frac{1}{10}q_A
\end{align*}
En utilisant la condition du premier ordre, on a donc :
\[12-\frac{1}{10}q_A^*=0\Leftrightarrow q_A^*=120\]
On en déduit $q_B^*=120-\frac{120}{2}=60$, donc $q^*=180$ et $p^*=6$.
Les profits sont donc :
\begin{gather*}
\pi_A=120\times6=720\\
\pi_B=60\times 6 = 360
\end{gather*}
    c. Le profit est plus élevé en Stackelberg pour A, mais plus faible pour B, malgré la totale symétrie de A et B en dehors de leur position sur le marché.
Cette seule asymétrie profite à A, qui exploite son avantage afin d'augmenter son profit.
2. On peut reprendre une partie des calculs précédents.
Comme la structure de coût de B n'a pas changé, sa fonction de réaction n'a pas non plus changé :
\[q_B^*=120-\frac{1}{2}q_A^a\]
Le programme de maximisation de A est le même, à un changement prêt :
\[\pi_A(q_A, q_B(q_A))=q_AP(q_A+q_B(q_A))-C_A(q_A)\]
Si on reprend les calculs de la question précédente :
\begin{align*}
\frac{\partial \pi_A}{\partial q_A}&=P(q_A + q_B(q_A))+q_A(1+q'_B(q_A))P'(q_A+q_B(q_A))-C'_A(q_A)\\
&=24-\frac{1}{10}(q_A+q_B(q_A))+\frac{1}{2}q_A\frac{-1}{10}-c_A\\
&=24-\frac{1}{10}\left(q_A+120-\frac{1}{2}q_A\right)+\frac{1}{2}q_A\frac{-1}{10}-4\\
&=8-\frac{1}{10}q_A
\end{align*}
En utilisant la condition du premier ordre, on a donc :
\[8-\frac{1}{10}q_A^*=0\Leftrightarrow q_A^*=80\]
On en déduit que $q_B^*=80$ et $q^*=160$, donc $p^*=8$.
On en déduit les profits :
\begin{gather*}
\pi_A=80\times 8-4\times 80=320\\
\pi_B=80\times 8 = 640
\end{gather*}
L'entreprise B, qui est follower sur ce marché en Stackelberg, fait maintenant plus de profits que l'entreprise A.
Elle produit en effet la même quantité, mais a un coût plus faible.
Conclusion, ce n'est pas parce qu'une entreprise est leader qu'elle fera plus de profit.
Cela dépend aussi de la structure de coût respective des deux entreprises.
:::

::: { .exercise #stackexo2 name="Stackelberg, coûts fixes"}
Soit deux firmes seules sur un marché produisant un bien homogène pour lequel la demande est :
\[P\left(q\right)=a-bq\]
1. Chacune des deux firmes produit avec la fonction de coût suivante:
\[C(q_i)=cq_i+F.\]
    a. L'existence de coûts fixes a-t-elle un impact sur les fonctions de meilleure réponse?
    b. L'existence de coûts fixes a-t-elle un impact sur la décision de produire?
2. La firme $A$ est leader dans un duopole de Stackelberg, avec $c=0$ et $F>0$. La firme $B$ est suiveuse avec $c=F=0$. Quel est l'impact de $F$ sur l'avantage de $A$?
:::

::: {.solution name="Réponses à l'exercice \@ref(exr:stackexo1)"}
Réponses.

1. On a ici une fonction de coût affine.
    a. Intuitivement, la réponse est non. 
En effet, tous nos raisonnements sont marginaux, et le coût fixe disparaît dans ces cas-là.
Nous pouvons vérifier cela.
Commençons par écrire le profit de l'entreprise $i$ :
\[\pi_i(q_i, q)=q_iP(q)-C_i(q_i)(=q_i(a-bq)-cq_i-F=q_i(a-c)-bq_iq-F)\]
Pour maximiser son profit, l'entreprise $i$ doit vérifier la condition du premier ordre : 
\[\frac{\partial\pi_i}{\partial q_i}=0\quad \Leftrightarrow \quad q_iP'(q)+P(q)-C'_i(q_i)=0\]
Le coût n'entre qu'au travers de sa dérivée dans le calcul, donc le coût fixe disparaît : $C'_i(q_i)=c$.
Un coût fixe ne modifie donc pas la fonction de meilleure réponse dans un oligopole.
    b. La réponse est oui : en effet, dans le cas où les coût fixes seraient trop élevée, alors l'entreprise ferait des pertes et préférerait ne pas produire.
2. Calculons maintenant la fonction de meilleure réponse de B avec les paramètres qui nous sont donnés.
On a $P'(q)=-b$, et $C'_B(q_B)=0$.
Donc on a d'après la CPO :
\[-bq_B+a-b(q_A+q_B)=0\Leftrightarrow b(q_A+2q_B)=a\Leftrightarrow q_B=\frac{1}{2}\left(\frac{a}{b}-q_A\right)\]
On peut maintenant résoudre le problème de maximisation de A, en utilisant la fonction de réaction de B :
\begin{align*}
\pi_A(q_A, q_B)&=aq_A-bq_A(q_A+q_B)-F\\
&=-bq_A^2+q_A\left(a-b\frac{1}{2}\left(\frac{a}{b}-q_A\right)\right)\\
&=\frac{1}{2}(a-bq_A)q_A-F
\end{align*}
On peut maintenant calculer la condition du premier ordre de A en dérivant le profit :
\[\pi_A'(q_A)=0 \Leftrightarrow  a-bq_A^*-bq_A^*=0\Leftrightarrow q_A^*=\frac{a}{2b}\]
$F$ n'est pas présent dans la quantité optimale produite par A.
Néanmoins, le profit total de A à l'optimum est :
\[\pi_A(q_A^*)=\frac{1}{2}(a-bq_A^*)q_A^*-F=\frac{a^2}{8b}-F\]
Si $F$ est trop grand (ici, supérieur à $\frac{a^2}{8b}$), alors l'entreprise A ne produira pas.
Plus $F$ est grand, plus le profit de A est faible.
En revanche, $F$ n'influence pas les quantités produites par $A$ et en ce sens n'impacte pas son avantage informationnel.
:::


### Cartels

::: {.exercise #cartelexo1}
On se place à nouveau dans le cadre de l'exercice \@ref(exr:cournotexo2).

1. Supposons que les entreprises signent un accord de cartel pour produire conjointement la quantité correspondant à la situation de monopole.
Quelle est la quantité que devrait produire chaque firme si elle respectait cet accord et quel serait alors le prix d'équilibre? 
2. Si la première firme respecte l'accord, la seconde a-t-elle intérêt à le respecter? Si non, combien produira-t-elle? Quel conséquence cela a-t-il?
:::

::: { .solution name="Solution de l'exercice \@ref(exr:cartelexo1)"}
On reprend dans cet exercice une partie des calculs de l'exercice \@ref(exr:cournotexo2).

1. Le cartel cherche à maximiser le profit joint des deux entreprises.
On écrit ce profit :
\[\pi(q)=qP(q)-C_A(q_A)-c_B(q_B)\text{ avec }q=q_A+q_B\]
On a vu en cours à l'équilibre, le cartel cherche à égaliser la recette marginale totale avec le coût marginal de chacune des entreprises :
\[R_m(q^*)=C_{mA}(q_A^*)=C_{mB}(q_B^*)\]
Ici, les coûts, et donc les coûts marginaux, sont nuls.
On a donc directement $R_m(q^*)=0$.
On avait trouvé que la demande inverse est $P(q)=24-\frac{1}{10}q$.
Donc $R_m(q)=24-\frac{1}{5}q$.
On obtient donc l'équation suivante pour l'optimum du cartel :
\[24-\frac{1}{5}q^*=0\quad\Leftrightarrow\quad q^*=120\]
On peut en déduire $p^*=12$.
On retrouve bien la solution du monopole qu'on avait trouvé à la question 1.e de l'exercice \@ref(exr:cournotexo2).
Ici, les coûts de production sont nuls dans les deux entreprises, la répartition entre les deux n'importe donc pas.
2. L'accord entre les deux entreprises doit être tel que $q_A+q_B=120$.
Or, on a la fonction de réaction trouvée en 1.b de l’exercice \@ref(exr:cournotexo2) :
\[q_A=120-\frac{q_B}{2}\Leftrightarrow q_A+\frac{1}{2}q_B=120\]
Or la fonction de réaction représente la quantité optimale que produirait A pour une quantité $q_B$ donnée.
L'accord n'est *pas* sur la fonction de réaction (sauf si $q_B=0$), donc A aurait intérêt à ne pas respecter l'accord.
On voit avec la fonction de réaction que A souhaiterait produire plus que ce que l'accord de cartel lui dit de produire.
En effet, l'accord lui dit de produire $q_A=120-q_B$, alors que A aurait envie de produire $120-\frac{1}{1}q_B$.
Cela entraînera une quantité plus importante sur le marché et un prix plus faible que ce que le cartel ferait.
:::

::: {.exercise #cartelexo2 name="Duopole et cartel"}
La demande pour le bien $q$ est donnée par : 
\[P(q)=180-2q\]
Seules 2 firmes identiques produisent le bien, leur fonction de coût individuelle est : 
\[C(q_{i})=100+q_{i}^2\] 
Dans chacun des cas suivants, donnez les quantités produites, les prix et les profits des deux firmes :

1. Les firmes mènent une concurrence à la Cournot ;
2. Les firmes mènent une concurrence à la Stackelberg ;
3. Elles coopèrent afin de former un cartel.
:::

::: {.solution name="Solution de l'exercice \@ref(exr:cartelexo2)"}
Cet exercice résume une grande partie du chapitre sur les duopoles et propose de résoudre les principales situations vu dans ce chapitre.  
Les deux entreprises sont symétriques en termes de coût : elles ont la même fonction de coût.

1. Dans la concurrence à la Cournot, les deux entreprises sont exactement identiques.
Elles entrent simultanément sur le marché et ont la même fonction de coût.
Elles auront donc la même production et le même profit.
On commence par écrire le profit de l'entreprise 1 :
\begin{align*}
\pi_1(q_1, q)&=q_1P(q)-C(q_1)\\
&=q_1(180-2q_1-2q_2)-100-q_1^2\\
&=-3q_1^2+(180-2q_2)q_1-100
\end{align*}
On cherche maintenant la fonction de réaction de l'entreprise 1.
L'entreprise 1, pour prendre sa décision, anticipe que l'entreprise 2 produira $q_2^a$.
Elle maximise ensuite son profit, ce qui aboutit à la condition du premier ordre $\frac{\partial\pi_1}{\partial q_1}(q_1^*, q_2^a)=0$.
On a :
\[\frac{\partial\pi_1}{\partial q_1}(q_1, q_2)=-6q_1+180-2q_2\]
Grâce à la condition du premier ordre, on obtient la fonction de réaction de 1 :
\[6q_1^*=180-2q_2^a\quad \Leftrightarrow \quad q_1^*=30-\frac{1}{3}q_2^a\]
Par symétrie, on a la fonction de réaction de 2 :
\[ q_2^*=30-\frac{1}{3}q_1^a\]
On cherche maintenant à résoudre l'équilibre de Cournot en utilisant que $q_2^a=q_2^*$ et $q_1^a=q_1^*$.
On peut le faire par exemple en remplaçant dans la fonction de réaction de 1 la valeur obtenue pour $q_2$ :
\begin{align*}
&q_1^*=30-\frac{1}{3}\left(30-\frac{1}{3}q_1^*\right)\\
\Leftrightarrow & q_1^*=20+ \frac{1}{9}q_1^* \\
\Leftrightarrow & \frac{8}{9}q_1^*=20\\
\Leftrightarrow & q_1^*=\frac{45}{2}
\end{align*}
Par symétrie, on obtient aussi que $q^*_2=\frac{45}{2}$.
La quantité totale échangée sur le marché est donc 45.
On en déduit le prix $p^*=P(q^*)=180-2\times45=90$.
Le profit de l'entreprise 1 est alors :
\[\pi_1(q_1^*, q_2^*)=-3q_1^{*2}+(180-2q_2^*)q_1^*-100=\frac{5675}{4}\]
Par symétrie, $\pi_2(q_1^*, q_2^*)=\frac{5675}{4}$=`r 5675/4`.
2. On se place maintenant dans une situation de concurrence à la Stackelberg. 
On va faire l'hypothèse que l'entreprise 1 est leader et l'entreprise 2 follower.
La résolution est maintenant différente de la résolution de Cournot.
Le producteur 1 peut *internaliser* la fonction de réaction du producteur 2 (que nous avons déjà calculé à la question 1).
Il sait comment 2 va réagir à sa production et en plus est le premier à entrer sur le marché et peut donc imposer sa quantité à 1.
On a donc le profit de 1 :
\[\pi_1(q_1, q_2(q_1))=q_1P(q_1+q_2(q_1))-C(q_1)=-3q_1^2+(180-2q_2(q_1))q_1-100\]
La maximisation du producteur 1 aboutit à la condition du premier ordre :
\[\frac{\partial \pi_1}{\partial q_1}=0\]
Ici, contrairement à précédemment, $q_2$ dépend de $q_1$ et 1 le sait, il va donc prendre en compte cette dépendance :
\begin{align*}
\frac{\partial \pi_1}{\partial q_1}&=P(q_1+ q_2(q_1))+q_1(1+q'_2(q_1))P'(q_1+q_2(q_1))-C'(q_1)\\
&=-6q_1+180-2q_2(q_1)-2q_2'(q_1)q_1\\
&=-6q_1+180-2\left(30-\frac{1}{3}q_1\right)-2\times-\frac{1}{3}q_1\\
&=q_1\left(-6+\frac{2}{3}+\frac{2}{3}\right)+180-60\\
&=-\frac{14}{3}q_1+120
\end{align*}
En utilisant la condition du premier ordre, on a donc :
\[-\frac{14}{3}q_1^*+120=0\Leftrightarrow q_1^*=\frac{180}{7}\]
On en déduit $q_2^*=30-\frac{60}{7}=\frac{150}{7}$, donc $q^*=\frac{330}{7}$ et $p^*=\frac{600}{7}$.
Les profits sont donc :
\begin{gather*}
\pi_1=\frac{180}{7}\times\frac{600}{7}-100-\left(\frac{180}{7}\right)^2=\frac{10100}{7}\approx 1443\\
\pi_B=\frac{150}{7}\times\frac{600}{7}-100-\left(\frac{150}{7}\right)^2=\frac{62600}{49}\approx 1278\\
\end{gather*}
Le profit en Stackelberg est supérieur au profit en Cournot pour l'entreprise leader, mais inférieur pour l'entreprise follower.
3. On étudie maintenant une situation de cartel.
Les deux entreprises se mettent d'accord entre elles sur les quantités à produire.
Le cartel cherche à maximiser le profit joint des deux entreprises.
On écrit ce profit :
\[\pi(q)=qP(q)-C(q_1)-C(q_2)\text{ avec }q=q_1+q_2\]
On a vu en cours à l'équilibre, le cartel cherche à égaliser la recette marginale totale avec le coût marginal de chacune des entreprises :
\[R_m(q^*)=C_m(q_1^*)=C_{m}(q_2^*)\]
Ici, les coûts, et donc les coûts marginaux, sont identiques.
Le coût marginal est $C_m(q_1)=2q_1$
On a la demande inverse $P(q)=180-2q$.
Donc $R_m(q)=180-4q$.
On obtient donc l'équation suivante pour l'optimum du cartel :
\[180-4q^*=2q_1^*\quad\Leftrightarrow\quad 6q_1^*+4q_2^*=180\Leftrightarrow 3q_1^*+2q_2^*=90\]
Par symétrie, en utilisant l'égalité entre le coût marginal de 2 et le revenu marginal total, on a :
\[2q_1^*+3q_2^*=90\]
Par symétrie entre les deux entreprises, on a $q_1^*=q_2^*$, donc $q_1^*=q_2^*=18$, et $q^*=36$.
On  en déduit $p^*=108$.
Le profit du cartel est alors :
\[\pi(q^*, p^*)=108\times36-100-100-18^2-18^2=3040\]
Le profit de chaque membre du cartel est donc $1520$.
On constate que le profit en cartel est supérieur au profit en Stackelberg (même pour l'entreprise leader) et en Cournot.
:::



::: {.exercise #cartelexo3 name="Duopole et cartel bis (exercice de révision)"}
On considère un marché de duopole caractérisé par la fonction
de demande : \[P=100-0.5\left(q_{1}+q_{2}\right)\] et où les fonctions
de coût des deux entreprises sont : \[C\left(q_{1}\right)=5q_{1}\]
\[C\left(q_{2}\right)=0.5q_{2}^{2}\]

1. À partir des équations de profit, déterminer les fonctions de réaction des deux entreprises et les représenter graphiquement.
Déterminer l'équilibre de Cournot de ce marché en duopole.
2. En considérant successivement les deux cas suivants :
    - entreprise I meneur et entreprise II suiveur ;
    - entreprise II meneur et entreprise I suiveur ;  
Déterminer les deux équilibres de Stackelberg correspondants. Que se
passe-t-il dans le cas où chacune des entreprises, croyant avoir un
avantage informationnel, après avoir calculé son profit en tant que
meneur et suiveur, choisit le rôle qui lui procure le plus grand
gain ? Ce qui résulte de telles décisions conduit-il à une situation
de marché stable ? Pourquoi?
3. Les deux entreprises reconnaissent leur situation d'interdépendance mutuelle et sont d'accord pour agir de manière coordonnée afin de maximiser le profit total du groupe. Elles constituent donc un cartel.
Déterminer la solution maximisant le profit du cartel. Pourquoi dans
cette solution le coût marginal doit-il être égal dans les deux
entreprises ?
4. On suppose que les deux entreprises négocient la constitution du cartel à partir de l'équilibre de Cournot.  Sur un graphique dont le système d'axes représente les profits des deux entreprises, porter la droite représentant les différentes répartitions possibles du profit du cartel entre les deux entreprises. A partir du point correspondant à l'équilibre de Cournot, préciser la région de marchandage et déterminer les profits des deux entreprises dans le cadre d'un accord conduisant à répartir de manière égale le surplus de profit résultant du cartel.
:::

::: {.solution name="Réponse à l'exercice \@ref(exr:cartelexo3)"}
Cet exercice pourrait être un exercice d'examen.
Il réunit les principales questions sur les oligopoles qui pourraient être posées.
Ici, les fonctions de coût ne sont pas symétriques, ce qui veut dire que le problème ne peut plus être simplifier grâce à la symétrie.

1. Commençons par écrire le profit de chacune des entreprises :
\begin{gather*}
\pi_1(q_1, q_2)=q_1P(q)-C_1(q_1)=\left(95-\frac{1}{2}q_2\right)q_1-\frac{1}{2}q_1^2\\
\pi_2(q_1, q_2)=q_2P(q)-C_2(q_2)=\left(100-\frac{1}{2}q_1\right)q_2-q_2^2
\end{gather*}
Afin de trouver les fonctions de réactions de chacune des entreprises, nous allons maximiser leur profit en considérant que la quantité produite par l'autre entreprise est fixée.
On utilise les conditions du premier ordre :
\begin{gather*}
\frac{\partial \pi_1}{\partial q_1}(q_1, q_2)=0\\
\frac{\partial \pi_2}{\partial q_2}(q_1, q_2)=0
\end{gather*}
On commence par calculer les dérivées partielles du profit :
\begin{gather*}
\frac{\partial \pi_1}{\partial q_1}(q_1, q_2)=95-\frac{1}{2}q_2-q_1\\
\frac{\partial \pi_2}{\partial q_2}(q_1, q_2)=100-\frac{1}{2}q_1-2q_2
\end{gather*}
On obtient les fonctions de réaction en égalisant ces dérivées avec 0 :
\begin{gather*}
q_1^*=95-\frac{1}{2}q_2^a\\
q_2^*=50-\frac{1}{4}q_1^a
\end{gather*}
```{r cartelexo31, fig.cap="Représentation des fonctions de réaction d'un équilibre de Cournot."}

f2 <- function(q){50-q/4}
f1 <- function(q){190-2*q}

qc <- uniroot(function(q){f1(q)-f2(q)}, c(0, 120))$root

p_reaction <- ggplot() +
  labs(x="quantité 1", y = "quantité 2") +
  geom_function(fun=f1, colour="red") +
  geom_function(fun=f2, colour="blue") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 200), breaks=c(f1(qc), 50, 190), labels=c(TeX("$q_{2}^*$"), 50, 190)) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 200), breaks=c(qc), labels=c(TeX("$q_{1}^*$"))) +
  annotate("point", x=qc, y=f1(qc)) +
  annotate("text", x=qc, y=f1(qc)+10, label='Equilibre de Cournot') +
  annotate("text", x=50, y=f1(20), label='Fonction de réaction 1', colour='red') +
  annotate('text', x=150, y=f2(150), label='Fonction de réaction 2', colour='blue')

p_reaction
```
On cherche maintenant à résoudre l'équilibre de Cournot en utilisant que $q_2^a=q_2^*$ et $q_1^a=q_1^*$.
On peut résoudre pour cela un système de deux équations à deux inconnues en réécrivant les fonctions de réaction :
\begin{align*}
2q_1^*+q_2^*&=95 &\Leftrightarrow &-7q_2^*&=190-400=-210&\Leftrightarrow &q_2^*&=30\\
q_1^*+4q_2^*&=200 & &7q_1^*&=4\times 190-200=560& &q_1^*&=80
\end{align*}
La quantité totale échangée sur le marché est donc $q^*=110$.
On en déduit que le prix est $p^*=45$.
On calcule aussi les profits (cela sera utile plus tard dans l'exercice).
\begin{align*}
\pi_1&=80\times 45-5\times 80=3200\\
\pi_2&=30\times 45-\frac{1}{2}30^2=900
\end{align*}
2. On se place maintenant en Stackelberg dans le cas où l'entreprise 1 est leader.
On a obtenu la fonction de réaction de 2 à la question 1 :
\[
q_2^*=50-\frac{1}{4}q_1^a
\]
On peut l'introduire dans le profit de 1 
\[\pi_1(q_1, q_2(q_1))=q_1P(q_1+q_2(q_1))-C_1(q_1)=-\frac{3}{8}q_1^2+70q_1\]
La maximisation du producteur 1 aboutit à la condition du premier ordre :
\[\frac{\partial \pi_1}{\partial q_1}=0\]
Ici, contrairement à précédemment, $q_2$ dépend de $q_1$ et 1 le sait, il va donc prendre en compte cette dépendance :
\begin{align*}
\frac{\partial \pi_1}{\partial q_1}&=P(q_1+ q_2(q_1))+q_1(1+q'_2(q_1))P'(q_1+q_2(q_1))-C_1'(q_1)\\
&=-\frac{3}{4}q_1+70
\end{align*}
En utilisant la condition du premier ordre, on a donc :
\[-\frac{3}{4}q_1^*+70=0\Leftrightarrow q_1^*=\frac{280}{3}\]
On en déduit $q_2^*=50-\frac{70}{3}=\frac{80}{3}$, donc $q^*=120$ et $p^*=40$.
Les profits sont donc :
\begin{gather*}
\pi_1=\frac{280}{3}\times 40-5\times\frac{280}{3}=\frac{9800}{3}\approx 3267\\
\pi_2=\frac{80}{3}\times 40-\frac{1}{2}\left(\frac{80}{3}\right)^2=\frac{6400}{9}\approx 711\\
\end{gather*}
Inversons maintenant les rôles de 1 (follower) et 2 (leader).
On a obtenu la fonction de réaction de 1 à la question 1 :
\[
q_1^*=95-\frac{1}{2}q_2^a
\]
On peut l'introduire dans le profit de 1 
\[\pi_2(q_1(q_2), q_2)=q_2P(q_1(q_2)+q_2)-C_2(q_2)=-\frac{3}{4}q_2^2+\frac{105}{2}q_2\]
La maximisation du producteur 2 aboutit à la condition du premier ordre :
\[\frac{\partial \pi_2}{\partial q_2}=0\]
Ici, $q_1$ dépend de $q_2$ et 2 le sait, il va donc prendre en compte cette dépendance :
\begin{align*}
\frac{\partial \pi_2}{\partial q_2}&=P(q_1(q_2)+ q_2)+q_2(1+q'_1(q_2))P'(q_1(q_2)+q_2)-C_2'(q_2)\\
&=-\frac{3}{2}q_2+\frac{105}{2}
\end{align*}
En utilisant la condition du premier ordre, on a donc :
\[-\frac{3}{2}q_2^*+\frac{105}{2}=0\Leftrightarrow q_2^*=35\]
On en déduit $q_1^*=95-\frac{1}{2}35=\frac{155}{2}$, donc $q^*=\frac{225}{2}$ et $p^*=\frac{175}{4}$.
Les profits sont donc :
\begin{gather*}
\pi_1=\frac{155}{2}\times \frac{175}{4}-5\times\frac{155}{2}=\frac{155^2}{8}\approx 3003\\
\pi_2=\frac{175}{4}\times 35-\frac{1}{2}35^2=918,75
\end{gather*}
Si on regarde les profits dans les deux cas, on constate qu'il est plus intéressant pour chaque entreprise d'être leader.
Dans ce cas, l'entreprise  1 choisit de produire $q_1=\frac{280}{3}$ et l'entreprise 2 choisit $q_2=35$.
Cette situation est instable, en effet, si 2 choisit la quantité $q_2=35$, alors la meilleure réponse de 1 est de choisir suivant sa fonction de réaction $q_1=95-\frac{1}{2}\times35=\frac{165}{2}\neq\frac{280}{3}$.
En fait, la seule situation stable est la situation de Cournot.
3. Les deux entreprises se mettent d'accord entre elles sur les quantités à produire.
Le cartel cherche à maximiser le profit joint des deux entreprises.
On écrit ce profit :
\[\pi(q)=qP(q)-C_1(q_1)-C_2(q_2)\text{ avec }q=q_1+q_2\]
On a vu en cours à l'équilibre, le cartel cherche à égaliser la recette marginale totale avec le coût marginal de chacune des entreprises :
\[R_m(q^*)=C_{m1}(q_1^*)=C_{m2}(q_2^*)\]
Le coût marginal de 1 est $C_{m1}(q_1)=5$.
Le coût marginal de 2 est $C_{m2}(q_2)=q_2$.
On a la demande inverse $P(q)=100-\frac{1}{2}q$.
Donc $R_m(q)=100-q$.
On obtient donc le système d'équations suivante pour l'optimum du cartel :
\begin{align*}
100-q_1^*-q_2^*&=5&\Leftrightarrow& q_2^*&=5\\
100-q_1^*-q_2^*&=q_2^*&&q_1^*&=100-5-q_2^*=90
\end{align*}
On  en déduit $p^*=\frac{105}{2}$.
Le profit du cartel est alors :
\[\pi(q^*, p^*)=95\times \frac{105}{2}-5\times 95-\frac{1}{2}5^2=4525\]
Le coût marginal doit être égal entre les deux entreprises car autrement, il est possible d'augmenter le profit du cartel en transférant une partie de la production de l'entreprise au coût marginal le plus élevé vers l'entreprise au coût marginal le plus faible.
4. On va chercher à représenter le profit du cartel $\pi$ dans un graphique $(\pi_1, \pi_2)$.
Le profit du cartel est la somme des profits des deux entreprises, donc $\pi=\pi_1+ \pi_2$.
On a donc dans le graphique l'équation de droite $\pi_2=\pi- \pi_1$.

```{r cartelexo34, fig.cap="Représentation des profits des entreprises 1 et 2 et de la zone de négociation."}

pi <- function(q){4525-q}
pi1 <- 3200
pi2 <- 900

inter <- uniroot(function(q){pi(q)-pi2}, c(pi1, 4525))$root

nego <- data.frame(x=c(pi1, inter), ymax=c(pi(pi1), pi2), ymin=c(pi2,pi2))


p_profit <- ggplot() +
  labs(x="profit 1", y = "profit 2") +
  geom_function(fun=pi, colour="red") +
  geom_hline(yintercept=pi2, colour="blue") +
  geom_vline(xintercept = pi1, colour="darkgreen") +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 4600), breaks=c(pi2, 4525), labels=c(TeX("$\\pi_{2}^C$"), 4525)) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 4600), breaks=c(pi1, 4525), labels=c(TeX("$\\pi_{1}^C$"), 4525)) +
  annotate("point", x=pi1, y=pi2) +
  annotate("text", x=pi1, y=pi2-100, label='Equilibre de Cournot') +
  geom_ribbon(data=nego, aes(x=x, ymin=ymin, ymax=ymax), fill='green', alpha=0.5) +
  annotate("text", x=(pi1+inter)/2, y=pi2+200, label='Zone de négociation', color="darkgreen") +
  annotate("text", x=4525/2, y=4525/2, label="Profit du cartel", color="red")


p_profit
```
Le profit total obtenu en Cournot est de $3200+900=4100$ (voir question 1).
Le profit du cartel est de 4525 (voir question 3).
On a donc un surplus de profit de 425 avec le cartel.
Une répartition égalitaire de ce surplus entre les deux entreprises serait donc de $\frac{425}{2}$ pour chaque entreprise.
Cela aboutirait à un surplus total de $6825/2$ pour l'entreprise 1 et de $2225/2$ pour l'entreprise 2.
:::